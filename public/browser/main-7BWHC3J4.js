import{$ as B,$a as Wt,$b as Tv,A as Ic,Aa as uo,Ab as Tr,B as Uh,Ba as ho,Bb as wi,C as tv,Ca as Xe,Cb as Cr,D as qn,Da as Ee,Db as yv,E as fr,Ea as qh,Eb as Ar,F as yi,Fa as hv,Fb as vv,G as nv,Ga as _r,Gb as Iv,H as jh,Ha as Ac,Hb as Se,I as Gn,Ia as dv,Ib as Vc,J as iv,Ja as fo,Jb as Uc,K as pr,Ka as Ze,Kb as Xh,L as Wn,La as Gh,Lb as wv,M as Bh,Ma as po,Mb as Ev,N as rv,Na as fv,Nb as jc,O as sv,Oa as pv,Ob as Bc,P as ov,Pa as Wh,Q as wc,Qa as yr,R as gt,Ra as Qn,S as Ec,Sa as Hh,T as Le,Ta as Kh,U as we,Ua as Sc,Ub as bv,V as $h,Va as Rc,Vb as yo,W as q,Wa as Dc,Wb as $c,X as Ce,Xa as Pe,Y as av,Ya as Ne,Z as H,Za as Yn,_ as zh,_a as Pc,a as O,aa as L,ab as Ht,ac as zc,b as fe,ba as De,bb as vr,c as P0,ca as oo,cb as vi,cc as Cv,d as Bn,da as Ue,db as Qh,e as y,ea as Ae,eb as Nc,f as Qy,fa as ut,fb as kc,g as Yy,ga as ht,gb as dt,h as $n,ha as cv,hb as xc,hc as Av,i as Mh,ia as mr,ib as Ii,j as Oh,ja as qt,jb as Ir,k as zt,ka as ao,kb as wr,l as At,la as Hn,lb as mo,m as Jy,ma as Kn,mb as go,n as Xy,na as co,nb as je,o as zn,oa as Rt,ob as Er,p as Fh,pa as bc,pb as Mc,q as Lh,qa as Gt,qb as Oc,r as Vh,ra as he,rb as Fc,s as lt,sa as Tc,sb as Yh,t as K,ta as lo,tb as Lc,u as so,ua as Dt,ub as Jh,v as Zy,va as lv,vb as mv,w as ev,wa as Cc,wb as gv,x as Z,xa as uv,xb as br,y as dr,ya as _t,yb as _v,z as St,za as gr,zb as _o}from"./chunk-MQHYCL4O.js";var Io=class{},wo=class{},_n=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var ed=class{encodeKey(e){return Sv(e)}encodeValue(e){return Sv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function k0(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,c]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(c),t.set(o,l)}),t}var x0=/%(\d[a-f0-9])/gi,M0={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Sv(n){return encodeURIComponent(n).replace(x0,(e,t)=>M0[t]??e)}function qc(n){return`${n}`}var Xn=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ed,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=k0(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(qc):[qc(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(qc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(qc(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var td=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function O0(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Rv(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Dv(n){return typeof Blob<"u"&&n instanceof Blob}function Pv(n){return typeof FormData<"u"&&n instanceof FormData}function F0(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var vo=class n{constructor(e,t,i,r){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(O0(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new _n,this.context??=new td,!this.params)this.params=new Xn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Rv(this.body)||Dv(this.body)||Pv(this.body)||F0(this.body)?this.body:this.body instanceof Xn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Pv(this.body)?null:Dv(this.body)?this.body.type||null:Rv(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Xn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,u=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(u=Object.keys(e.setHeaders).reduce((g,w)=>g.set(w,e.setHeaders[w]),u)),e.setParams&&(f=Object.keys(e.setParams).reduce((g,w)=>g.set(w,e.setParams[w]),f)),new n(t,i,o,{params:f,headers:u,context:p,reportProgress:l,responseType:r,withCredentials:c,transferCache:s})}},Zn=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Zn||{}),Eo=class{constructor(e,t=200,i="OK"){this.headers=e.headers||new _n,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Gc=class n extends Eo{constructor(e={}){super(e),this.type=Zn.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},bo=class n extends Eo{constructor(e={}){super(e),this.type=Zn.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Jn=class extends Eo{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Mv=200,L0=204;function Zh(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var V0=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof vo)s=t;else{let l;r.headers instanceof _n?l=r.headers:l=new _n(r.headers);let u;r.params&&(r.params instanceof Xn?u=r.params:u=new Xn({fromObject:r.params})),s=new vo(t,i,r.body!==void 0?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let o=K(s).pipe(yi(l=>this.handler.handle(l)));if(t instanceof vo||r.observe==="events")return o;let c=o.pipe(qn(l=>l instanceof bo));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(Z(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Z(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Z(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(Z(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Xn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Zh(r,i))}post(t,i,r={}){return this.request("POST",t,Zh(r,i))}put(t,i,r={}){return this.request("PUT",t,Zh(r,i))}static{this.\u0275fac=function(i){return new(i||n)(B(Io))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),U0=/^\)\]\}',?\n/,j0="X-Request-URL";function Nv(n){if(n.url)return n.url;let e=j0.toLocaleLowerCase();return n.headers.get(e)}var nd=(()=>{class n{constructor(){this.fetchImpl=L(id,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=L(he)}handle(t){return new $n(i=>{let r=new AbortController;return this.doRequest(t,r.signal,i).then(rd,s=>i.error(new Jn({error:s}))),()=>r.abort()})}doRequest(t,i,r){return y(this,null,function*(){let s=this.createRequestInit(t),o;try{let w=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,O({signal:i},s)));B0(w),r.next({type:Zn.Sent}),o=yield w}catch(w){r.error(new Jn({error:w,status:w.status??0,statusText:w.statusText,url:t.urlWithParams,headers:w.headers}));return}let c=new _n(o.headers),l=o.statusText,u=Nv(o)??t.urlWithParams,f=o.status,p=null;if(t.reportProgress&&r.next(new Gc({headers:c,status:f,statusText:l,url:u})),o.body){let w=o.headers.get("content-length"),S=[],P=o.body.getReader(),D=0,U,j,F=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>y(this,null,function*(){for(;;){let{done:Ie,value:te}=yield P.read();if(Ie)break;if(S.push(te),D+=te.length,t.reportProgress){j=t.responseType==="text"?(j??"")+(U??=new TextDecoder).decode(te,{stream:!0}):void 0;let b=()=>r.next({type:Zn.DownloadProgress,total:w?+w:void 0,loaded:D,partialText:j});F?F.run(b):b()}}}));let oe=this.concatChunks(S,D);try{let Ie=o.headers.get("Content-Type")??"";p=this.parseBody(t,oe,Ie)}catch(Ie){r.error(new Jn({error:Ie,headers:new _n(o.headers),status:o.status,statusText:o.statusText,url:Nv(o)??t.urlWithParams}));return}}f===0&&(f=p?Mv:0),f>=200&&f<300?(r.next(new bo({body:p,headers:c,status:f,statusText:l,url:u})),r.complete()):r.error(new Jn({error:p,headers:c,status:f,statusText:l,url:u}))})}parseBody(t,i,r){switch(t.responseType){case"json":let s=new TextDecoder().decode(i).replace(U0,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(t){let i={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>i[s]=o.join(",")),t.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(i["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:i,credentials:r}}concatChunks(t,i){let r=new Uint8Array(i),s=0;for(let o of t)r.set(o,s),s+=o.length;return r}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),id=class{};function rd(){}function B0(n){n.then(rd,rd)}function $0(n,e){return e(n)}function z0(n,e,t){return(i,r)=>qt(t,()=>e(i,s=>n(s,r)))}var Ov=new H(""),q0=new H(""),G0=new H("",{providedIn:"root",factory:()=>!0});var kv=(()=>{class n extends Io{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=L(bc),this.contributeToStability=L(G0)}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(Ov),...this.injector.get(q0,[])]));this.chain=i.reduceRight((r,s)=>z0(r,s,this.injector),$0)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(pr(()=>this.pendingTasks.remove(i)))}else return this.chain(t,i=>this.backend.handle(i))}static{this.\u0275fac=function(i){return new(i||n)(B(wo),B(mr))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})();var W0=/^\)\]\}',?\n/;function H0(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var xv=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new we(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?lt(i.\u0275loadImpl()):K(null)).pipe(gt(()=>new $n(s=>{let o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((P,D)=>o.setRequestHeader(P,D.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let P=t.detectContentTypeHeader();P!==null&&o.setRequestHeader("Content-Type",P)}if(t.responseType){let P=t.responseType.toLowerCase();o.responseType=P!=="json"?P:"text"}let c=t.serializeBody(),l=null,u=()=>{if(l!==null)return l;let P=o.statusText||"OK",D=new _n(o.getAllResponseHeaders()),U=H0(o)||t.url;return l=new Gc({headers:D,status:o.status,statusText:P,url:U}),l},f=()=>{let{headers:P,status:D,statusText:U,url:j}=u(),F=null;D!==L0&&(F=typeof o.response>"u"?o.responseText:o.response),D===0&&(D=F?Mv:0);let oe=D>=200&&D<300;if(t.responseType==="json"&&typeof F=="string"){let Ie=F;F=F.replace(W0,"");try{F=F!==""?JSON.parse(F):null}catch(te){F=Ie,oe&&(oe=!1,F={error:te,text:F})}}oe?(s.next(new bo({body:F,headers:P,status:D,statusText:U,url:j||void 0})),s.complete()):s.error(new Jn({error:F,headers:P,status:D,statusText:U,url:j||void 0}))},p=P=>{let{url:D}=u(),U=new Jn({error:P,status:o.status||0,statusText:o.statusText||"Unknown Error",url:D||void 0});s.error(U)},g=!1,w=P=>{g||(s.next(u()),g=!0);let D={type:Zn.DownloadProgress,loaded:P.loaded};P.lengthComputable&&(D.total=P.total),t.responseType==="text"&&o.responseText&&(D.partialText=o.responseText),s.next(D)},S=P=>{let D={type:Zn.UploadProgress,loaded:P.loaded};P.lengthComputable&&(D.total=P.total),s.next(D)};return o.addEventListener("load",f),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),t.reportProgress&&(o.addEventListener("progress",w),c!==null&&o.upload&&o.upload.addEventListener("progress",S)),o.send(c),s.next({type:Zn.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",f),o.removeEventListener("timeout",p),t.reportProgress&&(o.removeEventListener("progress",w),c!==null&&o.upload&&o.upload.removeEventListener("progress",S)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(i){return new(i||n)(B(Bc))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),Fv=new H(""),K0="XSRF-TOKEN",Q0=new H("",{providedIn:"root",factory:()=>K0}),Y0="X-XSRF-TOKEN",J0=new H("",{providedIn:"root",factory:()=>Y0}),Wc=class{},X0=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Uc(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(i){return new(i||n)(B(Se),B(_t),B(Q0))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})();function Z0(n,e){let t=n.url.toLowerCase();if(!L(Fv)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let i=L(Wc).getToken(),r=L(J0);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Lv=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Lv||{});function eS(n,e){return{\u0275kind:n,\u0275providers:e}}function Vv(...n){let e=[V0,xv,kv,{provide:Io,useExisting:kv},{provide:wo,useFactory:()=>L(nd,{optional:!0})??L(xv)},{provide:Ov,useValue:Z0,multi:!0},{provide:Fv,useValue:!0},{provide:Wc,useClass:X0}];for(let t of n)e.push(...t.\u0275providers);return ht(e)}function Uv(){return eS(Lv.Fetch,[nd,{provide:wo,useExisting:nd}])}var ad=class extends Iv{constructor(){super(...arguments),this.supportsDOMEvents=!0}},cd=class n extends ad{static makeCurrent(){vv(new n)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=nS();return t==null?null:iS(t)}resetBaseElement(){To=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Uc(document.cookie,e)}},To=null;function nS(){return To=To||document.querySelector("base"),To?To.getAttribute("href"):null}function iS(n){return new URL(n,document.baseURI).pathname}var rS=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),ld=new H(""),$v=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new we(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(B(ld),B(he))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),Hc=class{constructor(e){this._doc=e}},sd="ng-app-id",zv=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=jc(s),this.resetHostNodes()}addStyles(t){for(let i of t)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(t){for(let i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){let i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${sd}="${this.appId}"]`);if(t?.length){let i=new Map;return t.forEach(r=>{r.textContent!=null&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){let r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(sd),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(sd,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){let r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(B(Se),B(Cc),B(uo,8),B(_t))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),od={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},hd=/%COMP%/g,qv="%COMP%",sS=`_nghost-${qv}`,oS=`_ngcontent-${qv}`,aS=!0,cS=new H("",{providedIn:"root",factory:()=>aS});function lS(n){return oS.replace(hd,n)}function uS(n){return sS.replace(hd,n)}function Gv(n,e){return e.map(t=>t.replace(hd,n))}var Sr=(()=>{class n{constructor(t,i,r,s,o,c,l,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=jc(c),this.defaultRenderer=new Co(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===oo.ShadowDom&&(i=fe(O({},i),{encapsulation:oo.Emulated}));let r=this.getOrCreateRenderer(t,i);return r instanceof Kc?r.applyToHost(t):r instanceof Ao&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,s=r.get(i.id);if(!s){let o=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case oo.Emulated:s=new Kc(l,u,i,this.appId,f,o,c,p);break;case oo.ShadowDom:return new ud(l,u,t,i,o,c,this.nonce,p);default:s=new Ao(l,u,i,f,o,c,p);break}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(B($v),B(zv),B(Cc),B(cS),B(Se),B(_t),B(he),B(uo))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),Co=class{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(od[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(jv(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(jv(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new we(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let s=od[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=od[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ho.DashCase|ho.Important)?e.style.setProperty(t,i,r&ho.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ho.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=Ar().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function jv(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var ud=class extends Co{constructor(e,t,i,r,s,o,c,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=Gv(r.id,r.styles);for(let f of u){let p=document.createElement("style");c&&p.setAttribute("nonce",c),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ao=class extends Co{constructor(e,t,i,r,s,o,c,l){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?Gv(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Kc=class extends Ao{constructor(e,t,i,r,s,o,c,l){let u=r+"-"+i.id;super(e,t,i,s,o,c,l,u),this.contentAttr=lS(u),this.hostAttr=uS(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},hS=(()=>{class n extends Hc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(B(Se))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),Bv=["alt","control","meta","shift"],dS={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},fS={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},pS=(()=>{class n extends Hc{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r){let s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ar().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let s=n._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),Bv.forEach(u=>{let f=i.indexOf(u);f>-1&&(i.splice(f,1),o+=u+".")}),o+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=dS[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Bv.forEach(o=>{if(o!==r){let c=fS[o];c(t)&&(s+=o+".")}}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(B(Se))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})();function Wv(n,e){return _v(O({rootComponent:n},mS(e)))}function mS(n){return{appProviders:[...IS,...n?.providers??[]],platformProviders:vS}}function gS(){cd.makeCurrent()}function _S(){return new Tc}function yS(){return lv(document),document}var vS=[{provide:_t,useValue:wv},{provide:uv,useValue:gS,multi:!0},{provide:Se,useFactory:yS,deps:[]}];var IS=[{provide:cv,useValue:"root"},{provide:Tc,useFactory:_S,deps:[]},{provide:ld,useClass:hS,multi:!0,deps:[Se,he,_t]},{provide:ld,useClass:pS,multi:!0,deps:[Se]},Sr,zv,$v,{provide:_r,useExisting:Sr},{provide:Bc,useClass:rS,deps:[]},[]];var Hv=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(i){return new(i||n)(B(Se))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var J="primary",zo=Symbol("RouteTitle"),gd=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function xr(n){return new gd(n)}function TS(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],c=n[s];if(o[0]===":")r[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function CS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!en(n[t],e[t]))return!1;return!0}function en(n,e){let t=n?_d(n):void 0,i=e?_d(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!nI(n[r],e[r]))return!1;return!0}function _d(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function nI(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}else return n===e}function iI(n){return n.length>0?n[n.length-1]:null}function ei(n){return Zy(n)?n:Fc(n)?lt(Promise.resolve(n)):K(n)}var AS={exact:sI,subset:oI},rI={exact:SS,subset:RS,ignored:()=>!0};function Kv(n,e,t){return AS[t.paths](n.root,e.root,t.matrixParams)&&rI[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function SS(n,e){return en(n,e)}function sI(n,e,t){if(!bi(n.segments,e.segments)||!Jc(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!sI(n.children[i],e.children[i],t))return!1;return!0}function RS(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>nI(n[t],e[t]))}function oI(n,e,t){return aI(n,e,e.segments,t)}function aI(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!bi(r,t)||e.hasChildren()||!Jc(r,t,i))}else if(n.segments.length===t.length){if(!bi(n.segments,t)||!Jc(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!oI(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!bi(n.segments,r)||!Jc(n.segments,r,i)||!n.children[J]?!1:aI(n.children[J],e,s,i)}}function Jc(n,e,t){return e.every((i,r)=>rI[t](n[r].parameters,i.parameters))}var vn=class{constructor(e=new le([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=xr(this.queryParams),this._queryParamMap}toString(){return NS.serialize(this)}},le=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xc(this)}},Ei=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=xr(this.parameters),this._parameterMap}toString(){return lI(this)}};function DS(n,e){return bi(n,e)&&n.every((t,i)=>en(t.parameters,e[i].parameters))}function bi(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function PS(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===J&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==J&&(t=t.concat(e(r,i)))}),t}var qd=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:()=>new xo,providedIn:"root"})}}return n})(),xo=class{parse(e){let t=new vd(e);return new vn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${So(e.root,!0)}`,i=MS(e.queryParams),r=typeof e.fragment=="string"?`#${kS(e.fragment)}`:"";return`${t}${i}${r}`}},NS=new xo;function Xc(n){return n.segments.map(e=>lI(e)).join("/")}function So(n,e){if(!n.hasChildren())return Xc(n);if(e){let t=n.children[J]?So(n.children[J],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==J&&i.push(`${r}:${So(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=PS(n,(i,r)=>r===J?[So(n.children[J],!1)]:[`${r}:${So(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[J]!=null?`${Xc(n)}/${t[0]}`:`${Xc(n)}/(${t.join("//")})`}}function cI(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qc(n){return cI(n).replace(/%3B/gi,";")}function kS(n){return encodeURI(n)}function yd(n){return cI(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Zc(n){return decodeURIComponent(n)}function Qv(n){return Zc(n.replace(/\+/g,"%20"))}function lI(n){return`${yd(n.path)}${xS(n.parameters)}`}function xS(n){return Object.entries(n).map(([e,t])=>`;${yd(e)}=${yd(t)}`).join("")}function MS(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Qc(t)}=${Qc(r)}`).join("&"):`${Qc(t)}=${Qc(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var OS=/^[^\/()?;#]+/;function dd(n){let e=n.match(OS);return e?e[0]:""}var FS=/^[^\/()?;=#]+/;function LS(n){let e=n.match(FS);return e?e[0]:""}var VS=/^[^=?&#]+/;function US(n){let e=n.match(VS);return e?e[0]:""}var jS=/^[^&#]+/;function BS(n){let e=n.match(jS);return e?e[0]:""}var vd=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new le([],{}):new le([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[J]=new le(e,t)),i}parseSegment(){let e=dd(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new we(4009,!1);return this.capture(e),new Ei(Zc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=LS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=dd(this.remaining);r&&(i=r,this.capture(i))}e[Zc(t)]=Zc(i)}parseQueryParam(e){let t=US(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=BS(this.remaining);o&&(i=o,this.capture(i))}let r=Qv(t),s=Qv(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=dd(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new we(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=J);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[J]:new le([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new we(4011,!1)}};function uI(n){return n.segments.length>0?new le([],{[J]:n}):n}function hI(n){let e={};for(let[i,r]of Object.entries(n.children)){let s=hI(r);if(i===J&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let t=new le(n.segments,e);return $S(t)}function $S(n){if(n.numberOfChildren===1&&n.children[J]){let e=n.children[J];return new le(n.segments.concat(e.segments),e.children)}return n}function Mo(n){return n instanceof vn}function zS(n,e,t=null,i=null){let r=dI(n);return fI(r,e,t,i)}function dI(n){let e;function t(s){let o={};for(let l of s.children){let u=t(l);o[l.outlet]=u}let c=new le(s.url,o);return s===n&&(e=c),c}let i=t(n.root),r=uI(i);return e??r}function fI(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return fd(r,r,r,t,i);let s=qS(e);if(s.toRoot())return fd(r,r,new le([],{}),t,i);let o=GS(s,r,n),c=o.processChildren?Po(o.segmentGroup,o.index,s.commands):mI(o.segmentGroup,o.index,s.commands);return fd(r,o.segmentGroup,c,t,i)}function el(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Oo(n){return typeof n=="object"&&n!=null&&n.outlets}function fd(n,e,t,i,r){let s={};i&&Object.entries(i).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`});let o;n===e?o=t:o=pI(n,e,t);let c=uI(hI(o));return new vn(c,s,r)}function pI(n,e,t){let i={};return Object.entries(n.children).forEach(([r,s])=>{s===e?i[r]=t:i[r]=pI(s,e,t)}),new le(n.segments,i)}var tl=class{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&el(i[0]))throw new we(4003,!1);let r=i.find(Oo);if(r&&r!==iI(i))throw new we(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function qS(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new tl(!0,0,n);let e=0,t=!1,i=n.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,u])=>{c[l]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&r.push(c))}),r):[...r,s]},[]);return new tl(t,e,i)}var Pr=class{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function GS(n,e,t){if(n.isAbsolute)return new Pr(e,!0,0);if(!t)return new Pr(e,!1,NaN);if(t.parent===null)return new Pr(t,!0,0);let i=el(n.commands[0])?0:1,r=t.segments.length-1+i;return WS(t,r,n.numberOfDoubleDots)}function WS(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new we(4005,!1);r=i.segments.length}return new Pr(i,!1,r-s)}function HS(n){return Oo(n[0])?n[0].outlets:{[J]:n}}function mI(n,e,t){if(n??=new le([],{}),n.segments.length===0&&n.hasChildren())return Po(n,e,t);let i=KS(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let s=new le(n.segments.slice(0,i.pathIndex),{});return s.children[J]=new le(n.segments.slice(i.pathIndex),n.children),Po(s,0,r)}else return i.match&&r.length===0?new le(n.segments,{}):i.match&&!n.hasChildren()?Id(n,e,t):i.match?Po(n,0,r):Id(n,e,t)}function Po(n,e,t){if(t.length===0)return new le(n.segments,{});{let i=HS(t),r={};if(Object.keys(i).some(s=>s!==J)&&n.children[J]&&n.numberOfChildren===1&&n.children[J].segments.length===0){let s=Po(n.children[J],e,t);return new le(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=mI(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new le(n.segments,r)}}function KS(n,e,t){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;let o=n.segments[r],c=t[i];if(Oo(c))break;let l=`${c}`,u=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!Jv(l,u,o))return s;i+=2}else{if(!Jv(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function Id(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(Oo(s)){let l=QS(s.outlets);return new le(i,l)}if(r===0&&el(t[0])){let l=n.segments[e];i.push(new Ei(l.path,Yv(t[0]))),r++;continue}let o=Oo(s)?s.outlets[J]:`${s}`,c=r<t.length-1?t[r+1]:null;o&&c&&el(c)?(i.push(new Ei(o,Yv(c))),r+=2):(i.push(new Ei(o,{})),r++)}return new le(i,{})}function QS(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=Id(new le([],{}),0,i))}),e}function Yv(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function Jv(n,e,t){return n==t.path&&en(e,t.parameters)}var No="imperative",We=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(We||{}),Pt=class{constructor(e,t){this.id=e,this.url=t}},Fo=class extends Pt{constructor(e,t,i="imperative",r=null){super(e,t),this.type=We.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ti=class extends Pt{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=We.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},vt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(vt||{}),wd=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(wd||{}),yn=class extends Pt{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=We.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ci=class extends Pt{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=We.NavigationSkipped}},Lo=class extends Pt{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=We.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},nl=class extends Pt{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=We.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ed=class extends Pt{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=We.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bd=class extends Pt{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=We.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Td=class extends Pt{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=We.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cd=class extends Pt{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=We.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ad=class{constructor(e){this.route=e,this.type=We.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Sd=class{constructor(e){this.route=e,this.type=We.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Rd=class{constructor(e){this.snapshot=e,this.type=We.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Dd=class{constructor(e){this.snapshot=e,this.type=We.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pd=class{constructor(e){this.snapshot=e,this.type=We.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nd=class{constructor(e){this.snapshot=e,this.type=We.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Vo=class{},Mr=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function YS(n,e){return n.providers&&!n._injector&&(n._injector=pv(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Kt(n){return n.outlet||J}function JS(n,e){let t=n.filter(i=>Kt(i)===e);return t.push(...n.filter(i=>Kt(i)!==e)),t}function qo(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var kd=class{get injector(){return qo(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ul(this.rootInjector),this.attachRef=null}},ul=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new kd(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(i){return new(i||n)(B(mr))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),il=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=xd(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=xd(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Md(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Md(e,this._root).map(t=>t.value)}};function xd(n,e){if(n===e.value)return e;for(let t of e.children){let i=xd(n,t);if(i)return i}return null}function Md(n,e){if(n===e.value)return[e];for(let t of e.children){let i=Md(n,t);if(i.length)return i.unshift(e),i}return[]}var yt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Dr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var rl=class extends il{constructor(e,t){super(e),this.snapshot=t,Gd(this,e)}toString(){return this.snapshot.toString()}};function gI(n){let e=XS(n),t=new At([new Ei("",{})]),i=new At({}),r=new At({}),s=new At({}),o=new At(""),c=new Or(t,i,s,o,r,J,n,e.root);return c.snapshot=e.root,new rl(new yt(c,[]),e)}function XS(n){let e={},t={},i={},r="",s=new Nr([],e,i,r,t,J,n,null,{});return new ol("",new yt(s,[]))}var Or=class{constructor(e,t,i,r,s,o,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Z(u=>u[zo]))??K(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(e=>xr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(e=>xr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function sl(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:O(O({},e.params),n.params),data:O(O({},e.data),n.data),resolve:O(O(O(O({},n.data),e.data),r?.data),n._resolvedData)}:i={params:O({},n.params),data:O({},n.data),resolve:O(O({},n.data),n._resolvedData??{})},r&&yI(r)&&(i.resolve[zo]=r.title),i}var Nr=class{get title(){return this.data?.[zo]}constructor(e,t,i,r,s,o,c,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=xr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=xr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ol=class extends il{constructor(e,t){super(t),this.url=e,Gd(this,t)}toString(){return _I(this._root)}};function Gd(n,e){e.value._routerState=n,e.children.forEach(t=>Gd(n,t))}function _I(n){let e=n.children.length>0?` { ${n.children.map(_I).join(", ")} } `:"";return`${n.value}${e}`}function pd(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,en(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),en(e.params,t.params)||n.paramsSubject.next(t.params),CS(e.url,t.url)||n.urlSubject.next(t.url),en(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Od(n,e){let t=en(n.params,e.params)&&DS(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||Od(n.parent,e.parent))}function yI(n){return typeof n.title=="string"||n.title===null}var Wd=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=J,this.activateEvents=new Gt,this.deactivateEvents=new Gt,this.attachEvents=new Gt,this.detachEvents=new Gt,this.parentContexts=L(ul),this.location=L(dv),this.changeDetector=L(br),this.inputBinder=L(hl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new we(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new we(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new we(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new we(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Fd(t,c,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ut({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ao]})}}return n})(),Fd=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Or?this.route:e===ul?this.childContexts:this.parent.get(e,t)}},hl=new H(""),Xv=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:i}=t,r=dr([i.queryParams,i.params,i.data]).pipe(gt(([s,o,c],l)=>(c=O(O(O({},s),o),c),l===0?K(c):Promise.resolve(c)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(t);return}let o=yv(i.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:c}of o.inputs)t.activatedComponentRef.setInput(c,s[c])});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})();function ZS(n,e,t){let i=Uo(n,e._root,t?t._root:void 0);return new rl(i,e)}function Uo(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=eR(n,e,t);return new yt(i,r)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>Uo(n,c)),o}}let i=tR(e.value),r=e.children.map(s=>Uo(n,s));return new yt(i,r)}}function eR(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Uo(n,i,r);return Uo(n,i)})}function tR(n){return new Or(new At(n.url),new At(n.params),new At(n.queryParams),new At(n.fragment),new At(n.data),n.outlet,n.component,n)}var jo=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},vI="ngNavigationCancelingError";function al(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=Mo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=II(!1,vt.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function II(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[vI]=!0,t.cancellationCode=e,t}function nR(n){return wI(n)&&Mo(n.url)}function wI(n){return!!n&&n[vI]}var iR=(n,e,t,i)=>Z(r=>(new Ld(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),Ld=class{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),pd(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=Dr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Dr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Dr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=Dr(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Nd(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Dd(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(pd(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),pd(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}},cl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},kr=class{constructor(e,t){this.component=e,this.route=t}};function rR(n,e,t){let i=n._root,r=e?e._root:null;return Ro(i,r,t,[i.value])}function sR(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Lr(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!av(n)?n:e.get(n):i}function Ro(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Dr(e);return n.children.forEach(o=>{oR(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>ko(c,t.getContext(o),r)),r}function oR(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=aR(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new cl(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ro(n,e,c?c.children:null,i,r):Ro(n,e,t,i,r),l&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new kr(c.outlet.component,o))}else o&&ko(e,c,r),r.canActivateChecks.push(new cl(i)),s.component?Ro(n,null,c?c.children:null,i,r):Ro(n,null,t,i,r);return r}function aR(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!bi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!bi(n.url,e.url)||!en(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Od(n,e)||!en(n.queryParams,e.queryParams);case"paramsChange":default:return!Od(n,e)}}function ko(n,e,t){let i=Dr(n),r=n.value;Object.entries(i).forEach(([s,o])=>{r.component?e?ko(o,e.children.getContext(s),t):ko(o,null,t):ko(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new kr(e.outlet.component,r)):t.canDeactivateChecks.push(new kr(null,r)):t.canDeactivateChecks.push(new kr(null,r))}function Go(n){return typeof n=="function"}function cR(n){return typeof n=="boolean"}function lR(n){return n&&Go(n.canLoad)}function uR(n){return n&&Go(n.canActivate)}function hR(n){return n&&Go(n.canActivateChild)}function dR(n){return n&&Go(n.canDeactivate)}function fR(n){return n&&Go(n.canMatch)}function EI(n){return n instanceof ev||n?.name==="EmptyError"}var Yc=Symbol("INITIAL_VALUE");function Fr(){return gt(n=>dr(n.map(e=>e.pipe(Gn(1),wc(Yc)))).pipe(Z(e=>{for(let t of e)if(t!==!0){if(t===Yc)return Yc;if(t===!1||pR(t))return t}return!0}),qn(e=>e!==Yc),Gn(1)))}function pR(n){return Mo(n)||n instanceof jo}function mR(n,e){return St(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?K(fe(O({},t),{guardsResult:!0})):gR(o,i,r,n).pipe(St(c=>c&&cR(c)?_R(i,s,n,e):K(c)),Z(c=>fe(O({},t),{guardsResult:c})))})}function gR(n,e,t,i){return lt(n).pipe(St(r=>ER(r.component,r.route,t,e,i)),Wn(r=>r!==!0,!0))}function _R(n,e,t,i){return lt(e).pipe(yi(r=>Ic(vR(r.route.parent,i),yR(r.route,i),wR(n,r.path,t),IR(n,r.route,t))),Wn(r=>r!==!0,!0))}function yR(n,e){return n!==null&&e&&e(new Pd(n)),K(!0)}function vR(n,e){return n!==null&&e&&e(new Rd(n)),K(!0)}function IR(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return K(!0);let r=i.map(s=>Uh(()=>{let o=qo(e)??t,c=Lr(s,o),l=uR(c)?c.canActivate(e,n):qt(o,()=>c(e,n));return ei(l).pipe(Wn())}));return K(r).pipe(Fr())}function wR(n,e,t){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>sR(o)).filter(o=>o!==null).map(o=>Uh(()=>{let c=o.guards.map(l=>{let u=qo(o.node)??t,f=Lr(l,u),p=hR(f)?f.canActivateChild(i,n):qt(u,()=>f(i,n));return ei(p).pipe(Wn())});return K(c).pipe(Fr())}));return K(s).pipe(Fr())}function ER(n,e,t,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(c=>{let l=qo(e)??r,u=Lr(c,l),f=dR(u)?u.canDeactivate(n,e,t,i):qt(l,()=>u(n,e,t,i));return ei(f).pipe(Wn())});return K(o).pipe(Fr())}function bR(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return K(!0);let s=r.map(o=>{let c=Lr(o,n),l=lR(c)?c.canLoad(e,t):qt(n,()=>c(e,t));return ei(l)});return K(s).pipe(Fr(),bI(i))}function bI(n){return Yy(Le(e=>{if(typeof e!="boolean")throw al(n,e)}),Z(e=>e===!0))}function TR(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return K(!0);let s=r.map(o=>{let c=Lr(o,n),l=fR(c)?c.canMatch(e,t):qt(n,()=>c(e,t));return ei(l)});return K(s).pipe(Fr(),bI(i))}var Bo=class{constructor(e){this.segmentGroup=e||null}},$o=class extends Error{constructor(e){super(),this.urlTree=e}};function Rr(n){return so(new Bo(n))}function CR(n){return so(new we(4e3,!1))}function AR(n){return so(II(!1,vt.GuardRejected))}var Vd=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return K(i);if(r.numberOfChildren>1||!r.children[J])return CR(`${e.redirectTo}`);r=r.children[J]}}applyRedirectCommands(e,t,i,r,s){if(typeof t!="string"){let c=t,{queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,params:w,data:S,title:P}=r,D=qt(s,()=>c({params:w,data:S,queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,title:P}));if(D instanceof vn)throw new $o(D);t=D}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t[0]==="/")throw new $o(o);return o}applyRedirectCreateUrlTree(e,t,i,r){let s=this.createSegmentGroup(e,t.root,i,r);return new vn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);i[r]=t[c]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){let s=this.createSegments(e,t.segments,i,r),o={};return Object.entries(t.children).forEach(([c,l])=>{o[c]=this.createSegmentGroup(e,l,i,r)}),new le(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new we(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}},Ud={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function SR(n,e,t,i,r){let s=TI(n,e,t);return s.matched?(i=YS(e,i),TR(i,e,t,r).pipe(Z(o=>o===!0?s:O({},Ud)))):K(s)}function TI(n,e,t){if(e.path==="**")return RR(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?O({},Ud):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||TS)(t,n,e);if(!r)return O({},Ud);let s={};Object.entries(r.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let o=r.consumed.length>0?O(O({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function RR(n){return{matched:!0,parameters:n.length>0?iI(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Zv(n,e,t,i){return t.length>0&&NR(n,t,i)?{segmentGroup:new le(e,PR(i,new le(t,n.children))),slicedSegments:[]}:t.length===0&&kR(n,t,i)?{segmentGroup:new le(n.segments,DR(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new le(n.segments,n.children),slicedSegments:t}}function DR(n,e,t,i){let r={};for(let s of t)if(dl(n,e,s)&&!i[Kt(s)]){let o=new le([],{});r[Kt(s)]=o}return O(O({},i),r)}function PR(n,e){let t={};t[J]=e;for(let i of n)if(i.path===""&&Kt(i)!==J){let r=new le([],{});t[Kt(i)]=r}return t}function NR(n,e,t){return t.some(i=>dl(n,e,i)&&Kt(i)!==J)}function kR(n,e,t){return t.some(i=>dl(n,e,i))}function dl(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function xR(n,e,t){return e.length===0&&!n.children[t]}var jd=class{};function MR(n,e,t,i,r,s,o="emptyOnly"){return new Bd(n,e,t,i,r,o,s).recognize()}var OR=31,Bd=class{constructor(e,t,i,r,s,o,c){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new Vd(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new we(4002,`'${e.segmentGroup}'`)}recognize(){let e=Zv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Z(({children:t,rootSnapshot:i})=>{let r=new yt(i,t),s=new ol("",r),o=zS(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Nr([],Object.freeze({}),Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),J,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,J,t).pipe(Z(i=>({children:i,rootSnapshot:t})),fr(i=>{if(i instanceof $o)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Bo?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,r,!0,s).pipe(Z(o=>o instanceof yt?[o]:[]))}processChildren(e,t,i,r){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return lt(s).pipe(yi(o=>{let c=i.children[o],l=JS(t,o);return this.processSegmentGroup(e,l,c,o,r)}),sv((o,c)=>(o.push(...c),o)),jh(null),rv(),St(o=>{if(o===null)return Rr(i);let c=CI(o);return FR(c),K(c)}))}processSegment(e,t,i,r,s,o,c){return lt(t).pipe(yi(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,s,o,c).pipe(fr(u=>{if(u instanceof Bo)return K(null);throw u}))),Wn(l=>!!l),fr(l=>{if(EI(l))return xR(i,r,s)?K(new jd):Rr(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,s,o,c,l){return Kt(i)!==o&&(o===J||!dl(r,s,i))?Rr(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o,l):Rr(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o,c){let{matched:l,parameters:u,consumedSegments:f,positionalParamSegments:p,remainingSegments:g}=TI(t,r,s);if(!l)return Rr(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>OR&&(this.allowRedirects=!1));let w=new Nr(s,u,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,eI(r),Kt(r),r.component??r._loadedComponent??null,r,tI(r)),S=sl(w,c,this.paramsInheritanceStrategy);w.params=Object.freeze(S.params),w.data=Object.freeze(S.data);let P=this.applyRedirects.applyRedirectCommands(f,r.redirectTo,p,w,e);return this.applyRedirects.lineralizeSegments(r,P).pipe(St(D=>this.processSegment(e,i,t,D.concat(g),o,!1,c)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let c=SR(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),c.pipe(gt(l=>l.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(gt(({routes:u})=>{let f=i._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:w}=l,S=new Nr(g,p,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,eI(i),Kt(i),i.component??i._loadedComponent??null,i,tI(i)),P=sl(S,o,this.paramsInheritanceStrategy);S.params=Object.freeze(P.params),S.data=Object.freeze(P.data);let{segmentGroup:D,slicedSegments:U}=Zv(t,g,w,u);if(U.length===0&&D.hasChildren())return this.processChildren(f,u,D,S).pipe(Z(F=>new yt(S,F)));if(u.length===0&&U.length===0)return K(new yt(S,[]));let j=Kt(i)===s;return this.processSegment(f,u,D,U,j?J:s,!0,S).pipe(Z(F=>new yt(S,F instanceof yt?[F]:[])))}))):Rr(t)))}getChildConfig(e,t,i){return t.children?K({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?K({routes:t._loadedRoutes,injector:t._loadedInjector}):bR(e,t,i,this.urlSerializer).pipe(St(r=>r?this.configLoader.loadChildren(e,t).pipe(Le(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):AR(t))):K({routes:[],injector:e})}};function FR(n){n.sort((e,t)=>e.value.outlet===J?-1:t.value.outlet===J?1:e.value.outlet.localeCompare(t.value.outlet))}function LR(n){let e=n.value.routeConfig;return e&&e.path===""}function CI(n){let e=[],t=new Set;for(let i of n){if(!LR(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=CI(i.children);e.push(new yt(i.value,r))}return e.filter(i=>!t.has(i))}function eI(n){return n.data||{}}function tI(n){return n.resolve||{}}function VR(n,e,t,i,r,s){return St(o=>MR(n,e,t,i,o.extractedUrl,r,s).pipe(Z(({state:c,tree:l})=>fe(O({},o),{targetSnapshot:c,urlAfterRedirects:l}))))}function UR(n,e){return St(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return K(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let u of AI(l))o.add(u);let c=0;return lt(o).pipe(yi(l=>s.has(l)?jR(l,i,n,e):(l.data=sl(l,l.parent,n).resolve,K(void 0))),Le(()=>c++),Bh(1),St(l=>c===o.size?K(t):zn))})}function AI(n){let e=n.children.map(t=>AI(t)).flat();return[n,...e]}function jR(n,e,t,i){let r=n.routeConfig,s=n._resolve;return r?.title!==void 0&&!yI(r)&&(s[zo]=r.title),BR(s,n,e,i).pipe(Z(o=>(n._resolvedData=o,n.data=sl(n,n.parent,t).resolve,null)))}function BR(n,e,t,i){let r=_d(n);if(r.length===0)return K({});let s={};return lt(r).pipe(St(o=>$R(n[o],e,t,i).pipe(Wn(),Le(c=>{if(c instanceof jo)throw al(new xo,c);s[o]=c}))),Bh(1),iv(s),fr(o=>EI(o)?zn:so(o)))}function $R(n,e,t,i){let r=qo(e)??i,s=Lr(n,r),o=s.resolve?s.resolve(e,t):qt(r,()=>s(e,t));return ei(o)}function md(n){return gt(e=>{let t=n(e);return t?lt(t).pipe(Z(()=>e)):K(e)})}var SI=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===J);return i}getResolvedTitleForRoute(t){return t.data[zo]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:()=>L(zR),providedIn:"root"})}}return n})(),zR=(()=>{class n extends SI{constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||n)(B(Hv))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Hd=new H("",{providedIn:"root",factory:()=>({})}),qR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["ng-component"]],standalone:!0,features:[je],decls:1,vars:0,template:function(i,r){i&1&&Yn(0,"router-outlet")},dependencies:[Wd],encapsulation:2})}}return n})();function Kd(n){let e=n.children&&n.children.map(Kd),t=e?fe(O({},n),{children:e}):O({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==J&&(t.component=qR),t}var Qd=new H(""),GR=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=L(Jh)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return K(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let i=ei(t.loadComponent()).pipe(Z(RI),Le(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),pr(()=>{this.componentLoaders.delete(t)})),r=new Oh(i,()=>new zt).pipe(Mh());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return K({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=WR(i,this.compiler,t,this.onLoadEndListener).pipe(pr(()=>{this.childrenLoaders.delete(i)})),o=new Oh(s,()=>new zt).pipe(Mh());return this.childrenLoaders.set(i,o),o}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function WR(n,e,t,i){return ei(n.loadChildren()).pipe(Z(RI),St(r=>r instanceof fv||Array.isArray(r)?K(r):lt(e.compileModuleAsync(r))),Z(r=>{i&&i(n);let s,o,c=!1;return Array.isArray(r)?(o=r,c=!0):(s=r.create(t).injector,o=s.get(Qd,[],{optional:!0,self:!0}).flat()),{routes:o.map(Kd),injector:s}}))}function HR(n){return n&&typeof n=="object"&&"default"in n}function RI(n){return HR(n)?n.default:n}var Yd=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:()=>L(KR),providedIn:"root"})}}return n})(),KR=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),QR=new H("");var YR=new H(""),JR=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new zt,this.transitionAbortSubject=new zt,this.configLoader=L(GR),this.environmentInjector=L(mr),this.urlSerializer=L(qd),this.rootContexts=L(ul),this.location=L(Vc),this.inputBindingEnabled=L(hl,{optional:!0})!==null,this.titleStrategy=L(SI),this.options=L(Hd,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=L(Yd),this.createViewTransition=L(QR,{optional:!0}),this.navigationErrorHandler=L(YR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let t=r=>this.events.next(new Ad(r)),i=r=>this.events.next(new Sd(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(fe(O(O({},this.transitions.value),t),{id:i}))}setupNavigations(t,i,r){return this.transitions=new At({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:No,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(qn(s=>s.id!==0),Z(s=>fe(O({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),gt(s=>{let o=!1,c=!1;return K(s).pipe(gt(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",vt.SupersededByNewNavigation),zn;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?fe(O({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&f!=="reload"){let p="";return this.events.next(new Ci(l.id,this.urlSerializer.serialize(l.rawUrl),p,wd.IgnoredSameUrlNavigation)),l.resolve(!1),zn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return K(l).pipe(gt(p=>{let g=this.transitions?.getValue();return this.events.next(new Fo(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?zn:Promise.resolve(p)}),VR(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Le(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=fe(O({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new nl(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:g,source:w,restoredState:S,extras:P}=l,D=new Fo(p,this.urlSerializer.serialize(g),w,S);this.events.next(D);let U=gI(this.rootComponentType).snapshot;return this.currentTransition=s=fe(O({},l),{targetSnapshot:U,urlAfterRedirects:g,extras:fe(O({},P),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,K(s)}else{let p="";return this.events.next(new Ci(l.id,this.urlSerializer.serialize(l.extractedUrl),p,wd.IgnoredByUrlHandlingStrategy)),l.resolve(!1),zn}}),Le(l=>{let u=new Ed(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Z(l=>(this.currentTransition=s=fe(O({},l),{guards:rR(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),mR(this.environmentInjector,l=>this.events.next(l)),Le(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw al(this.urlSerializer,l.guardsResult);let u=new bd(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),qn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",vt.GuardRejected),!1)),md(l=>{if(l.guards.canActivateChecks.length)return K(l).pipe(Le(u=>{let f=new Td(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),gt(u=>{let f=!1;return K(u).pipe(UR(this.paramsInheritanceStrategy,this.environmentInjector),Le({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(u,"",vt.NoDataFromResolver)}}))}),Le(u=>{let f=new Cd(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),md(l=>{let u=f=>{let p=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(f.routeConfig).pipe(Le(g=>{f.component=g}),Z(()=>{})));for(let g of f.children)p.push(...u(g));return p};return dr(u(l.targetSnapshot.root)).pipe(jh(null),Gn(1))}),md(()=>this.afterPreactivation()),gt(()=>{let{currentSnapshot:l,targetSnapshot:u}=s,f=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return f?lt(f).pipe(Z(()=>s)):K(s)}),Z(l=>{let u=ZS(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=fe(O({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),Le(()=>{this.events.next(new Vo)}),iR(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Gn(1),Le({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ti(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),Ec(this.transitionAbortSubject.pipe(Le(l=>{throw l}))),pr(()=>{!o&&!c&&this.cancelNavigationTransition(s,"",vt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),fr(l=>{if(c=!0,wI(l))this.events.next(new yn(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),nR(l)?this.events.next(new Mr(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let u=new Lo(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let f=qt(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(f instanceof jo){let{message:p,cancellationCode:g}=al(this.urlSerializer,f);this.events.next(new yn(s.id,this.urlSerializer.serialize(s.extractedUrl),p,g)),this.events.next(new Mr(f.redirectTo,f.navigationBehaviorOptions))}else{this.events.next(u);let p=t.errorHandler(l);s.resolve(!!p)}}catch(f){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(f)}}return zn}))}))}cancelNavigationTransition(t,i,r){let s=new yn(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function XR(n){return n!==No}var ZR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:()=>L(eD),providedIn:"root"})}}return n})(),$d=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},eD=(()=>{class n extends $d{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=co(n)))(r||n)}})()}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),DI=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:()=>L(tD),providedIn:"root"})}}return n})(),tD=(()=>{class n extends DI{constructor(){super(...arguments),this.location=L(Vc),this.urlSerializer=L(qd),this.options=L(Hd,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=L(Yd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new vn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=gI(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof Fo)this.stateMemento=this.createStateMemento();else if(t instanceof Ci)this.rawUrlTree=i.initialUrl;else if(t instanceof nl){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??r,i)}}else t instanceof Vo?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof yn&&(t.code===vt.GuardRejected||t.code===vt.NoDataFromResolver)?this.restoreHistory(i):t instanceof Lo?this.restoreHistory(i,!0):t instanceof Ti&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){let r=t instanceof vn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){let s=this.browserPageId,o=O(O({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(r,"",o)}else{let s=O(O({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=co(n)))(r||n)}})()}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Do=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Do||{});function nD(n,e){n.events.pipe(qn(t=>t instanceof Ti||t instanceof yn||t instanceof Lo||t instanceof Ci),Z(t=>t instanceof Ti||t instanceof Ci?Do.COMPLETE:(t instanceof yn?t.code===vt.Redirect||t.code===vt.SupersededByNewNavigation:!1)?Do.REDIRECTING:Do.FAILED),qn(t=>t!==Do.REDIRECTING),Gn(1)).subscribe(()=>{e()})}function iD(n){throw n}var rD={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},sD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Vr=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=L(Oc),this.stateManager=L(DI),this.options=L(Hd,{optional:!0})||{},this.pendingTasks=L(bc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=L(JR),this.urlSerializer=L(qd),this.location=L(Vc),this.urlHandlingStrategy=L(Yd),this._events=new zt,this.errorHandler=this.options.errorHandler||iD,this.navigated=!1,this.routeReuseStrategy=L(ZR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=L(Qd,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!L(hl,{optional:!0}),this.eventsSubscription=new Qy,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof yn&&i.code!==vt.Redirect&&i.code!==vt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ti)this.navigated=!0;else if(i instanceof Mr){let o=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=O({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||XR(r.source)},o);this.scheduleNavigation(c,No,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}aD(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),No,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=O({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(t);this.scheduleNavigation(c,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Kd),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:o,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=O(O({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let p;try{let g=r?r.snapshot:this.routerState.snapshot.root;p=dI(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return fI(p,t,f,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=Mo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,No,null,i)}navigate(t,i={skipLocationChange:!1}){return oD(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=O({},rD):i===!1?r=O({},sD):r=i,Mo(t))return Kv(this.currentUrlTree,t,r);let s=this.parseUrl(t);return Kv(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(s!=null&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let c,l,u;o?(c=o.resolve,l=o.reject,u=o.promise):u=new Promise((p,g)=>{c=p,l=g});let f=this.pendingTasks.add();return nD(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function oD(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new we(4008,!1)}function aD(n){return!(n instanceof Vo)&&!(n instanceof Mr)}var cD=new H("");function PI(n,...e){return ht([{provide:Qd,multi:!0,useValue:n},[],{provide:Or,useFactory:lD,deps:[Vr]},{provide:Yh,multi:!0,useFactory:hD},e.map(t=>t.\u0275providers)])}function lD(n){return n.routerState.root}function uD(n,e){return{\u0275kind:n,\u0275providers:e}}function hD(){let n=L(Rt);return e=>{let t=n.get(Lc);if(e!==t.components[0])return;let i=n.get(Vr),r=n.get(dD);n.get(fD)===1&&i.initialNavigation(),n.get(pD,null,zh.Optional)?.setUpPreloading(),n.get(cD,null,zh.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var dD=new H("",{factory:()=>new zt}),fD=new H("",{providedIn:"root",factory:()=>1});var pD=new H("");function NI(){return uD(8,[Xv,{provide:hl,useExisting:Xv}])}var Jd;try{Jd=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Jd=!1}var Ai=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Ev(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Jd)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(B(_t))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Wo;function mD(){if(Wo==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Wo=!0}))}finally{Wo=Wo||!1}return Wo}function Xd(n){return mD()?n:!!n.capture}function kI(n){return n.composedPath?n.composedPath()[0]:n.target}function xI(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function ef(n){return Array.isArray(n)?n:[n]}function tf(n){return n instanceof Dt?n.nativeElement:n}var MI=new Set,Si,gD=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):yD}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&_D(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(B(Ai),B(uo,8))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _D(n,e){if(!MI.has(n))try{Si||(Si=document.createElement("style"),e&&Si.setAttribute("nonce",e),Si.setAttribute("type","text/css"),document.head.appendChild(Si)),Si.sheet&&(Si.sheet.insertRule(`@media ${n} {body{ }}`,0),MI.add(n))}catch(t){console.error(t)}}function yD(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var FI=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new zt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return OI(ef(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=OI(ef(t)).map(o=>this._registerQuery(o).observable),s=dr(r);return s=Ic(s.pipe(Gn(1)),s.pipe(ov(1),nv(0))),s.pipe(Z(o=>{let c={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:u})=>{c.matches=c.matches||l,c.breakpoints[u]=l}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),s={observable:new $n(o=>{let c=l=>this._zone.run(()=>o.next(l));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(wc(i),Z(({matches:o})=>({query:t,matches:o})),Ec(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(B(gD),B(he))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function OI(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function UI(n){return n.buttons===0||n.detail===0}function jI(n){let e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Ri=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(Ri||{}),LI="cdk-high-contrast-black-on-white",VI="cdk-high-contrast-white-on-black",nf="cdk-high-contrast-active",BI=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=L(FI).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ri.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ri.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ri.BLACK_ON_WHITE}return Ri.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(nf,LI,VI),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===Ri.BLACK_ON_WHITE?t.add(nf,LI):i===Ri.WHITE_ON_BLACK&&t.add(nf,VI)}}static{this.\u0275fac=function(i){return new(i||n)(B(Ai),B(Se))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var rf=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({})}}return n})();function ID(){return!0}var wD=new H("mat-sanity-checks",{providedIn:"root",factory:ID}),In=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return xI()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[t]}static{this.\u0275fac=function(i){return new(i||n)(B(BI),B(wD,8),B(Se))}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({imports:[rf,rf]})}}return n})();var Nt=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(Nt||{}),sf=class{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=Nt.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},$I=Xd({passive:!0,capture:!0}),of=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=kI(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){let s=this._events.get(t);if(s){let o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,$I)})}removeHandler(e,t,i){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(i),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,$I)))}},zI={enterDuration:225,exitDuration:150},ED=800,qI=Xd({passive:!0,capture:!0}),GI=["mousedown","touchstart"],WI=["mouseup","mouseleave","touchend","touchcancel"],HI=class n{static{this._eventManager=new of}constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=tf(i))}fadeInRipple(e,t,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=O(O({},zI),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let o=i.radius||bD(e,t,r),c=e-r.left,l=t-r.top,u=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=`${c-o}px`,f.style.top=`${l-o}px`,f.style.height=`${o*2}px`,f.style.width=`${o*2}px`,i.color!=null&&(f.style.backgroundColor=i.color),f.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(f);let p=window.getComputedStyle(f),g=p.transitionProperty,w=p.transitionDuration,S=g==="none"||w==="0s"||w==="0s, 0s"||r.width===0&&r.height===0,P=new sf(this,f,i,S);f.style.transform="scale3d(1, 1, 1)",P.state=Nt.FADING_IN,i.persistent||(this._mostRecentTransientRipple=P);let D=null;return!S&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let U=()=>{D&&(D.fallbackTimer=null),clearTimeout(F),this._finishRippleTransition(P)},j=()=>this._destroyRipple(P),F=setTimeout(j,u+100);f.addEventListener("transitionend",U),f.addEventListener("transitioncancel",j),D={onTransitionEnd:U,onTransitionCancel:j,fallbackTimer:F}}),this._activeRipples.set(P,D),(S||!u)&&this._finishRippleTransition(P),P}fadeOutRipple(e){if(e.state===Nt.FADING_OUT||e.state===Nt.HIDDEN)return;let t=e.element,i=O(O({},zI),e.config.animation);t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=Nt.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=tf(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,GI.forEach(i=>{n._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{WI.forEach(t=>{this._triggerElement.addEventListener(t,this,qI)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Nt.FADING_IN?this._startFadeOutTransition(e):e.state===Nt.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=Nt.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Nt.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=UI(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+ED;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!jI(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===Nt.VISIBLE||e.config.terminateOnPointerUp&&e.state===Nt.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(GI.forEach(t=>n._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(WI.forEach(t=>e.removeEventListener(t,this,qI)),this._pointerUpEventsRegistered=!1))}};function bD(n,e,t){let i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}var TD=["*",[["mat-toolbar-row"]]],CD=["*","mat-toolbar-row"],AD=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ut({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return n})(),KI=(()=>{class n{constructor(t,i,r){this._elementRef=t,this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static{this.\u0275fac=function(i){return new(i||n)(Ee(Dt),Ee(Ai),Ee(Se))}}static{this.\u0275cmp=Ue({type:n,selectors:[["mat-toolbar"]],contentQueries:function(i,r,s){if(i&1&&Qh(s,AD,5),i&2){let o;Nc(o=kc())&&(r._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(i,r){i&2&&(Hh(r.color?"mat-"+r.color:""),Qn("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",r._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[je],ngContentSelectors:CD,decls:2,vars:0,template:function(i,r){i&1&&(vr(TD),vi(0),vi(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-app-surface));color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-app-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-app-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-app-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-app-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-app-title-large-tracking));margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface));--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return n})();var QI=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({imports:[In,In]})}}return n})();var YI=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({imports:[In,In]})}}return n})();var Nf={};P0(Nf,{FirebaseError:()=>ft,SDK_VERSION:()=>Et,_DEFAULT_ENTRY_NAME:()=>rn,_addComponent:()=>Wr,_addOrOverwriteComponent:()=>Pf,_apps:()=>ti,_clearComponents:()=>SP,_components:()=>Gr,_getProvider:()=>En,_isFirebaseApp:()=>Cw,_isFirebaseServerApp:()=>Ot,_registerComponent:()=>wt,_removeServiceInstance:()=>Tw,_serverApps:()=>qr,deleteApp:()=>ta,getApp:()=>bn,getApps:()=>ea,initializeApp:()=>Hr,initializeServerApp:()=>Aw,onLog:()=>Tl,registerVersion:()=>ue,setLogLevel:()=>Cl});var cf={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var M=function(n,e){if(!n)throw Pi(e)},Pi=function(n){return new Error("Firebase Database ("+cf.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var XI=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},RD=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],c=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},pl={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,c=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,f=s>>2,p=(s&3)<<4|c>>4,g=(c&15)<<2|u>>6,w=u&63;l||(w=64,o||(g=64)),i.push(t[f],t[p],t[g],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(XI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):RD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;let u=r<n.length?t[n.charAt(r)]:64;++r;let p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||c==null||u==null||p==null)throw new lf;let g=s<<2|c>>4;if(i.push(g),u!==64){let w=c<<4&240|u>>2;if(i.push(w),p!==64){let S=u<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},lf=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},hf=function(n){let e=XI(n);return pl.encodeByteArray(e,!0)},Ho=function(n){return hf(n).replace(/\./g,"")},Ko=function(n){try{return pl.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZI(n){return jr(void 0,n)}function jr(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!DD(t)||(n[t]=jr(n[t],e[t]));return n}function DD(n){return n!=="__proto__"}function df(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var PD=()=>df().__FIREBASE_DEFAULTS__,ND=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},kD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ko(n[1]);return e&&JSON.parse(e)},ml=()=>{try{return PD()||ND()||kD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ff=n=>{var e,t;return(t=(e=ml())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},gl=n=>{let e=ff(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},pf=()=>{var n;return(n=ml())===null||n===void 0?void 0:n.config},mf=n=>{var e;return(e=ml())===null||e===void 0?void 0:e[`_${n}`]};var Di=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function _l(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ho(JSON.stringify(t)),Ho(JSON.stringify(o)),""].join(".")}function Be(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qo(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Be())}function xD(){var n;let e=(n=ml())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ew(){return typeof window<"u"||gf()}function gf(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function tw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nw(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function yl(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iw(){let n=Be();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tn(){return cf.NODE_CLIENT===!0||cf.NODE_ADMIN===!0}function rw(){return!xD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _f(){try{return typeof indexedDB=="object"}catch{return!1}}function sw(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var MD="FirebaseError",ft=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MD,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kt.prototype.create)}},kt=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?OD(s,i):"Error",c=`${this.serviceName}: ${o} (${r}).`;return new ft(r,c,i)}};function OD(n,e){return n.replace(FD,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var FD=/\{\$([^}]+)}/g;function Ur(n){return JSON.parse(n)}function $e(n){return JSON.stringify(n)}var ow=function(n){let e={},t={},i={},r="";try{let s=n.split(".");e=Ur(Ko(s[0])||""),t=Ur(Ko(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};var aw=function(n){let e=ow(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},cw=function(n){let e=ow(n).claims;return typeof e=="object"&&e.admin===!0};function It(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ni(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Yo(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Jo(n,e,t){let i={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function ki(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],o=e[r];if(JI(s)&&JI(o)){if(!ki(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function JI(n){return n!==null&&typeof n=="object"}function xi(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Br(n){let e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){let[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function $r(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var fl=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let i=this.W_;if(typeof e=="string")for(let p=0;p<16;p++)i[p]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let p=0;p<16;p++)i[p]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let p=16;p<80;p++){let g=i[p-3]^i[p-8]^i[p-14]^i[p-16];i[p]=(g<<1|g>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],c=this.chain_[3],l=this.chain_[4],u,f;for(let p=0;p<80;p++){p<40?p<20?(u=c^s&(o^c),f=1518500249):(u=s^o^c,f=1859775393):p<60?(u=s&o|c&(s|o),f=2400959708):(u=s^o^c,f=3395469782);let g=(r<<5|r>>>27)+u+l+f+i[p]&4294967295;l=c,c=o,o=(s<<30|s>>>2)&4294967295,s=r,r=g}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let i=t-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function vl(n,e){let t=new uf(n,e);return t.subscribe.bind(t)}var uf=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");LD(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=af),r.error===void 0&&(r.error=af),r.complete===void 0&&(r.complete=af);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function LD(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function af(){}function lw(n,e){return`${n} failed: ${e} argument `}var uw=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,M(i<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Xo=function(n){let e=0;for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};var wj=4*60*60*1e3;function xe(n){return n&&n._delegate?n._delegate:n}var et=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Mi="[DEFAULT]";var Il=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new Di;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UD(e))try{this.getOrInitializeService({instanceIdentifier:Mi})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Mi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Mi){return this.instances.has(e)}getOptions(e=Mi){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);i===c&&o.resolve(r)}return r}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:VD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Mi){return this.component?this.component.multipleInstances?e:Mi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function VD(n){return n===Mi?void 0:n}function UD(n){return n.instantiationMode==="EAGER"}var zr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Il(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var yf=[],X=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(X||{}),hw={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},jD=X.INFO,BD={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},$D=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=BD[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},xt=class{constructor(e){this.name=e,this._logLevel=jD,this._logHandler=$D,this._userLogHandler=null,yf.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}};function dw(n){yf.forEach(e=>{e.setLogLevel(n)})}function fw(n,e){for(let t of yf){let i=null;e&&e.level&&(i=hw[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(r,s,...o)=>{let c=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(i??r.logLevel)&&n({level:X[s].toLowerCase(),message:c,args:o,type:r.name})}}}var zD=(n,e)=>e.some(t=>n instanceof t),pw,mw;function qD(){return pw||(pw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GD(){return mw||(mw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var gw=new WeakMap,If=new WeakMap,_w=new WeakMap,vf=new WeakMap,Ef=new WeakMap;function WD(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(nn(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&gw.set(t,n)}).catch(()=>{}),Ef.set(e,n),e}function HD(n){if(If.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});If.set(n,e)}var wf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return If.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_w.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return nn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function yw(n){wf=n(wf)}function KD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(wl(this),e,...t);return _w.set(i,e.sort?e.sort():[e]),nn(i)}:GD().includes(n)?function(...e){return n.apply(wl(this),e),nn(gw.get(this))}:function(...e){return nn(n.apply(wl(this),e))}}function QD(n){return typeof n=="function"?KD(n):(n instanceof IDBTransaction&&HD(n),zD(n,qD())?new Proxy(n,wf):n)}function nn(n){if(n instanceof IDBRequest)return WD(n);if(vf.has(n))return vf.get(n);let e=QD(n);return e!==n&&(vf.set(n,e),Ef.set(e,n)),e}var wl=n=>Ef.get(n);function Iw(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(n,e),c=nn(o);return i&&o.addEventListener("upgradeneeded",l=>{i(nn(o.result),l.oldVersion,l.newVersion,nn(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}var YD=["get","getKey","getAll","getAllKeys","count"],JD=["put","add","delete","clear"],bf=new Map;function vw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(bf.get(e))return bf.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=JD.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||YD.includes(t)))return;let s=function(o,...c){return y(this,null,function*(){let l=this.transaction(o,r?"readwrite":"readonly"),u=l.store;return i&&(u=u.index(c.shift())),(yield Promise.all([u[t](...c),r&&l.done]))[0]})};return bf.set(e,s),s}yw(n=>fe(O({},n),{get:(e,t,i)=>vw(e,t)||n.get(e,t,i),has:(e,t)=>!!vw(e,t)||n.has(e,t)}));var Cf=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(XD(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function XD(n){let e=n.getComponent();return e?.type==="VERSION"}var El="@firebase/app",Af="0.10.13";var wn=new xt("@firebase/app"),ZD="@firebase/app-compat",eP="@firebase/analytics-compat",tP="@firebase/analytics",nP="@firebase/app-check-compat",iP="@firebase/app-check",rP="@firebase/auth",sP="@firebase/auth-compat",oP="@firebase/database",aP="@firebase/data-connect",cP="@firebase/database-compat",lP="@firebase/functions",uP="@firebase/functions-compat",hP="@firebase/installations",dP="@firebase/installations-compat",fP="@firebase/messaging",pP="@firebase/messaging-compat",mP="@firebase/performance",gP="@firebase/performance-compat",_P="@firebase/remote-config",yP="@firebase/remote-config-compat",vP="@firebase/storage",IP="@firebase/storage-compat",wP="@firebase/firestore",EP="@firebase/vertexai-preview",bP="@firebase/firestore-compat",TP="firebase",CP="10.14.1";var rn="[DEFAULT]",AP={[El]:"fire-core",[ZD]:"fire-core-compat",[tP]:"fire-analytics",[eP]:"fire-analytics-compat",[iP]:"fire-app-check",[nP]:"fire-app-check-compat",[rP]:"fire-auth",[sP]:"fire-auth-compat",[oP]:"fire-rtdb",[aP]:"fire-data-connect",[cP]:"fire-rtdb-compat",[lP]:"fire-fn",[uP]:"fire-fn-compat",[hP]:"fire-iid",[dP]:"fire-iid-compat",[fP]:"fire-fcm",[pP]:"fire-fcm-compat",[mP]:"fire-perf",[gP]:"fire-perf-compat",[_P]:"fire-rc",[yP]:"fire-rc-compat",[vP]:"fire-gcs",[IP]:"fire-gcs-compat",[wP]:"fire-fst",[bP]:"fire-fst-compat",[EP]:"fire-vertex","fire-js":"fire-js",[TP]:"fire-js-all"};var ti=new Map,qr=new Map,Gr=new Map;function Wr(n,e){try{n.container.addComponent(e)}catch(t){wn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pf(n,e){n.container.addOrOverwriteComponent(e)}function wt(n){let e=n.name;if(Gr.has(e))return wn.debug(`There were multiple attempts to register component ${e}.`),!1;Gr.set(e,n);for(let t of ti.values())Wr(t,n);for(let t of qr.values())Wr(t,n);return!0}function En(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Tw(n,e,t=rn){En(n,e).clearInstance(t)}function Cw(n){return n.options!==void 0}function Ot(n){return n.settings!==void 0}function SP(){Gr.clear()}var RP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mt=new kt("app","Firebase",RP);var bl=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mt.create("app-deleted",{appName:this._name})}};var Sf=class extends bl{constructor(e,t,i,r){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:i,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,r);else{let c=e;super(c.options,o,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ue(El,Af,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){ta(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Mt.create("server-app-deleted")}};var Et=CP;function Hr(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:rn,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Mt.create("bad-app-name",{appName:String(r)});if(t||(t=pf()),!t)throw Mt.create("no-options");let s=ti.get(r);if(s){if(ki(t,s.options)&&ki(i,s.config))return s;throw Mt.create("duplicate-app",{appName:r})}let o=new zr(r);for(let l of Gr.values())o.addComponent(l);let c=new bl(t,i,o);return ti.set(r,c),c}function Aw(n,e){if(ew()&&!gf())throw Mt.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;Cw(n)?t=n.options:t=n;let i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;let r=u=>[...u].reduce((f,p)=>Math.imul(31,f)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Mt.create("finalization-registry-not-supported",{});let s=""+r(JSON.stringify(i)),o=qr.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let c=new zr(s);for(let u of Gr.values())c.addComponent(u);let l=new Sf(t,e,s,c);return qr.set(s,l),l}function bn(n=rn){let e=ti.get(n);if(!e&&n===rn&&pf())return Hr();if(!e)throw Mt.create("no-app",{appName:n});return e}function ea(){return Array.from(ti.values())}function ta(n){return y(this,null,function*(){let e=!1,t=n.name;ti.has(t)?(e=!0,ti.delete(t)):qr.has(t)&&n.decRefCount()<=0&&(qr.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)})}function ue(n,e,t){var i;let r=(i=AP[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${r}" with version "${e}":`];s&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wn.warn(c.join(" "));return}wt(new et(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function Tl(n,e){if(n!==null&&typeof n!="function")throw Mt.create("invalid-log-argument");fw(n,e)}function Cl(n){dw(n)}var DP="firebase-heartbeat-database",PP=1,Zo="firebase-heartbeat-store",Tf=null;function Sw(){return Tf||(Tf=Iw(DP,PP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Zo)}catch(t){console.warn(t)}}}}).catch(n=>{throw Mt.create("idb-open",{originalErrorMessage:n.message})})),Tf}function NP(n){return y(this,null,function*(){try{let t=(yield Sw()).transaction(Zo),i=yield t.objectStore(Zo).get(Rw(n));return yield t.done,i}catch(e){if(e instanceof ft)wn.warn(e.message);else{let t=Mt.create("idb-get",{originalErrorMessage:e?.message});wn.warn(t.message)}}})}function ww(n,e){return y(this,null,function*(){try{let i=(yield Sw()).transaction(Zo,"readwrite");yield i.objectStore(Zo).put(e,Rw(n)),yield i.done}catch(t){if(t instanceof ft)wn.warn(t.message);else{let i=Mt.create("idb-set",{originalErrorMessage:t?.message});wn.warn(i.message)}}})}function Rw(n){return`${n.name}!${n.options.appId}`}var kP=1024,xP=30*24*60*60*1e3,Rf=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Df(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ew();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let c=new Date(o.date).valueOf();return Date.now()-c<=xP}),this._storage.overwrite(this._heartbeatsCache))}catch(i){wn.warn(i)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Ew(),{heartbeatsToSend:i,unsentEntries:r}=MP(this._heartbeatsCache.heartbeats),s=Ho(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return wn.warn(t),""}})}};function Ew(){return new Date().toISOString().substring(0,10)}function MP(n,e=kP){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),bw(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),bw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Df=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return _f()?sw().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield NP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return ww(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return ww(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function bw(n){return Ho(JSON.stringify({version:2,heartbeats:n})).length}function OP(n){wt(new et("platform-logger",e=>new Cf(e),"PRIVATE")),wt(new et("heartbeat",e=>new Rf(e),"PRIVATE")),ue(El,Af,n),ue(El,Af,"esm2017"),ue("fire-js","")}OP("");var FP="firebase",LP="10.14.1";ue(FP,LP,"app");var Ft=new Er("ANGULARFIRE2_VERSION");function Qr(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Fi=(n,e)=>{let t=e?[e]:ea(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},ni=class{constructor(){return Fi(VP)}},VP="app-check";function Kr(){}var Al=class{zone;delegate;constructor(e,t=Xy){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},kf=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Kr,{},Kr,Kr)),t.pipe(Le({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ii=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Al(Zone.current)),this.insideAngular=t.run(()=>new Al(Zone.current,Jy)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(B(he))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Sl(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function UP(n){return Sl().ngZone.runOutsideAngular(()=>n())}function Oi(n){return Sl().ngZone.run(()=>n())}function jP(n){return BP(Sl())(n)}function BP(n){return function(t){return t=t.lift(new kf(n.ngZone)),t.pipe(Vh(n.outsideAngular),Lh(n.insideAngular))}}var $P=(n,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Oi(()=>n.apply(void 0,i))},bt=(n,e)=>function(){let t,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(t||=Oi(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Kr,{},Kr,Kr))),i[s]=$P(i[s],t));let r=UP(()=>n.apply(this,i));if(!e)if(r instanceof $n){let s=Sl();return r.pipe(Vh(s.outsideAngular),Lh(s.insideAngular))}else return Oi(()=>r);return r instanceof $n?r.pipe(jP):r instanceof Promise?Oi(()=>new Promise((s,o)=>r.then(c=>Oi(()=>s(c)),c=>Oi(()=>o(c))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:Oi(()=>r)};var Qt=class{constructor(e){return e}},Tn=class{constructor(){return ea()}};function zP(n){return n&&n.length===1?n[0]:new Qt(bn())}var xf=new H("angularfire2._apps"),qP={provide:Qt,useFactory:zP,deps:[[new De,xf]]},GP={provide:Tn,deps:[[new De,xf]]};function WP(n){return(e,t)=>{let i=t.get(_t);ue("angularfire",Ft.full,"core"),ue("angularfire",Ft.full,"app"),ue("angular",Mc.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new Qt(r)}}function Dw(n,...e){return ht([qP,GP,{provide:xf,useFactory:WP(n),multi:!0,deps:[he,Rt,ii,...e]}])}var Pw=bt(Hr,!0);function Hw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Kw=Hw,Qw=new kt("auth","Firebase",Hw());var xl=new xt("@firebase/auth");function HP(n,...e){xl.logLevel<=X.WARN&&xl.warn(`Auth (${Et}): ${n}`,...e)}function Dl(n,...e){xl.logLevel<=X.ERROR&&xl.error(`Auth (${Et}): ${n}`,...e)}function on(n,...e){throw np(n,...e)}function Li(n,...e){return np(n,...e)}function Yw(n,e,t){let i=Object.assign(Object.assign({},Kw()),{[e]:t});return new kt("auth","Firebase",i).create(e,{appName:n.name})}function Sn(n){return Yw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function np(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Qw.create(n,...e)}function G(n,e,...t){if(!n)throw np(e,...t)}function Cn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Dl(e),new Error(e)}function si(n,e){n||Cn(e)}function Lf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function KP(){return Nw()==="http:"||Nw()==="https:"}function Nw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function QP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KP()||nw()||"connection"in navigator)?navigator.onLine:!0}function YP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Vi=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,si(t>e,"Short delay should be less than long delay!"),this.isMobile=Qo()||yl()}get(){return QP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ip(n,e){si(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ml=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var JP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var XP=new Vi(3e4,6e4);function oi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function ai(s,o,c,l){return y(this,arguments,function*(n,e,t,i,r={}){return Jw(n,r,()=>y(this,null,function*(){let u={},f={};i&&(e==="GET"?f=i:u={body:JSON.stringify(i)});let p=xi(Object.assign({key:n.config.apiKey},f)).slice(1),g=yield n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);let w=Object.assign({method:e,headers:g},u);return tw()||(w.referrerPolicy="no-referrer"),Ml.fetch()(Xw(n,n.config.apiHost,t,p),w)}))})}function Jw(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},JP),e);try{let r=new Vf(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Rl(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[l,u]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rl(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Rl(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Rl(n,"user-disabled",o);let f=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Yw(n,f,u);on(n,f)}}catch(r){if(r instanceof ft)throw r;on(n,"network-request-failed",{message:String(r)})}})}function la(s,o,c,l){return y(this,arguments,function*(n,e,t,i,r={}){let u=yield ai(n,e,t,i,r);return"mfaPendingCredential"in u&&on(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function Xw(n,e,t,i){let r=`${e}${t}?${i}`;return n.config.emulator?ip(n.config,r):`${n.config.apiScheme}://${r}`}function ZP(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Vf=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Li(this.auth,"network-request-failed")),XP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Rl(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=Li(n,e,i);return r.customData._tokenResponse=t,r}function kw(n){return n!==void 0&&n.enterprise!==void 0}var Uf=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ZP(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function eN(n,e){return y(this,null,function*(){return ai(n,"GET","/v2/recaptchaConfig",oi(n,e))})}function tN(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:delete",e)})}function Zw(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:lookup",e)})}function na(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function rp(n,e=!1){return y(this,null,function*(){let t=xe(n),i=yield t.getIdToken(e),r=sp(i);G(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:na(Mf(r.auth_time)),issuedAtTime:na(Mf(r.iat)),expirationTime:na(Mf(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Mf(n){return Number(n)*1e3}function sp(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Dl("JWT malformed, contained fewer than 3 sections"),null;try{let r=Ko(t);return r?JSON.parse(r):(Dl("Failed to decode base64 JWT payload"),null)}catch(r){return Dl("Caught error parsing JWT payload as JSON",r?.toString()),null}}function xw(n){let e=sp(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ra(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof ft&&nN(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function nN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var jf=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var sa=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=na(this.lastLoginAt),this.creationTime=na(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ol(n){return y(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield ra(n,Zw(t,{idToken:i}));G(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?eE(s.providerUserInfo):[],c=iN(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!c?.length,f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new sa(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,p)})}function op(n){return y(this,null,function*(){let e=xe(n);yield Ol(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function iN(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function eE(n){return n.map(e=>{var{providerId:t}=e,i=Fh(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function rN(n,e){return y(this,null,function*(){let t=yield Jw(n,{},()=>y(this,null,function*(){let i=xi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=Xw(n,r,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Ml.fetch()(o,{method:"POST",headers:c,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function sN(n,e){return y(this,null,function*(){return ai(n,"POST","/v2/accounts:revokeToken",oi(n,e))})}var ia=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):xw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");let t=xw(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield rN(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new n;return i&&(G(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(G(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(G(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Cn("not implemented")}};function ri(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Yr=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=Fh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new jf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new sa(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield ra(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return rp(this,e)}reload(){return op(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield Ol(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Ot(this.auth.app))return Promise.reject(Sn(this.auth));let e=yield this.getIdToken();return yield ra(this,tN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,c,l,u,f;let p=(i=t.displayName)!==null&&i!==void 0?i:void 0,g=(r=t.email)!==null&&r!==void 0?r:void 0,w=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,P=(c=t.tenantId)!==null&&c!==void 0?c:void 0,D=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,U=(u=t.createdAt)!==null&&u!==void 0?u:void 0,j=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:F,emailVerified:oe,isAnonymous:Ie,providerData:te,stsTokenManager:b}=t;G(F&&b,e,"internal-error");let _=ia.fromJSON(this.name,b);G(typeof F=="string",e,"internal-error"),ri(p,e.name),ri(g,e.name),G(typeof oe=="boolean",e,"internal-error"),G(typeof Ie=="boolean",e,"internal-error"),ri(w,e.name),ri(S,e.name),ri(P,e.name),ri(D,e.name),ri(U,e.name),ri(j,e.name);let I=new n({uid:F,auth:e,email:g,emailVerified:oe,displayName:p,isAnonymous:Ie,photoURL:S,phoneNumber:w,tenantId:P,stsTokenManager:_,createdAt:U,lastLoginAt:j});return te&&Array.isArray(te)&&(I.providerData=te.map(E=>Object.assign({},E))),D&&(I._redirectEventId=D),I}static _fromIdTokenResponse(e,t,i=!1){return y(this,null,function*(){let r=new ia;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield Ol(s),s})}static _fromGetAccountInfoResponse(e,t,i){return y(this,null,function*(){let r=t.users[0];G(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?eE(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,c=new ia;c.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new sa(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,u),l})}};var Mw=new Map;function An(n){si(n instanceof Function,"Expected a class definition");let e=Mw.get(n);return e?(si(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Mw.set(n,e),e)}var oN=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,i){return y(this,null,function*(){this.storage[t]=i})}_get(t){return y(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),Bf=oN;function Pl(n,e,t){return`firebase:${n}:${e}:${t}`}var Fl=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=Pl(this.userKey,r.apiKey,s),this.fullPersistenceKey=Pl("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Yr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return y(this,null,function*(){if(!t.length)return new n(An(Bf),e,i);let r=(yield Promise.all(t.map(u=>y(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=r[0]||An(Bf),o=Pl(i,e.config.apiKey,e.name),c=null;for(let u of t)try{let f=yield u._get(o);if(f){let p=Yr._fromJSON(e,f);u!==s&&(c=p),s=u;break}}catch{}let l=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,i):(s=l[0],c&&(yield s._set(o,c.toJSON())),yield Promise.all(t.map(u=>y(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,i))})}};function Ow(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oE(e))return"Blackberry";if(aE(e))return"Webos";if(nE(e))return"Safari";if((e.includes("chrome/")||iE(e))&&!e.includes("edge/"))return"Chrome";if(sE(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function tE(n=Be()){return/firefox\//i.test(n)}function nE(n=Be()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iE(n=Be()){return/crios\//i.test(n)}function rE(n=Be()){return/iemobile/i.test(n)}function sE(n=Be()){return/android/i.test(n)}function oE(n=Be()){return/blackberry/i.test(n)}function aE(n=Be()){return/webos/i.test(n)}function ap(n=Be()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function aN(n=Be()){var e;return ap(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function cN(){return iw()&&document.documentMode===10}function cE(n=Be()){return ap(n)||sE(n)||aE(n)||oE(n)||/windows phone/i.test(n)||rE(n)}function lE(n,e=[]){let t;switch(n){case"Browser":t=Ow(Be());break;case"Worker":t=`${Ow(Be())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Et}/${i}`}var $f=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((o,c)=>{try{let l=e(s);o(l)}catch(l){c(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function lN(t){return y(this,arguments,function*(n,e={}){return ai(n,"GET","/v2/passwordPolicy",oi(n,e))})}var uN=6,zf=class{constructor(e){var t,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:uN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var qf=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ll(this),this.idTokenSubscription=new Ll(this),this.beforeStateQueue=new $f(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=An(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield Fl.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Zw(this,{idToken:e}),i=yield Yr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Ot(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=r?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===c)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Ol(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=YP()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Ot(this.app))return Promise.reject(Sn(this));let t=e?xe(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Ot(this.app)?Promise.reject(Sn(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ot(this.app)?Promise.reject(Sn(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(An(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield lN(this),t=new zf(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new kt("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield sN(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&An(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=yield Fl.create(this,[An(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{let l=e.addObserver(t);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&HP(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ji(n){return xe(n)}var Ll=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=vl(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ql={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hN(n){ql=n}function uE(n){return ql.loadJS(n)}function dN(){return ql.recaptchaEnterpriseScript}function fN(){return ql.gapiScript}function hE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var pN="recaptcha-enterprise",mN="NO_RECAPTCHA",Gf=class{constructor(e){this.type=pN,this.auth=ji(e)}verify(e="verify",t=!1){return y(this,null,function*(){function i(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,c)=>y(this,null,function*(){eN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let u=new Uf(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{c(l)})}))})}function r(s,o,c){let l=window.grecaptcha;kw(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(mN)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{i(this.auth).then(c=>{if(!t&&kw(window.grecaptcha))r(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=dN();l.length!==0&&(l+=c),uE(l).then(()=>{r(c,s,o)}).catch(u=>{o(u)})}}).catch(c=>{o(c)})})})}};function Fw(n,e,t,i=!1){return y(this,null,function*(){let r=new Gf(n),s;try{s=yield r.verify(t)}catch{s=yield r.verify(t,!0)}let o=Object.assign({},e);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Wf(n,e,t,i){return y(this,null,function*(){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield Fw(n,e,t,t==="getOobCode");return i(n,s)}else return i(n,e).catch(s=>y(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield Fw(n,e,t,t==="getOobCode");return i(n,o)}else return Promise.reject(s)}))})}function cp(n,e){let t=En(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),s=t.getOptions();if(ki(s,e??{}))return r;on(r,"already-initialized")}return t.initialize({options:e})}function gN(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(An);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function lp(n,e,t){let i=ji(n);G(i._canInitEmulator,i,"emulator-config-failed"),G(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,s=dE(e),{host:o,port:c}=_N(e),l=c===null?"":`:${c}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||yN()}function dE(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _N(n){let e=dE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:Lw(i.substr(s.length+1))}}else{let[s,o]=i.split(":");return{host:s,port:Lw(o)}}}function Lw(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function yN(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var oa=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Cn("not implemented")}_getIdTokenResponse(e){return Cn("not implemented")}_linkToIdToken(e,t){return Cn("not implemented")}_getReauthenticationResolver(e){return Cn("not implemented")}};function vN(n,e){return y(this,null,function*(){return ai(n,"POST","/v1/accounts:signUp",e)})}function IN(n,e){return y(this,null,function*(){return la(n,"POST","/v1/accounts:signInWithPassword",oi(n,e))})}function wN(n,e){return y(this,null,function*(){return la(n,"POST","/v1/accounts:signInWithEmailLink",oi(n,e))})}function EN(n,e){return y(this,null,function*(){return la(n,"POST","/v1/accounts:signInWithEmailLink",oi(n,e))})}var aa=class n extends oa{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new n(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wf(e,t,"signInWithPassword",IN);case"emailLink":return wN(e,{email:this._email,oobCode:this._password});default:on(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wf(e,i,"signUpPassword",vN);case"emailLink":return EN(e,{idToken:t,email:this._email,oobCode:this._password});default:on(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Of(n,e){return y(this,null,function*(){return la(n,"POST","/v1/accounts:signInWithIdp",oi(n,e))})}function bN(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TN(n){let e=Br($r(n)).link,t=e?Br($r(e)).deep_link_id:null,i=Br($r(n)).deep_link_id;return(i?Br($r(i)).link:null)||i||t||e||n}var Vl=class n{constructor(e){var t,i,r,s,o,c;let l=Br($r(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,f=(i=l.oobCode)!==null&&i!==void 0?i:null,p=bN((r=l.mode)!==null&&r!==void 0?r:null);G(u&&f&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=f,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(c=l.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=TN(e);try{return new n(t)}catch{return null}}};var fE=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,i){return aa._fromEmailAndPassword(t,i)}static credentialWithLink(t,i){let r=Vl.parseLink(i);return G(r,"argument-error"),aa._fromEmailAndCode(t,r.code,r.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Ul=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Hf=class extends Ul{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function CN(n,e){return y(this,null,function*(){return la(n,"POST","/v1/accounts:signUp",oi(n,e))})}var Jr=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return y(this,null,function*(){let s=yield Yr._fromIdTokenResponse(e,i,r),o=Vw(i);return new n({user:s,providerId:o,_tokenResponse:i,operationType:t})})}static _forOperation(e,t,i){return y(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=Vw(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})})}};function Vw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Kf=class n extends ft{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function pE(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Kf._fromErrorAndOperation(n,s,e,i):s})}function AN(n,e,t=!1){return y(this,null,function*(){let i=yield ra(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Jr._forOperation(n,"link",i)})}function SN(n,e,t=!1){return y(this,null,function*(){let{auth:i}=n;if(Ot(i.app))return Promise.reject(Sn(i));let r="reauthenticate";try{let s=yield ra(n,pE(i,r,e,n),t);G(s.idToken,i,"internal-error");let o=sp(s.idToken);G(o,i,"internal-error");let{sub:c}=o;return G(n.uid===c,i,"user-mismatch"),Jr._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&on(i,"user-mismatch"),s}})}function mE(n,e,t=!1){return y(this,null,function*(){if(Ot(n.app))return Promise.reject(Sn(n));let i="signIn",r=yield pE(n,i,e),s=yield Jr._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})}function up(n,e){return y(this,null,function*(){return mE(ji(n),e)})}function gE(n){return y(this,null,function*(){let e=ji(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function hp(n,e,t){return y(this,null,function*(){if(Ot(n.app))return Promise.reject(Sn(n));let i=ji(n),o=yield Wf(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",CN).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&gE(n),l}),c=yield Jr._fromIdTokenResponse(i,"signIn",o);return yield i._updateCurrentUser(c.user),c})}function dp(n,e,t){return Ot(n.app)?Promise.reject(Sn(n)):up(xe(n),fE.credential(e,t)).catch(i=>y(this,null,function*(){throw i.code==="auth/password-does-not-meet-requirements"&&gE(n),i}))}function fp(n,e,t,i){return xe(n).onIdTokenChanged(e,t,i)}function pp(n,e,t){return xe(n).beforeAuthStateChanged(e,t)}function mp(n){return xe(n).signOut()}var jl="__sak";var Bl=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jl,"1"),this.storage.removeItem(jl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var RN=1e3,DN=10,PN=(()=>{class n extends Bl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cE(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((c,l,u)=>{this.notifyListeners(c,u)});return}let r=t.key;i?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(r);!i&&this.localCache[r]===c||this.notifyListeners(r,c)},o=this.storage.getItem(r);cN()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,DN):s()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},RN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,i){return y(this,null,function*(){yield Bn(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i)})}_get(t){return y(this,null,function*(){let i=yield Bn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i})}_remove(t){return y(this,null,function*(){yield Bn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),_E=PN;var NN=(()=>{class n extends Bl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),gp=NN;function kN(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var xN=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let i=t,{eventId:r,eventType:s,data:o}=i.data,c=this.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let l=Array.from(c).map(f=>y(this,null,function*(){return f(i.origin,o)})),u=yield kN(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function yE(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var Qf=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){return y(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((c,l)=>{let u=yE("",20);r.port1.start();let f=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){let g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function sn(){return window}function MN(n){sn().location.href=n}function vE(){return typeof sn().WorkerGlobalScope<"u"&&typeof sn().importScripts=="function"}function ON(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function FN(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function LN(){return vE()?self:null}var IE="firebaseLocalStorageDb",VN=1,$l="firebaseLocalStorage",wE="fbase_key",Ui=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Gl(n,e){return n.transaction([$l],e?"readwrite":"readonly").objectStore($l)}function UN(){let n=indexedDB.deleteDatabase(IE);return new Ui(n).toPromise()}function Yf(){let n=indexedDB.open(IE,VN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore($l,{keyPath:wE})}catch(r){t(r)}}),n.addEventListener("success",()=>y(this,null,function*(){let i=n.result;i.objectStoreNames.contains($l)?e(i):(i.close(),yield UN(),e(yield Yf()))}))})}function Uw(n,e,t){return y(this,null,function*(){let i=Gl(n,!0).put({[wE]:e,value:t});return new Ui(i).toPromise()})}function jN(n,e){return y(this,null,function*(){let t=Gl(n,!1).get(e),i=yield new Ui(t).toPromise();return i===void 0?null:i.value})}function jw(n,e){let t=Gl(n,!0).delete(e);return new Ui(t).toPromise()}var BN=800,$N=3,zN=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Yf(),this.db)})}_withRetries(t){return y(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r)}catch(r){if(i++>$N)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return vE()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=xN._getInstance(LN()),this.receiver._subscribe("keyChanged",(t,i)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(t,i)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,i;if(this.activeServiceWorker=yield ON(),!this.activeServiceWorker)return;this.sender=new Qf(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||FN()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Yf();return yield Uw(t,jl,"1"),yield jw(t,jl),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,i){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>Uw(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let i=yield this._withRetries(r=>jN(r,t));return this.localCache[t]=i,i})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>jw(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let o=Gl(s,!1).getAll();return new Ui(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),BN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),EE=zN;var sB=hE("rcb"),oB=new Vi(3e4,6e4);function qN(n,e){return e?An(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ca=class extends oa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Of(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Of(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Of(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function GN(n){return mE(n.auth,new ca(n),n.bypassAuthState)}function WN(n){let{auth:e,user:t}=n;return G(t,e,"internal-error"),SN(t,new ca(n),n.bypassAuthState)}function HN(n){return y(this,null,function*(){let{auth:e,user:t}=n;return G(t,e,"internal-error"),AN(t,new ca(n),n.bypassAuthState)})}var Jf=class{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GN;case"linkViaPopup":case"linkViaRedirect":return HN;case"reauthViaPopup":case"reauthViaRedirect":return WN;default:on(this.auth,"internal-error")}}resolve(e){si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var aB=new Vi(2e3,1e4);var KN="pendingRedirect",Nl=new Map,Xf=class n extends Jf{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){return y(this,null,function*(){let e=Nl.get(this.auth._key());if(!e){try{let i=(yield QN(this.resolver,this.auth))?yield Bn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Nl.set(this.auth._key(),e)}return this.bypassAuthState||Nl.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Bn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Bn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function QN(n,e){return y(this,null,function*(){let t=XN(e),i=JN(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r})}function YN(n,e){Nl.set(n._key(),e)}function JN(n){return An(n._redirectPersistence)}function XN(n){return Pl(KN,n.config.apiKey,n.name)}function ZN(n,e,t=!1){return y(this,null,function*(){if(Ot(n.app))return Promise.reject(Sn(n));let i=ji(n),r=qN(i,e),o=yield new Xf(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield i._persistUserIfCurrent(o.user),yield i._setRedirectUser(null,e)),o})}var ek=10*60*1e3,Zf=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!bE(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Li(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ek&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bw(e))}saveEventToCache(e){this.cachedEventUids.add(Bw(e)),this.lastProcessedEventTime=Date.now()}};function Bw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bE({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function tk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bE(n);default:return!1}}function nk(t){return y(this,arguments,function*(n,e={}){return ai(n,"GET","/v1/projects",e)})}var ik=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rk=/^https?/;function sk(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield nk(n);for(let t of e)try{if(ok(t))return}catch{}on(n,"unauthorized-domain")})}function ok(n){let e=Lf(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!rk.test(t))return!1;if(ik.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var ak=new Vi(3e4,6e4);function $w(){let n=sn().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ck(n){return new Promise((e,t)=>{var i,r,s;function o(){$w(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$w(),t(Li(n,"network-request-failed"))},timeout:ak.get()})}if(!((r=(i=sn().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=sn().gapi)===null||s===void 0)&&s.load)o();else{let c=hE("iframefcb");return sn()[c]=()=>{gapi.load?o():t(Li(n,"network-request-failed"))},uE(`${fN()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw kl=null,e})}var kl=null;function lk(n){return kl=kl||ck(n),kl}var uk=new Vi(5e3,15e3),hk="__/auth/iframe",dk="emulator/auth/iframe",fk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mk(n){let e=n.config;G(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?ip(e,dk):`https://${n.config.authDomain}/${hk}`,i={apiKey:e.apiKey,appName:n.name,v:Et},r=pk.get(n.config.apiHost);r&&(i.eid=r);let s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${xi(i).slice(1)}`}function gk(n){return y(this,null,function*(){let e=yield lk(n),t=sn().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:mk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fk,dontclear:!0},i=>new Promise((r,s)=>y(this,null,function*(){yield i.restyle({setHideOnLeave:!1});let o=Li(n,"network-request-failed"),c=sn().setTimeout(()=>{s(o)},uk.get());function l(){sn().clearTimeout(c),r(i)}i.ping(l).then(l,()=>{s(o)})})))})}var _k={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yk=500,vk=600,Ik="_blank",wk="http://localhost",zl=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Ek(n,e,t,i=yk,r=vk){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString(),c="",l=Object.assign(Object.assign({},_k),{width:i.toString(),height:r.toString(),top:s,left:o}),u=Be().toLowerCase();t&&(c=iE(u)?Ik:t),tE(u)&&(e=e||wk,l.scrollbars="yes");let f=Object.entries(l).reduce((g,[w,S])=>`${g}${w}=${S},`,"");if(aN(u)&&c!=="_self")return bk(e||"",c),new zl(null);let p=window.open(e||"",c,f);G(p,n,"popup-blocked");try{p.focus()}catch{}return new zl(p)}function bk(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var Tk="__/auth/handler",Ck="emulator/auth/handler",Ak=encodeURIComponent("fac");function zw(n,e,t,i,r,s){return y(this,null,function*(){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Et,eventId:r};if(e instanceof Ul){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Yo(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,p]of Object.entries(s||{}))o[f]=p}if(e instanceof Hf){let f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let l=yield n._getAppCheckToken(),u=l?`#${Ak}=${encodeURIComponent(l)}`:"";return`${Sk(n)}?${xi(c).slice(1)}${u}`})}function Sk({config:n}){return n.emulator?ip(n,Ck):`https://${n.authDomain}/${Tk}`}var Ff="webStorageSupport",ep=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gp,this._completeRedirectFn=ZN,this._overrideRedirectResult=YN}_openPopup(e,t,i,r){return y(this,null,function*(){var s;si((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield zw(e,t,i,Lf(),r);return Ek(e,o,yE())})}_openRedirect(e,t,i,r){return y(this,null,function*(){yield this._originValidation(e);let s=yield zw(e,t,i,Lf(),r);return MN(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(si(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){return y(this,null,function*(){let t=yield gk(e),i=new Zf(e);return t.register("authEvent",r=>(G(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ff,{type:Ff},r=>{var s;let o=(s=r?.[0])===null||s===void 0?void 0:s[Ff];o!==void 0&&t(!!o),on(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=sk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cE()||nE()||ap()}},TE=ep;var qw="@firebase/auth",Gw="1.7.9";var tp=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Rk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Dk(n){wt(new et("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=i.options;G(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lE(n)},u=new qf(i,r,s,l);return gN(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wt(new et("auth-internal",e=>{let t=ji(e.getProvider("auth").getImmediate());return(i=>new tp(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ue(qw,Gw,Rk(n)),ue(qw,Gw,"esm2017")}var Pk=5*60,Nk=mf("authIdTokenMaxAge")||Pk,Ww=null,kk=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Nk)return;let r=t?.token;Ww!==r&&(Ww=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function _p(n=bn()){let e=En(n,"auth");if(e.isInitialized())return e.getImmediate();let t=cp(n,{popupRedirectResolver:TE,persistence:[EE,_E,gp]}),i=mf("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(i,location.origin);if(location.origin===s.origin){let o=kk(s.toString());pp(t,o,()=>o(t.currentUser)),fp(t,c=>o(c))}}let r=ff("auth");return r&&lp(t,`http://${r}`),t}function xk(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}hN({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=Li("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",xk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Dk("Browser");var CE="auth",Bi=class{constructor(e){return e}},$i=class{constructor(){return Fi(CE)}};var yp=new H("angularfire2.auth-instances");function bx(n,e){let t=Qr(CE,n,e);return t&&new Bi(t)}function Tx(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Bi(i)}}var Cx={provide:$i,deps:[[new De,yp]]},Ax={provide:Bi,useFactory:bx,deps:[[new De,yp],Qt]};function AE(n,...e){return ue("angularfire",Ft.full,"auth"),ht([Ax,Cx,{provide:yp,useFactory:Tx(n),multi:!0,deps:[he,Rt,ii,Tn,[new De,ni],...e]}])}var SE=bt(hp,!0);var RE=bt(_p,!0);var DE=bt(dp,!0);var PE=bt(mp,!0);var NE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kE={};var ci,vp;(function(){var n;function e(b,_){function I(){}I.prototype=_.prototype,b.D=_.prototype,b.prototype=new I,b.prototype.constructor=b,b.C=function(E,T,A){for(var v=Array(arguments.length-2),pn=2;pn<arguments.length;pn++)v[pn-2]=arguments[pn];return _.prototype[T].apply(E,v)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(b,_,I){I||(I=0);var E=Array(16);if(typeof _=="string")for(var T=0;16>T;++T)E[T]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(T=0;16>T;++T)E[T]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=b.g[0],I=b.g[1],T=b.g[2];var A=b.g[3],v=_+(A^I&(T^A))+E[0]+3614090360&4294967295;_=I+(v<<7&4294967295|v>>>25),v=A+(T^_&(I^T))+E[1]+3905402710&4294967295,A=_+(v<<12&4294967295|v>>>20),v=T+(I^A&(_^I))+E[2]+606105819&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(_^T&(A^_))+E[3]+3250441966&4294967295,I=T+(v<<22&4294967295|v>>>10),v=_+(A^I&(T^A))+E[4]+4118548399&4294967295,_=I+(v<<7&4294967295|v>>>25),v=A+(T^_&(I^T))+E[5]+1200080426&4294967295,A=_+(v<<12&4294967295|v>>>20),v=T+(I^A&(_^I))+E[6]+2821735955&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(_^T&(A^_))+E[7]+4249261313&4294967295,I=T+(v<<22&4294967295|v>>>10),v=_+(A^I&(T^A))+E[8]+1770035416&4294967295,_=I+(v<<7&4294967295|v>>>25),v=A+(T^_&(I^T))+E[9]+2336552879&4294967295,A=_+(v<<12&4294967295|v>>>20),v=T+(I^A&(_^I))+E[10]+4294925233&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(_^T&(A^_))+E[11]+2304563134&4294967295,I=T+(v<<22&4294967295|v>>>10),v=_+(A^I&(T^A))+E[12]+1804603682&4294967295,_=I+(v<<7&4294967295|v>>>25),v=A+(T^_&(I^T))+E[13]+4254626195&4294967295,A=_+(v<<12&4294967295|v>>>20),v=T+(I^A&(_^I))+E[14]+2792965006&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(_^T&(A^_))+E[15]+1236535329&4294967295,I=T+(v<<22&4294967295|v>>>10),v=_+(T^A&(I^T))+E[1]+4129170786&4294967295,_=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(_^I))+E[6]+3225465664&4294967295,A=_+(v<<9&4294967295|v>>>23),v=T+(_^I&(A^_))+E[11]+643717713&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^_&(T^A))+E[0]+3921069994&4294967295,I=T+(v<<20&4294967295|v>>>12),v=_+(T^A&(I^T))+E[5]+3593408605&4294967295,_=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(_^I))+E[10]+38016083&4294967295,A=_+(v<<9&4294967295|v>>>23),v=T+(_^I&(A^_))+E[15]+3634488961&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^_&(T^A))+E[4]+3889429448&4294967295,I=T+(v<<20&4294967295|v>>>12),v=_+(T^A&(I^T))+E[9]+568446438&4294967295,_=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(_^I))+E[14]+3275163606&4294967295,A=_+(v<<9&4294967295|v>>>23),v=T+(_^I&(A^_))+E[3]+4107603335&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^_&(T^A))+E[8]+1163531501&4294967295,I=T+(v<<20&4294967295|v>>>12),v=_+(T^A&(I^T))+E[13]+2850285829&4294967295,_=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(_^I))+E[2]+4243563512&4294967295,A=_+(v<<9&4294967295|v>>>23),v=T+(_^I&(A^_))+E[7]+1735328473&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^_&(T^A))+E[12]+2368359562&4294967295,I=T+(v<<20&4294967295|v>>>12),v=_+(I^T^A)+E[5]+4294588738&4294967295,_=I+(v<<4&4294967295|v>>>28),v=A+(_^I^T)+E[8]+2272392833&4294967295,A=_+(v<<11&4294967295|v>>>21),v=T+(A^_^I)+E[11]+1839030562&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^_)+E[14]+4259657740&4294967295,I=T+(v<<23&4294967295|v>>>9),v=_+(I^T^A)+E[1]+2763975236&4294967295,_=I+(v<<4&4294967295|v>>>28),v=A+(_^I^T)+E[4]+1272893353&4294967295,A=_+(v<<11&4294967295|v>>>21),v=T+(A^_^I)+E[7]+4139469664&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^_)+E[10]+3200236656&4294967295,I=T+(v<<23&4294967295|v>>>9),v=_+(I^T^A)+E[13]+681279174&4294967295,_=I+(v<<4&4294967295|v>>>28),v=A+(_^I^T)+E[0]+3936430074&4294967295,A=_+(v<<11&4294967295|v>>>21),v=T+(A^_^I)+E[3]+3572445317&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^_)+E[6]+76029189&4294967295,I=T+(v<<23&4294967295|v>>>9),v=_+(I^T^A)+E[9]+3654602809&4294967295,_=I+(v<<4&4294967295|v>>>28),v=A+(_^I^T)+E[12]+3873151461&4294967295,A=_+(v<<11&4294967295|v>>>21),v=T+(A^_^I)+E[15]+530742520&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^_)+E[2]+3299628645&4294967295,I=T+(v<<23&4294967295|v>>>9),v=_+(T^(I|~A))+E[0]+4096336452&4294967295,_=I+(v<<6&4294967295|v>>>26),v=A+(I^(_|~T))+E[7]+1126891415&4294967295,A=_+(v<<10&4294967295|v>>>22),v=T+(_^(A|~I))+E[14]+2878612391&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~_))+E[5]+4237533241&4294967295,I=T+(v<<21&4294967295|v>>>11),v=_+(T^(I|~A))+E[12]+1700485571&4294967295,_=I+(v<<6&4294967295|v>>>26),v=A+(I^(_|~T))+E[3]+2399980690&4294967295,A=_+(v<<10&4294967295|v>>>22),v=T+(_^(A|~I))+E[10]+4293915773&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~_))+E[1]+2240044497&4294967295,I=T+(v<<21&4294967295|v>>>11),v=_+(T^(I|~A))+E[8]+1873313359&4294967295,_=I+(v<<6&4294967295|v>>>26),v=A+(I^(_|~T))+E[15]+4264355552&4294967295,A=_+(v<<10&4294967295|v>>>22),v=T+(_^(A|~I))+E[6]+2734768916&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~_))+E[13]+1309151649&4294967295,I=T+(v<<21&4294967295|v>>>11),v=_+(T^(I|~A))+E[4]+4149444226&4294967295,_=I+(v<<6&4294967295|v>>>26),v=A+(I^(_|~T))+E[11]+3174756917&4294967295,A=_+(v<<10&4294967295|v>>>22),v=T+(_^(A|~I))+E[2]+718787259&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~_))+E[9]+3951481745&4294967295,b.g[0]=b.g[0]+_&4294967295,b.g[1]=b.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,b.g[2]=b.g[2]+T&4294967295,b.g[3]=b.g[3]+A&4294967295}i.prototype.u=function(b,_){_===void 0&&(_=b.length);for(var I=_-this.blockSize,E=this.B,T=this.h,A=0;A<_;){if(T==0)for(;A<=I;)r(this,b,A),A+=this.blockSize;if(typeof b=="string"){for(;A<_;)if(E[T++]=b.charCodeAt(A++),T==this.blockSize){r(this,E),T=0;break}}else for(;A<_;)if(E[T++]=b[A++],T==this.blockSize){r(this,E),T=0;break}}this.h=T,this.o+=_},i.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var _=1;_<b.length-8;++_)b[_]=0;var I=8*this.o;for(_=b.length-8;_<b.length;++_)b[_]=I&255,I/=256;for(this.u(b),b=Array(16),_=I=0;4>_;++_)for(var E=0;32>E;E+=8)b[I++]=this.g[_]>>>E&255;return b};function s(b,_){var I=c;return Object.prototype.hasOwnProperty.call(I,b)?I[b]:I[b]=_(b)}function o(b,_){this.h=_;for(var I=[],E=!0,T=b.length-1;0<=T;T--){var A=b[T]|0;E&&A==_||(I[T]=A,E=!1)}this.g=I}var c={};function l(b){return-128<=b&&128>b?s(b,function(_){return new o([_|0],0>_?-1:0)}):new o([b|0],0>b?-1:0)}function u(b){if(isNaN(b)||!isFinite(b))return p;if(0>b)return D(u(-b));for(var _=[],I=1,E=0;b>=I;E++)_[E]=b/I|0,I*=4294967296;return new o(_,0)}function f(b,_){if(b.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(b.charAt(0)=="-")return D(f(b.substring(1),_));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(_,8)),E=p,T=0;T<b.length;T+=8){var A=Math.min(8,b.length-T),v=parseInt(b.substring(T,T+A),_);8>A?(A=u(Math.pow(_,A)),E=E.j(A).add(u(v))):(E=E.j(I),E=E.add(u(v)))}return E}var p=l(0),g=l(1),w=l(16777216);n=o.prototype,n.m=function(){if(P(this))return-D(this).m();for(var b=0,_=1,I=0;I<this.g.length;I++){var E=this.i(I);b+=(0<=E?E:4294967296+E)*_,_*=4294967296}return b},n.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(S(this))return"0";if(P(this))return"-"+D(this).toString(b);for(var _=u(Math.pow(b,6)),I=this,E="";;){var T=oe(I,_).g;I=U(I,T.j(_));var A=((0<I.g.length?I.g[0]:I.h)>>>0).toString(b);if(I=T,S(I))return A+E;for(;6>A.length;)A="0"+A;E=A+E}},n.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function S(b){if(b.h!=0)return!1;for(var _=0;_<b.g.length;_++)if(b.g[_]!=0)return!1;return!0}function P(b){return b.h==-1}n.l=function(b){return b=U(this,b),P(b)?-1:S(b)?0:1};function D(b){for(var _=b.g.length,I=[],E=0;E<_;E++)I[E]=~b.g[E];return new o(I,~b.h).add(g)}n.abs=function(){return P(this)?D(this):this},n.add=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],E=0,T=0;T<=_;T++){var A=E+(this.i(T)&65535)+(b.i(T)&65535),v=(A>>>16)+(this.i(T)>>>16)+(b.i(T)>>>16);E=v>>>16,A&=65535,v&=65535,I[T]=v<<16|A}return new o(I,I[I.length-1]&-2147483648?-1:0)};function U(b,_){return b.add(D(_))}n.j=function(b){if(S(this)||S(b))return p;if(P(this))return P(b)?D(this).j(D(b)):D(D(this).j(b));if(P(b))return D(this.j(D(b)));if(0>this.l(w)&&0>b.l(w))return u(this.m()*b.m());for(var _=this.g.length+b.g.length,I=[],E=0;E<2*_;E++)I[E]=0;for(E=0;E<this.g.length;E++)for(var T=0;T<b.g.length;T++){var A=this.i(E)>>>16,v=this.i(E)&65535,pn=b.i(T)>>>16,js=b.i(T)&65535;I[2*E+2*T]+=v*js,j(I,2*E+2*T),I[2*E+2*T+1]+=A*js,j(I,2*E+2*T+1),I[2*E+2*T+1]+=v*pn,j(I,2*E+2*T+1),I[2*E+2*T+2]+=A*pn,j(I,2*E+2*T+2)}for(E=0;E<_;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=_;E<2*_;E++)I[E]=0;return new o(I,0)};function j(b,_){for(;(b[_]&65535)!=b[_];)b[_+1]+=b[_]>>>16,b[_]&=65535,_++}function F(b,_){this.g=b,this.h=_}function oe(b,_){if(S(_))throw Error("division by zero");if(S(b))return new F(p,p);if(P(b))return _=oe(D(b),_),new F(D(_.g),D(_.h));if(P(_))return _=oe(b,D(_)),new F(D(_.g),_.h);if(30<b.g.length){if(P(b)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var I=g,E=_;0>=E.l(b);)I=Ie(I),E=Ie(E);var T=te(I,1),A=te(E,1);for(E=te(E,2),I=te(I,2);!S(E);){var v=A.add(E);0>=v.l(b)&&(T=T.add(I),A=v),E=te(E,1),I=te(I,1)}return _=U(b,T.j(_)),new F(T,_)}for(T=p;0<=b.l(_);){for(I=Math.max(1,Math.floor(b.m()/_.m())),E=Math.ceil(Math.log(I)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),A=u(I),v=A.j(_);P(v)||0<v.l(b);)I-=E,A=u(I),v=A.j(_);S(A)&&(A=g),T=T.add(A),b=U(b,v)}return new F(T,b)}n.A=function(b){return oe(this,b).h},n.and=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)&b.i(E);return new o(I,this.h&b.h)},n.or=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)|b.i(E);return new o(I,this.h|b.h)},n.xor=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],E=0;E<_;E++)I[E]=this.i(E)^b.i(E);return new o(I,this.h^b.h)};function Ie(b){for(var _=b.g.length+1,I=[],E=0;E<_;E++)I[E]=b.i(E)<<1|b.i(E-1)>>>31;return new o(I,b.h)}function te(b,_){var I=_>>5;_%=32;for(var E=b.g.length-I,T=[],A=0;A<E;A++)T[A]=0<_?b.i(A+I)>>>_|b.i(A+I+1)<<32-_:b.i(A+I);return new o(T,b.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,vp=kE.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,ci=kE.Integer=o}).apply(typeof NE<"u"?NE:typeof self<"u"?self:typeof window<"u"?window:{});var Wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rn={};var Ip,Sx,Xr,wp,ua,Hl,Ep,bp,Tp;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wl=="object"&&Wl];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var i=t(this);function r(a,h){if(h)e:{var d=i;a=a.split(".");for(var m=0;m<a.length-1;m++){var C=a[m];if(!(C in d))break e;d=d[C]}a=a[a.length-1],m=d[a],h=h(m),h!=m&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,m=!1,C={next:function(){if(!m&&d<a.length){var R=d++;return{value:h(R,a[R]),done:!1}}return m=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}r("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},c=this||self;function l(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,m),a.apply(h,C)}}return function(){return a.apply(h,arguments)}}function g(a,h,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function w(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function S(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,C,R){for(var x=Array(arguments.length-2),me=2;me<arguments.length;me++)x[me-2]=arguments[me];return h.prototype[C].apply(m,x)}}function P(a){let h=a.length;if(0<h){let d=Array(h);for(let m=0;m<h;m++)d[m]=a[m];return d}return[]}function D(a,h){for(let d=1;d<arguments.length;d++){let m=arguments[d];if(l(m)){let C=a.length||0,R=m.length||0;a.length=C+R;for(let x=0;x<R;x++)a[C+x]=m[x]}else a.push(m)}}class U{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function j(a){return/^[\s\xa0]*$/.test(a)}function F(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function oe(a){return oe[" "](a),a}oe[" "]=function(){};var Ie=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function te(a,h,d){for(let m in a)h.call(d,a[m],m,a)}function b(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function _(a){let h={};for(let d in a)h[d]=a[d];return h}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,h){let d,m;for(let C=1;C<arguments.length;C++){m=arguments[C];for(d in m)a[d]=m[d];for(let R=0;R<I.length;R++)d=I[R],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function T(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function A(a){c.setTimeout(()=>{throw a},0)}function v(){var a=lh;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class pn{constructor(){this.h=this.g=null}add(h,d){let m=js.get();m.set(h,d),this.h?this.h.next=m:this.g=m,this.h=m}}var js=new U(()=>new YA,a=>a.reset());class YA{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Bs,$s=!1,lh=new pn,K_=()=>{let a=c.Promise.resolve(void 0);Bs=()=>{a.then(JA)}};var JA=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(d){A(d)}var h=js;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}$s=!1};function Ln(){this.s=this.s,this.C=this.C}Ln.prototype.s=!1,Ln.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ln.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ke(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Ke.prototype.h=function(){this.defaultPrevented=!0};var XA=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,h),c.removeEventListener("test",d,h)}catch{}return a}();function zs(a,h){if(Ke.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(Ie){e:{try{oe(h.nodeName);var C=!0;break e}catch{}C=!1}C||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:ZA[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&zs.aa.h.call(this)}}S(zs,Ke);var ZA={2:"touch",3:"pen",4:"mouse"};zs.prototype.h=function(){zs.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var qs="closure_listenable_"+(1e6*Math.random()|0),e0=0;function t0(a,h,d,m,C){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!m,this.ha=C,this.key=++e0,this.da=this.fa=!1}function ic(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function rc(a){this.src=a,this.g={},this.h=0}rc.prototype.add=function(a,h,d,m,C){var R=a.toString();a=this.g[R],a||(a=this.g[R]=[],this.h++);var x=hh(a,h,m,C);return-1<x?(h=a[x],d||(h.fa=!1)):(h=new t0(h,this.src,R,!!m,C),h.fa=d,a.push(h)),h};function uh(a,h){var d=h.type;if(d in a.g){var m=a.g[d],C=Array.prototype.indexOf.call(m,h,void 0),R;(R=0<=C)&&Array.prototype.splice.call(m,C,1),R&&(ic(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function hh(a,h,d,m){for(var C=0;C<a.length;++C){var R=a[C];if(!R.da&&R.listener==h&&R.capture==!!d&&R.ha==m)return C}return-1}var dh="closure_lm_"+(1e6*Math.random()|0),fh={};function Q_(a,h,d,m,C){if(m&&m.once)return J_(a,h,d,m,C);if(Array.isArray(h)){for(var R=0;R<h.length;R++)Q_(a,h[R],d,m,C);return null}return d=_h(d),a&&a[qs]?a.K(h,d,u(m)?!!m.capture:!!m,C):Y_(a,h,d,!1,m,C)}function Y_(a,h,d,m,C,R){if(!h)throw Error("Invalid event type");var x=u(C)?!!C.capture:!!C,me=mh(a);if(me||(a[dh]=me=new rc(a)),d=me.add(h,d,m,x,R),d.proxy)return d;if(m=n0(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)XA||(C=x),C===void 0&&(C=!1),a.addEventListener(h.toString(),m,C);else if(a.attachEvent)a.attachEvent(Z_(h.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function n0(){function a(d){return h.call(a.src,a.listener,d)}let h=i0;return a}function J_(a,h,d,m,C){if(Array.isArray(h)){for(var R=0;R<h.length;R++)J_(a,h[R],d,m,C);return null}return d=_h(d),a&&a[qs]?a.L(h,d,u(m)?!!m.capture:!!m,C):Y_(a,h,d,!0,m,C)}function X_(a,h,d,m,C){if(Array.isArray(h))for(var R=0;R<h.length;R++)X_(a,h[R],d,m,C);else m=u(m)?!!m.capture:!!m,d=_h(d),a&&a[qs]?(a=a.i,h=String(h).toString(),h in a.g&&(R=a.g[h],d=hh(R,d,m,C),-1<d&&(ic(R[d]),Array.prototype.splice.call(R,d,1),R.length==0&&(delete a.g[h],a.h--)))):a&&(a=mh(a))&&(h=a.g[h.toString()],a=-1,h&&(a=hh(h,d,m,C)),(d=-1<a?h[a]:null)&&ph(d))}function ph(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[qs])uh(h.i,a);else{var d=a.type,m=a.proxy;h.removeEventListener?h.removeEventListener(d,m,a.capture):h.detachEvent?h.detachEvent(Z_(d),m):h.addListener&&h.removeListener&&h.removeListener(m),(d=mh(h))?(uh(d,a),d.h==0&&(d.src=null,h[dh]=null)):ic(a)}}}function Z_(a){return a in fh?fh[a]:fh[a]="on"+a}function i0(a,h){if(a.da)a=!0;else{h=new zs(h,this);var d=a.listener,m=a.ha||a.src;a.fa&&ph(a),a=d.call(m,h)}return a}function mh(a){return a=a[dh],a instanceof rc?a:null}var gh="__closure_events_fn_"+(1e9*Math.random()>>>0);function _h(a){return typeof a=="function"?a:(a[gh]||(a[gh]=function(h){return a.handleEvent(h)}),a[gh])}function Qe(){Ln.call(this),this.i=new rc(this),this.M=this,this.F=null}S(Qe,Ln),Qe.prototype[qs]=!0,Qe.prototype.removeEventListener=function(a,h,d,m){X_(this,a,h,d,m)};function at(a,h){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=h.type||h,typeof h=="string")h=new Ke(h,a);else if(h instanceof Ke)h.target=h.target||a;else{var C=h;h=new Ke(m,a),E(h,C)}if(C=!0,d)for(var R=d.length-1;0<=R;R--){var x=h.g=d[R];C=sc(x,m,!0,h)&&C}if(x=h.g=a,C=sc(x,m,!0,h)&&C,C=sc(x,m,!1,h)&&C,d)for(R=0;R<d.length;R++)x=h.g=d[R],C=sc(x,m,!1,h)&&C}Qe.prototype.N=function(){if(Qe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],m=0;m<d.length;m++)ic(d[m]);delete a.g[h],a.h--}}this.F=null},Qe.prototype.K=function(a,h,d,m){return this.i.add(String(a),h,!1,d,m)},Qe.prototype.L=function(a,h,d,m){return this.i.add(String(a),h,!0,d,m)};function sc(a,h,d,m){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var C=!0,R=0;R<h.length;++R){var x=h[R];if(x&&!x.da&&x.capture==d){var me=x.listener,Ge=x.ha||x.src;x.fa&&uh(a.i,x),C=me.call(Ge,m)!==!1&&C}}return C&&!m.defaultPrevented}function ey(a,h,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(a,h||0)}function ty(a){a.g=ey(()=>{a.g=null,a.i&&(a.i=!1,ty(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class r0 extends Ln{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ty(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gs(a){Ln.call(this),this.h=a,this.g={}}S(Gs,Ln);var ny=[];function iy(a){te(a.g,function(h,d){this.g.hasOwnProperty(d)&&ph(h)},a),a.g={}}Gs.prototype.N=function(){Gs.aa.N.call(this),iy(this)},Gs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yh=c.JSON.stringify,s0=c.JSON.parse,o0=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function vh(){}vh.prototype.h=null;function ry(a){return a.h||(a.h=a.i())}function sy(){}var Ws={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ih(){Ke.call(this,"d")}S(Ih,Ke);function wh(){Ke.call(this,"c")}S(wh,Ke);var pi={},oy=null;function oc(){return oy=oy||new Qe}pi.La="serverreachability";function ay(a){Ke.call(this,pi.La,a)}S(ay,Ke);function Hs(a){let h=oc();at(h,new ay(h))}pi.STAT_EVENT="statevent";function cy(a,h){Ke.call(this,pi.STAT_EVENT,a),this.stat=h}S(cy,Ke);function ct(a){let h=oc();at(h,new cy(h,a))}pi.Ma="timingevent";function ly(a,h){Ke.call(this,pi.Ma,a),this.size=h}S(ly,Ke);function Ks(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},h)}function Qs(){this.g=!0}Qs.prototype.xa=function(){this.g=!1};function a0(a,h,d,m,C,R){a.info(function(){if(a.g)if(R)for(var x="",me=R.split("&"),Ge=0;Ge<me.length;Ge++){var ae=me[Ge].split("=");if(1<ae.length){var Ye=ae[0];ae=ae[1];var Je=Ye.split("_");x=2<=Je.length&&Je[1]=="type"?x+(Ye+"="+ae+"&"):x+(Ye+"=redacted&")}}else x=null;else x=R;return"XMLHTTP REQ ("+m+") [attempt "+C+"]: "+h+`
`+d+`
`+x})}function c0(a,h,d,m,C,R,x){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+C+"]: "+h+`
`+d+`
`+R+" "+x})}function cr(a,h,d,m){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+u0(a,d)+(m?" "+m:"")})}function l0(a,h){a.info(function(){return"TIMEOUT: "+h})}Qs.prototype.info=function(){};function u0(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var C=m[1];if(Array.isArray(C)&&!(1>C.length)){var R=C[0];if(R!="noop"&&R!="stop"&&R!="close")for(var x=1;x<C.length;x++)C[x]=""}}}}return yh(d)}catch{return h}}var ac={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},uy={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Eh;function cc(){}S(cc,vh),cc.prototype.g=function(){return new XMLHttpRequest},cc.prototype.i=function(){return{}},Eh=new cc;function Vn(a,h,d,m){this.j=a,this.i=h,this.l=d,this.R=m||1,this.U=new Gs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hy}function hy(){this.i=null,this.g="",this.h=!1}var dy={},bh={};function Th(a,h,d){a.L=1,a.v=dc(mn(h)),a.m=d,a.P=!0,fy(a,null)}function fy(a,h){a.F=Date.now(),lc(a),a.A=mn(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),Sy(d.i,"t",m),a.C=0,d=a.j.J,a.h=new hy,a.g=Gy(a.j,d?h:null,!a.m),0<a.O&&(a.M=new r0(g(a.Y,a,a.g),a.O)),h=a.U,d=a.g,m=a.ca;var C="readystatechange";Array.isArray(C)||(C&&(ny[0]=C.toString()),C=ny);for(var R=0;R<C.length;R++){var x=Q_(d,C[R],m||h.handleEvent,!1,h.h||h);if(!x)break;h.g[x.key]=x}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Hs(),a0(a.i,a.u,a.A,a.l,a.R,a.m)}Vn.prototype.ca=function(a){a=a.target;let h=this.M;h&&gn(a)==3?h.j():this.Y(a)},Vn.prototype.Y=function(a){try{if(a==this.g)e:{let Je=gn(this.g);var h=this.g.Ba();let hr=this.g.Z();if(!(3>Je)&&(Je!=3||this.g&&(this.h.h||this.g.oa()||My(this.g)))){this.J||Je!=4||h==7||(h==8||0>=hr?Hs(3):Hs(2)),Ch(this);var d=this.g.Z();this.X=d;t:if(py(this)){var m=My(this.g);a="";var C=m.length,R=gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mi(this),Ys(this);var x="";break t}this.h.i=new c.TextDecoder}for(h=0;h<C;h++)this.h.h=!0,a+=this.h.i.decode(m[h],{stream:!(R&&h==C-1)});m.length=0,this.h.g+=a,this.C=0,x=this.h.g}else x=this.g.oa();if(this.o=d==200,c0(this.i,this.u,this.A,this.l,this.R,Je,d),this.o){if(this.T&&!this.K){t:{if(this.g){var me,Ge=this.g;if((me=Ge.g?Ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(me)){var ae=me;break t}}ae=null}if(d=ae)cr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ah(this,d);else{this.o=!1,this.s=3,ct(12),mi(this),Ys(this);break e}}if(this.P){d=!0;let $t;for(;!this.J&&this.C<x.length;)if($t=h0(this,x),$t==bh){Je==4&&(this.s=4,ct(14),d=!1),cr(this.i,this.l,null,"[Incomplete Response]");break}else if($t==dy){this.s=4,ct(15),cr(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else cr(this.i,this.l,$t,null),Ah(this,$t);if(py(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Je!=4||x.length!=0||this.h.h||(this.s=1,ct(16),d=!1),this.o=this.o&&d,!d)cr(this.i,this.l,x,"[Invalid Chunked Response]"),mi(this),Ys(this);else if(0<x.length&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.ba&&!Ye.M&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),kh(Ye),Ye.M=!0,ct(11))}}else cr(this.i,this.l,x,null),Ah(this,x);Je==4&&mi(this),this.o&&!this.J&&(Je==4?By(this.j,this):(this.o=!1,lc(this)))}else R0(this.g),d==400&&0<x.indexOf("Unknown SID")?(this.s=3,ct(12)):(this.s=0,ct(13)),mi(this),Ys(this)}}}catch{}finally{}};function py(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function h0(a,h){var d=a.C,m=h.indexOf(`
`,d);return m==-1?bh:(d=Number(h.substring(d,m)),isNaN(d)?dy:(m+=1,m+d>h.length?bh:(h=h.slice(m,m+d),a.C=m+d,h)))}Vn.prototype.cancel=function(){this.J=!0,mi(this)};function lc(a){a.S=Date.now()+a.I,my(a,a.I)}function my(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Ks(g(a.ba,a),h)}function Ch(a){a.B&&(c.clearTimeout(a.B),a.B=null)}Vn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(l0(this.i,this.A),this.L!=2&&(Hs(),ct(17)),mi(this),this.s=2,Ys(this)):my(this,this.S-a)};function Ys(a){a.j.G==0||a.J||By(a.j,a)}function mi(a){Ch(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,iy(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Ah(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Sh(d.h,a))){if(!a.K&&Sh(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var C=m;if(C[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)_c(d),mc(d);else break e;Nh(d),ct(18)}}else d.za=C[1],0<d.za-d.T&&37500>C[2]&&d.F&&d.v==0&&!d.C&&(d.C=Ks(g(d.Za,d),6e3));if(1>=yy(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else _i(d,11)}else if((a.K||d.g==a)&&_c(d),!j(h))for(C=d.Da.g.parse(h),h=0;h<C.length;h++){let ae=C[h];if(d.T=ae[0],ae=ae[1],d.G==2)if(ae[0]=="c"){d.K=ae[1],d.ia=ae[2];let Ye=ae[3];Ye!=null&&(d.la=Ye,d.j.info("VER="+d.la));let Je=ae[4];Je!=null&&(d.Aa=Je,d.j.info("SVER="+d.Aa));let hr=ae[5];hr!=null&&typeof hr=="number"&&0<hr&&(m=1.5*hr,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;let $t=a.g;if($t){let vc=$t.g?$t.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vc){var R=m.h;R.g||vc.indexOf("spdy")==-1&&vc.indexOf("quic")==-1&&vc.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Rh(R,R.h),R.h=null))}if(m.D){let xh=$t.g?$t.g.getResponseHeader("X-HTTP-Session-Id"):null;xh&&(m.ya=xh,_e(m.I,m.D,xh))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var x=a;if(m.qa=qy(m,m.J?m.ia:null,m.W),x.K){vy(m.h,x);var me=x,Ge=m.L;Ge&&(me.I=Ge),me.B&&(Ch(me),lc(me)),m.g=x}else Uy(m);0<d.i.length&&gc(d)}else ae[0]!="stop"&&ae[0]!="close"||_i(d,7);else d.G==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?_i(d,7):Ph(d):ae[0]!="noop"&&d.l&&d.l.ta(ae),d.v=0)}}Hs(4)}catch{}}var d0=class{constructor(a,h){this.g=a,this.map=h}};function gy(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _y(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function yy(a){return a.h?1:a.g?a.g.size:0}function Sh(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Rh(a,h){a.g?a.g.add(h):a.h=h}function vy(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}gy.prototype.cancel=function(){if(this.i=Iy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Iy(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return P(a.i)}function f0(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var h=[],d=a.length,m=0;m<d;m++)h.push(a[m]);return h}h=[],d=0;for(m in a)h[d++]=a[m];return h}function p0(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let m in a)h[d++]=m;return h}}}function wy(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=p0(a),m=f0(a),C=m.length,R=0;R<C;R++)h.call(void 0,m[R],d&&d[R],a)}var Ey=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function m0(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),C=null;if(0<=m){var R=a[d].substring(0,m);C=a[d].substring(m+1)}else R=a[d];h(R,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function gi(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof gi){this.h=a.h,uc(this,a.j),this.o=a.o,this.g=a.g,hc(this,a.s),this.l=a.l;var h=a.i,d=new Zs;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),by(this,d),this.m=a.m}else a&&(h=String(a).match(Ey))?(this.h=!1,uc(this,h[1]||"",!0),this.o=Js(h[2]||""),this.g=Js(h[3]||"",!0),hc(this,h[4]),this.l=Js(h[5]||"",!0),by(this,h[6]||"",!0),this.m=Js(h[7]||"")):(this.h=!1,this.i=new Zs(null,this.h))}gi.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Xs(h,Ty,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Xs(h,Ty,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Xs(d,d.charAt(0)=="/"?y0:_0,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Xs(d,I0)),a.join("")};function mn(a){return new gi(a)}function uc(a,h,d){a.j=d?Js(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function hc(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function by(a,h,d){h instanceof Zs?(a.i=h,w0(a.i,a.h)):(d||(h=Xs(h,v0)),a.i=new Zs(h,a.h))}function _e(a,h,d){a.i.set(h,d)}function dc(a){return _e(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Js(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Xs(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,g0),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function g0(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ty=/[#\/\?@]/g,_0=/[#\?:]/g,y0=/[#\?]/g,v0=/[#\?@]/g,I0=/#/g;function Zs(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function Un(a){a.g||(a.g=new Map,a.h=0,a.i&&m0(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}n=Zs.prototype,n.add=function(a,h){Un(this),this.i=null,a=lr(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function Cy(a,h){Un(a),h=lr(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Ay(a,h){return Un(a),h=lr(a,h),a.g.has(h)}n.forEach=function(a,h){Un(this),this.g.forEach(function(d,m){d.forEach(function(C){a.call(h,C,m,this)},this)},this)},n.na=function(){Un(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let m=0;m<h.length;m++){let C=a[m];for(let R=0;R<C.length;R++)d.push(h[m])}return d},n.V=function(a){Un(this);let h=[];if(typeof a=="string")Ay(this,a)&&(h=h.concat(this.g.get(lr(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},n.set=function(a,h){return Un(this),this.i=null,a=lr(this,a),Ay(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Sy(a,h,d){Cy(a,h),0<d.length&&(a.i=null,a.g.set(lr(a,h),P(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var m=h[d];let R=encodeURIComponent(String(m)),x=this.V(m);for(m=0;m<x.length;m++){var C=R;x[m]!==""&&(C+="="+encodeURIComponent(String(x[m]))),a.push(C)}}return this.i=a.join("&")};function lr(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function w0(a,h){h&&!a.j&&(Un(a),a.i=null,a.g.forEach(function(d,m){var C=m.toLowerCase();m!=C&&(Cy(this,m),Sy(this,C,d))},a)),a.j=h}function E0(a,h){let d=new Qs;if(c.Image){let m=new Image;m.onload=w(jn,d,"TestLoadImage: loaded",!0,h,m),m.onerror=w(jn,d,"TestLoadImage: error",!1,h,m),m.onabort=w(jn,d,"TestLoadImage: abort",!1,h,m),m.ontimeout=w(jn,d,"TestLoadImage: timeout",!1,h,m),c.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else h(!1)}function b0(a,h){let d=new Qs,m=new AbortController,C=setTimeout(()=>{m.abort(),jn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:m.signal}).then(R=>{clearTimeout(C),R.ok?jn(d,"TestPingServer: ok",!0,h):jn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(C),jn(d,"TestPingServer: error",!1,h)})}function jn(a,h,d,m,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),m(d)}catch{}}function T0(){this.g=new o0}function C0(a,h,d){let m=d||"";try{wy(a,function(C,R){let x=C;u(C)&&(x=yh(C)),h.push(m+R+"="+encodeURIComponent(x))})}catch(C){throw h.push(m+"type="+encodeURIComponent("_badmap")),C}}function eo(a){this.l=a.Ub||null,this.j=a.eb||!1}S(eo,vh),eo.prototype.g=function(){return new fc(this.l,this.j)},eo.prototype.i=function(a){return function(){return a}}({});function fc(a,h){Qe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(fc,Qe),n=fc.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,no(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,to(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,no(this)),this.g&&(this.readyState=3,no(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ry(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ry(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?to(this):no(this),this.readyState==3&&Ry(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,to(this))},n.Qa=function(a){this.g&&(this.response=a,to(this))},n.ga=function(){this.g&&to(this)};function to(a){a.readyState=4,a.l=null,a.j=null,a.v=null,no(a)}n.setRequestHeader=function(a,h){this.u.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function no(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(fc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Dy(a){let h="";return te(a,function(d,m){h+=m,h+=":",h+=d,h+=`\r
`}),h}function Dh(a,h,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=Dy(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):_e(a,h,d))}function Te(a){Qe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Te,Qe);var A0=/^https?$/i,S0=["POST","PUT"];n=Te.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,h,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Eh.g(),this.v=this.o?ry(this.o):ry(Eh),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(R){Py(this,R);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var C in m)d.set(C,m[C]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let R of m.keys())d.set(R,m.get(R));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(R=>R.toLowerCase()=="content-type"),C=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(S0,h,void 0))||m||C||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,x]of d)this.g.setRequestHeader(R,x);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xy(this),this.u=!0,this.g.send(a),this.u=!1}catch(R){Py(this,R)}};function Py(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,Ny(a),pc(a)}function Ny(a){a.A||(a.A=!0,at(a,"complete"),at(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,at(this,"complete"),at(this,"abort"),pc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pc(this,!0)),Te.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ky(this):this.bb())},n.bb=function(){ky(this)};function ky(a){if(a.h&&typeof o<"u"&&(!a.v[1]||gn(a)!=4||a.Z()!=2)){if(a.u&&gn(a)==4)ey(a.Ea,0,a);else if(at(a,"readystatechange"),gn(a)==4){a.h=!1;try{let x=a.Z();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var m;if(m=x===0){var C=String(a.D).match(Ey)[1]||null;!C&&c.self&&c.self.location&&(C=c.self.location.protocol.slice(0,-1)),m=!A0.test(C?C.toLowerCase():"")}d=m}if(d)at(a,"complete"),at(a,"success");else{a.m=6;try{var R=2<gn(a)?a.g.statusText:""}catch{R=""}a.l=R+" ["+a.Z()+"]",Ny(a)}}finally{pc(a)}}}}function pc(a,h){if(a.g){xy(a);let d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||at(a,"ready");try{d.onreadystatechange=m}catch{}}}function xy(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function gn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),s0(h)}};function My(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function R0(a){let h={};a=(a.g&&2<=gn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(j(a[m]))continue;var d=T(a[m]);let C=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let R=h[C]||[];h[C]=R,R.push(d)}b(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function io(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function Oy(a){this.Aa=0,this.i=[],this.j=new Qs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=io("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=io("baseRetryDelayMs",5e3,a),this.cb=io("retryDelaySeedMs",1e4,a),this.Wa=io("forwardChannelMaxRetries",2,a),this.wa=io("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new gy(a&&a.concurrentRequestLimit),this.Da=new T0,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Oy.prototype,n.la=8,n.G=1,n.connect=function(a,h,d,m){ct(0),this.W=a,this.H=h||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=qy(this,null,this.W),gc(this)};function Ph(a){if(Fy(a),a.G==3){var h=a.U++,d=mn(a.I);if(_e(d,"SID",a.K),_e(d,"RID",h),_e(d,"TYPE","terminate"),ro(a,d),h=new Vn(a,a.j,h),h.L=2,h.v=dc(mn(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=h.v,d=!0),d||(h.g=Gy(h.j,null),h.g.ea(h.v)),h.F=Date.now(),lc(h)}zy(a)}function mc(a){a.g&&(kh(a),a.g.cancel(),a.g=null)}function Fy(a){mc(a),a.u&&(c.clearTimeout(a.u),a.u=null),_c(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function gc(a){if(!_y(a.h)&&!a.s){a.s=!0;var h=a.Ga;Bs||K_(),$s||(Bs(),$s=!0),lh.add(h,a),a.B=0}}function D0(a,h){return yy(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Ks(g(a.Ga,a,h),$y(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let C=new Vn(this,this.j,a),R=this.o;if(this.S&&(R?(R=_(R),E(R,this.S)):R=this.S),this.m!==null||this.O||(C.H=R,R=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=Vy(this,C,h),d=mn(this.I),_e(d,"RID",a),_e(d,"CVER",22),this.D&&_e(d,"X-HTTP-Session-Id",this.D),ro(this,d),R&&(this.O?h="headers="+encodeURIComponent(String(Dy(R)))+"&"+h:this.m&&Dh(d,this.m,R)),Rh(this.h,C),this.Ua&&_e(d,"TYPE","init"),this.P?(_e(d,"$req",h),_e(d,"SID","null"),C.T=!0,Th(C,d,null)):Th(C,d,h),this.G=2}}else this.G==3&&(a?Ly(this,a):this.i.length==0||_y(this.h)||Ly(this))};function Ly(a,h){var d;h?d=h.l:d=a.U++;let m=mn(a.I);_e(m,"SID",a.K),_e(m,"RID",d),_e(m,"AID",a.T),ro(a,m),a.m&&a.o&&Dh(m,a.m,a.o),d=new Vn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Vy(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Rh(a.h,d),Th(d,m,h)}function ro(a,h){a.H&&te(a.H,function(d,m){_e(h,m,d)}),a.l&&wy({},function(d,m){_e(h,m,d)})}function Vy(a,h,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;e:{var C=a.i;let R=-1;for(;;){let x=["count="+d];R==-1?0<d?(R=C[0].g,x.push("ofs="+R)):R=0:x.push("ofs="+R);let me=!0;for(let Ge=0;Ge<d;Ge++){let ae=C[Ge].g,Ye=C[Ge].map;if(ae-=R,0>ae)R=Math.max(0,C[Ge].g-100),me=!1;else try{C0(Ye,x,"req"+ae+"_")}catch{m&&m(Ye)}}if(me){m=x.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,m}function Uy(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Bs||K_(),$s||(Bs(),$s=!0),lh.add(h,a),a.v=0}}function Nh(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Ks(g(a.Fa,a),$y(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,jy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Ks(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ct(10),mc(this),jy(this))};function kh(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function jy(a){a.g=new Vn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=mn(a.qa);_e(h,"RID","rpc"),_e(h,"SID",a.K),_e(h,"AID",a.T),_e(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&_e(h,"TO",a.ja),_e(h,"TYPE","xmlhttp"),ro(a,h),a.m&&a.o&&Dh(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=dc(mn(h)),d.m=null,d.P=!0,fy(d,a)}n.Za=function(){this.C!=null&&(this.C=null,mc(this),Nh(this),ct(19))};function _c(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function By(a,h){var d=null;if(a.g==h){_c(a),kh(a),a.g=null;var m=2}else if(Sh(a.h,h))d=h.D,vy(a.h,h),m=1;else return;if(a.G!=0){if(h.o)if(m==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var C=a.B;m=oc(),at(m,new ly(m,d)),gc(a)}else Uy(a);else if(C=h.s,C==3||C==0&&0<h.X||!(m==1&&D0(a,h)||m==2&&Nh(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),C){case 1:_i(a,5);break;case 4:_i(a,10);break;case 3:_i(a,6);break;default:_i(a,2)}}}function $y(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function _i(a,h){if(a.j.info("Error code "+h),h==2){var d=g(a.fb,a),m=a.Xa;let C=!m;m=new gi(m||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||uc(m,"https"),dc(m),C?E0(m.toString(),d):b0(m.toString(),d)}else ct(2);a.G=0,a.l&&a.l.sa(h),zy(a),Fy(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ct(2)):(this.j.info("Failed to ping google.com"),ct(1))};function zy(a){if(a.G=0,a.ka=[],a.l){let h=Iy(a.h);(h.length!=0||a.i.length!=0)&&(D(a.ka,h),D(a.ka,a.i),a.h.i.length=0,P(a.i),a.i.length=0),a.l.ra()}}function qy(a,h,d){var m=d instanceof gi?mn(d):new gi(d);if(m.g!="")h&&(m.g=h+"."+m.g),hc(m,m.s);else{var C=c.location;m=C.protocol,h=h?h+"."+C.hostname:C.hostname,C=+C.port;var R=new gi(null);m&&uc(R,m),h&&(R.g=h),C&&hc(R,C),d&&(R.l=d),m=R}return d=a.D,h=a.ya,d&&h&&_e(m,d,h),_e(m,"VER",a.la),ro(a,m),m}function Gy(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Te(new eo({eb:d})):new Te(a.pa),h.Ha(a.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wy(){}n=Wy.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function yc(){}yc.prototype.g=function(a,h){return new mt(a,h)};function mt(a,h){Qe.call(this),this.g=new Oy(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!j(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!j(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ur(this)}S(mt,Qe),mt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mt.prototype.close=function(){Ph(this.g)},mt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=yh(a),a=d);h.i.push(new d0(h.Ya++,a)),h.G==3&&gc(h)},mt.prototype.N=function(){this.g.l=null,delete this.j,Ph(this.g),delete this.g,mt.aa.N.call(this)};function Hy(a){Ih.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}S(Hy,Ih);function Ky(){wh.call(this),this.status=1}S(Ky,wh);function ur(a){this.g=a}S(ur,Wy),ur.prototype.ua=function(){at(this.g,"a")},ur.prototype.ta=function(a){at(this.g,new Hy(a))},ur.prototype.sa=function(a){at(this.g,new Ky)},ur.prototype.ra=function(){at(this.g,"b")},yc.prototype.createWebChannel=yc.prototype.g,mt.prototype.send=mt.prototype.o,mt.prototype.open=mt.prototype.m,mt.prototype.close=mt.prototype.close,Tp=Rn.createWebChannelTransport=function(){return new yc},bp=Rn.getStatEventTarget=function(){return oc()},Ep=Rn.Event=pi,Hl=Rn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ac.NO_ERROR=0,ac.TIMEOUT=8,ac.HTTP_ERROR=6,ua=Rn.ErrorCode=ac,uy.COMPLETE="complete",wp=Rn.EventType=uy,sy.EventType=Ws,Ws.OPEN="a",Ws.CLOSE="b",Ws.ERROR="c",Ws.MESSAGE="d",Qe.prototype.listen=Qe.prototype.K,Xr=Rn.WebChannel=sy,Sx=Rn.FetchXmlHttpFactory=eo,Te.prototype.listenOnce=Te.prototype.L,Te.prototype.getLastError=Te.prototype.Ka,Te.prototype.getLastErrorCode=Te.prototype.Ba,Te.prototype.getStatus=Te.prototype.Z,Te.prototype.getResponseJson=Te.prototype.Oa,Te.prototype.getResponseText=Te.prototype.oa,Te.prototype.send=Te.prototype.ea,Te.prototype.setWithCredentials=Te.prototype.Ha,Ip=Rn.XhrIo=Te}).apply(typeof Wl<"u"?Wl:typeof self<"u"?self:typeof window<"u"?window:{});var xE="@firebase/firestore";var ze=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ze.UNAUTHENTICATED=new ze(null),ze.GOOGLE_CREDENTIALS=new ze("google-credentials-uid"),ze.FIRST_PARTY=new ze("first-party-uid"),ze.MOCK_USER=new ze("mock-user");var ws="10.14.0";var Hi=new xt("@firebase/firestore");function ha(){return Hi.logLevel}function V(n,...e){if(Hi.logLevel<=X.DEBUG){let t=e.map(rg);Hi.debug(`Firestore (${ws}): ${n}`,...t)}}function Pn(n,...e){if(Hi.logLevel<=X.ERROR){let t=e.map(rg);Hi.error(`Firestore (${ws}): ${n}`,...t)}}function os(n,...e){if(Hi.logLevel<=X.WARN){let t=e.map(rg);Hi.warn(`Firestore (${ws}): ${n}`,...t)}}function rg(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function W(n="Unexpected state"){let e=`FIRESTORE (${ws}) INTERNAL ASSERTION FAILED: `+n;throw Pn(e),new Error(e)}function de(n,e){n||W()}function Q(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$=class extends ft{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Dn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Xl=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Dp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ze.UNAUTHENTICATED))}shutdown(){}},Pp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Np=class{constructor(e){this.t=e,this.currentUser=ze.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){de(this.o===void 0);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),s=new Dn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dn,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>y(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},c=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dn)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(de(typeof i.accessToken=="string"),new Xl(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return de(e===null||typeof e=="string"),new ze(e)}},kp=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=ze.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},xp=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new kp(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ze.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Mp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Op=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){de(this.o===void 0);let i=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(de(typeof t.token=="string"),this.R=t.token,new Mp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Rx(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Zl=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=Rx(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function ce(n,e){return n<e?-1:n>e?1:0}function as(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var He=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new He(0,0))}static max(){return new n(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var eu=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&W(),i===void 0?i=e.length-t:i>e.length-t&&W(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Fe=class n extends eu{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new $(N.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},Dx=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Tt=class n extends eu{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return Dx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new $(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let c=e[r];if(c==="\\"){if(r+1===e.length)throw new $(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else c==="`"?(o=!o,r++):c!=="."||o?(i+=c,r++):(s(),r++)}if(s(),o)throw new $(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var z=class n{constructor(e){this.path=e}static fromPath(e){return new n(Fe.fromString(e))}static fromName(e){return new n(Fe.fromString(e).popFirst(5))}static empty(){return new n(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Fe(e.slice()))}};var Fp=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Fp.UNKNOWN_ID=-1;function Px(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Y.fromTimestamp(i===1e9?new He(t+1,0):new He(t,i));return new Ki(r,z.empty(),e)}function Nx(n){return new Ki(n.readTime,n.key,-1)}var Ki=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Y.min(),z.empty(),-1)}static max(){return new n(Y.max(),z.empty(),-1)}};function kx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=z.comparator(n.documentKey,e.documentKey),t!==0?t:ce(n.largestBatchId,e.largestBatchId))}var xx="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Pa(n){return y(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==xx)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),c=0;for(let l=0;l<s;l++){let u=l;t(e[u]).next(f=>{o[u]=f,++c,c===s&&i(o)},f=>r(f))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function Mx(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Na(n){return n.name==="IndexedDbTransactionError"}var db=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Pu(n){return n==null}function _a(n){return n===0&&1/n==-1/0}function Ox(n){return typeof n=="number"&&Number.isInteger(n)&&!_a(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Fx=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],n2=[...Fx,"documentOverlays"],Lx=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Vx=Lx,Ux=[...Vx,"indexConfiguration","indexState","indexEntries"];var i2=[...Ux,"globals"];function ME(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xi(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function fb(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Re=class n{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ns(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ns(this.root,e,this.comparator,!1)}getReverseIterator(){return new ns(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ns(this.root,e,this.comparator,!0)}},ns=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ln=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,i,r,s){return this}insert(e,t,i){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var nt=class n{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tu(this.data.getIterator())}getIteratorFrom(e){return new tu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},tu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var cn=class n{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new n([])}unionWith(e){let t=new nt(Tt.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return as(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var nu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var it=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new nu("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};it.EMPTY_BYTE_STRING=new it("");var jx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nn(n){if(de(!!n),typeof n=="string"){let e=0,t=jx.exec(n);if(de(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ve(n.seconds),nanos:ve(n.nanos)}}function ve(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function li(n){return typeof n=="string"?it.fromBase64String(n):it.fromUint8Array(n)}function sg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function og(n){let e=n.mapValue.fields.__previous_value__;return sg(e)?og(e):e}function ya(n){let e=Nn(n.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}var Vp=class{constructor(e,t,i,r,s,o,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=u}},iu=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Kl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sg(n)?4:mb(n)?9007199254740991:pb(n)?10:11:W()}function dn(n,e){if(n===e)return!0;let t=Qi(n);if(t!==Qi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ya(n).isEqual(ya(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=Nn(r.timestampValue),c=Nn(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return li(r.bytesValue).isEqual(li(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ve(r.geoPointValue.latitude)===ve(s.geoPointValue.latitude)&&ve(r.geoPointValue.longitude)===ve(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ve(r.integerValue)===ve(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=ve(r.doubleValue),c=ve(s.doubleValue);return o===c?_a(o)===_a(c):isNaN(o)&&isNaN(c)}return!1}(n,e);case 9:return as(n.arrayValue.values||[],e.arrayValue.values||[],dn);case 10:case 11:return function(r,s){let o=r.mapValue.fields||{},c=s.mapValue.fields||{};if(ME(o)!==ME(c))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!dn(o[l],c[l])))return!1;return!0}(n,e);default:return W()}}function va(n,e){return(n.values||[]).find(t=>dn(t,e))!==void 0}function cs(n,e){if(n===e)return 0;let t=Qi(n),i=Qi(e);if(t!==i)return ce(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ce(n.booleanValue,e.booleanValue);case 2:return function(s,o){let c=ve(s.integerValue||s.doubleValue),l=ve(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return OE(n.timestampValue,e.timestampValue);case 4:return OE(ya(n),ya(e));case 5:return ce(n.stringValue,e.stringValue);case 6:return function(s,o){let c=li(s),l=li(o);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let c=s.split("/"),l=o.split("/");for(let u=0;u<c.length&&u<l.length;u++){let f=ce(c[u],l[u]);if(f!==0)return f}return ce(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let c=ce(ve(s.latitude),ve(o.latitude));return c!==0?c:ce(ve(s.longitude),ve(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return FE(n.arrayValue,e.arrayValue);case 10:return function(s,o){var c,l,u,f;let p=s.fields||{},g=o.fields||{},w=(c=p.value)===null||c===void 0?void 0:c.arrayValue,S=(l=g.value)===null||l===void 0?void 0:l.arrayValue,P=ce(((u=w?.values)===null||u===void 0?void 0:u.length)||0,((f=S?.values)===null||f===void 0?void 0:f.length)||0);return P!==0?P:FE(w,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Kl.mapValue&&o===Kl.mapValue)return 0;if(s===Kl.mapValue)return 1;if(o===Kl.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){let g=ce(l[p],f[p]);if(g!==0)return g;let w=cs(c[l[p]],u[f[p]]);if(w!==0)return w}return ce(l.length,f.length)}(n.mapValue,e.mapValue);default:throw W()}}function OE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ce(n,e);let t=Nn(n),i=Nn(e),r=ce(t.seconds,i.seconds);return r!==0?r:ce(t.nanos,i.nanos)}function FE(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=cs(t[r],i[r]);if(s)return s}return ce(t.length,i.length)}function ls(n){return Up(n)}function Up(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=Nn(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return li(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=Up(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let o of i)s?s=!1:r+=",",r+=`${o}:${Up(t.fields[o])}`;return r+"}"}(n.mapValue):W()}function jp(n){return!!n&&"integerValue"in n}function ag(n){return!!n&&"arrayValue"in n}function LE(n){return!!n&&"nullValue"in n}function VE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Yl(n){return!!n&&"mapValue"in n}function pb(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function fa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Xi(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=fa(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fa(n.arrayValue.values[t]);return e}return Object.assign({},n)}function mb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Lt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Yl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fa(t)}setAll(e){let t=Tt.emptyPath(),i={},r=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=c.popLast()}o?i[c.lastSegment()]=fa(o):r.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());Yl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Yl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Xi(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(fa(this.value))}};function gb(n){let e=[];return Xi(n.fields,(t,i)=>{let r=new Tt([t]);if(Yl(i)){let s=gb(i.mapValue).fields;if(s.length===0)e.push(r);else for(let o of s)e.push(r.child(o))}else e.push(r)}),new cn(e)}var Yt=class n{constructor(e,t,i,r,s,o,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,Y.min(),Y.min(),Y.min(),Lt.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Y.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Y.min(),Y.min(),Lt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Y.min(),Y.min(),Lt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var us=class{constructor(e,t){this.position=e,this.inclusive=t}};function UE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField()?i=z.comparator(z.fromName(o.referenceValue),t.key):i=cs(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function jE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dn(n.position[t],e.position[t]))return!1;return!0}var hs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Bx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ru=class{},Ve=class n extends ru{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new $p(e,t,i):t==="array-contains"?new Gp(e,i):t==="in"?new Wp(e,i):t==="not-in"?new Hp(e,i):t==="array-contains-any"?new Kp(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new zp(e,i):new qp(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(cs(t,this.value)):t!==null&&Qi(this.value)===Qi(t)&&this.matchesComparison(cs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},fn=class n extends ru{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return _b(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function _b(n){return n.op==="and"}function yb(n){return $x(n)&&_b(n)}function $x(n){for(let e of n.filters)if(e instanceof fn)return!1;return!0}function Bp(n){if(n instanceof Ve)return n.field.canonicalString()+n.op.toString()+ls(n.value);if(yb(n))return n.filters.map(e=>Bp(e)).join(",");{let e=n.filters.map(t=>Bp(t)).join(",");return`${n.op}(${e})`}}function vb(n,e){return n instanceof Ve?function(i,r){return r instanceof Ve&&i.op===r.op&&i.field.isEqual(r.field)&&dn(i.value,r.value)}(n,e):n instanceof fn?function(i,r){return r instanceof fn&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,c)=>s&&vb(o,r.filters[c]),!0):!1}(n,e):void W()}function Ib(n){return n instanceof Ve?function(t){return`${t.field.canonicalString()} ${t.op} ${ls(t.value)}`}(n):n instanceof fn?function(t){return t.op.toString()+" {"+t.getFilters().map(Ib).join(" ,")+"}"}(n):"Filter"}var $p=class extends Ve{constructor(e,t,i){super(e,t,i),this.key=z.fromName(i.referenceValue)}matches(e){let t=z.comparator(e.key,this.key);return this.matchesComparison(t)}},zp=class extends Ve{constructor(e,t){super(e,"in",t),this.keys=wb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},qp=class extends Ve{constructor(e,t){super(e,"not-in",t),this.keys=wb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function wb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>z.fromName(i.referenceValue))}var Gp=class extends Ve{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ag(t)&&va(t.arrayValue,this.value)}},Wp=class extends Ve{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&va(this.value.arrayValue,t)}},Hp=class extends Ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(va(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!va(this.value.arrayValue,t)}},Kp=class extends Ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ag(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>va(this.value.arrayValue,i))}};var Qp=class{constructor(e,t=null,i=[],r=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=c,this.ue=null}};function BE(n,e=null,t=[],i=[],r=null,s=null,o=null){return new Qp(n,e,t,i,r,s,o)}function cg(n){let e=Q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Bp(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Pu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>ls(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>ls(i)).join(",")),e.ue=t}return e.ue}function lg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Bx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!vb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jE(n.startAt,e.startAt)&&jE(n.endAt,e.endAt)}function Yp(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var ds=class{constructor(e,t=null,i=[],r=[],s=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function zx(n,e,t,i,r,s,o,c){return new ds(n,e,t,i,r,s,o,c)}function ug(n){return new ds(n)}function $E(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qx(n){return n.collectionGroup!==null}function pa(n){let e=Q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new nt(Tt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new hs(s,i))}),t.has(Tt.keyField().canonicalString())||e.ce.push(new hs(Tt.keyField(),i))}return e.ce}function un(n){let e=Q(n);return e.le||(e.le=Gx(e,pa(n))),e.le}function Gx(n,e){if(n.limitType==="F")return BE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new hs(r.field,s)});let t=n.endAt?new us(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new us(n.startAt.position,n.startAt.inclusive):null;return BE(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Jp(n,e,t){return new ds(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nu(n,e){return lg(un(n),un(e))&&n.limitType===e.limitType}function Eb(n){return`${cg(un(n))}|lt:${n.limitType}`}function Zr(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>Ib(r)).join(", ")}]`),Pu(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>ls(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>ls(r)).join(",")),`Target(${i})`}(un(n))}; limitType=${n.limitType})`}function ku(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):z.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of pa(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,c,l){let u=UE(o,c,l);return o.inclusive?u<=0:u<0}(i.startAt,pa(i),r)||i.endAt&&!function(o,c,l){let u=UE(o,c,l);return o.inclusive?u>=0:u>0}(i.endAt,pa(i),r))}(n,e)}function Wx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bb(n){return(e,t)=>{let i=!1;for(let r of pa(n)){let s=Hx(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Hx(n,e,t){let i=n.field.isKeyField()?z.comparator(e.key,t.key):function(s,o,c){let l=o.data.field(s),u=c.data.field(s);return l!==null&&u!==null?cs(l,u):W()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return W()}}var ui=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Xi(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return fb(this.inner)}size(){return this.innerSize}};var Kx=new Re(z.comparator);function kn(){return Kx}var Tb=new Re(z.comparator);function da(...n){let e=Tb;for(let t of n)e=e.insert(t.key,t);return e}function Cb(n){let e=Tb;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function zi(){return ma()}function Ab(){return ma()}function ma(){return new ui(n=>n.toString(),(n,e)=>n.isEqual(e))}var Qx=new Re(z.comparator),Yx=new nt(z.comparator);function ee(...n){let e=Yx;for(let t of n)e=e.add(t);return e}var Jx=new nt(ce);function Xx(){return Jx}function hg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_a(e)?"-0":e}}function Sb(n){return{integerValue:""+n}}function Zx(n,e){return Ox(e)?Sb(e):hg(n,e)}var fs=class{constructor(){this._=void 0}};function eM(n,e,t){return n instanceof ps?function(r,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&sg(s)&&(s=og(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Yi?Db(n,e):n instanceof Ji?Pb(n,e):function(r,s){let o=Rb(r,s),c=zE(o)+zE(r.Pe);return jp(o)&&jp(r.Pe)?Sb(c):hg(r.serializer,c)}(n,e)}function tM(n,e,t){return n instanceof Yi?Db(n,e):n instanceof Ji?Pb(n,e):t}function Rb(n,e){return n instanceof ms?function(i){return jp(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var ps=class extends fs{},Yi=class extends fs{constructor(e){super(),this.elements=e}};function Db(n,e){let t=Nb(e);for(let i of n.elements)t.some(r=>dn(r,i))||t.push(i);return{arrayValue:{values:t}}}var Ji=class extends fs{constructor(e){super(),this.elements=e}};function Pb(n,e){let t=Nb(e);for(let i of n.elements)t=t.filter(r=>!dn(r,i));return{arrayValue:{values:t}}}var ms=class extends fs{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function zE(n){return ve(n.integerValue||n.doubleValue)}function Nb(n){return ag(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function nM(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof Yi&&r instanceof Yi||i instanceof Ji&&r instanceof Ji?as(i.elements,r.elements,dn):i instanceof ms&&r instanceof ms?dn(i.Pe,r.Pe):i instanceof ps&&r instanceof ps}(n.transform,e.transform)}var Xp=class{constructor(e,t){this.version=e,this.transformResults=t}},Wi=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Jl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var gs=class{};function kb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new su(n.key,Wi.none()):new _s(n.key,n.data,Wi.none());{let t=n.data,i=Lt.empty(),r=new nt(Tt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new xn(n.key,i,new cn(r.toArray()),Wi.none())}}function iM(n,e,t){n instanceof _s?function(r,s,o){let c=r.value.clone(),l=GE(r.fieldTransforms,s,o.transformResults);c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):n instanceof xn?function(r,s,o){if(!Jl(r.precondition,s))return void s.convertToUnknownDocument(o.version);let c=GE(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(xb(r)),l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ga(n,e,t,i){return n instanceof _s?function(s,o,c,l){if(!Jl(s.precondition,o))return c;let u=s.value.clone(),f=WE(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof xn?function(s,o,c,l){if(!Jl(s.precondition,o))return c;let u=WE(s.fieldTransforms,l,o),f=o.data;return f.setAll(xb(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,i):function(s,o,c){return Jl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,e,t)}function rM(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=Rb(i.transform,r||null);s!=null&&(t===null&&(t=Lt.empty()),t.set(i.field,s))}return t||null}function qE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&as(i,r,(s,o)=>nM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var _s=class extends gs{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},xn=class extends gs{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function xb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function GE(n,e,t){let i=new Map;de(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,c=e.data.field(s.field);i.set(s.field,tM(o,c,t[r]))}return i}function WE(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,eM(s,o,e))}return i}var su=class extends gs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Zp=class extends gs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var em=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&iM(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=ga(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=ga(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=Ab();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(r.key)?null:c;let l=kb(o,c);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(Y.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ee())}isEqual(e){return this.batchId===e.batchId&&as(this.mutations,e.mutations,(t,i)=>qE(t,i))&&as(this.baseMutations,e.baseMutations,(t,i)=>qE(t,i))}},tm=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){de(e.mutations.length===i.length);let r=function(){return Qx}(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var nm=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var im=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Me,ie;function sM(n){switch(n){default:return W();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function Mb(n){if(n===void 0)return Pn("GRPC error has no .code"),N.UNKNOWN;switch(n){case Me.OK:return N.OK;case Me.CANCELLED:return N.CANCELLED;case Me.UNKNOWN:return N.UNKNOWN;case Me.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Me.INTERNAL:return N.INTERNAL;case Me.UNAVAILABLE:return N.UNAVAILABLE;case Me.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Me.NOT_FOUND:return N.NOT_FOUND;case Me.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Me.ABORTED:return N.ABORTED;case Me.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Me.DATA_LOSS:return N.DATA_LOSS;default:return W()}}(ie=Me||(Me={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";var HE=null;function oM(){return new TextEncoder}var aM=new ci([4294967295,4294967295],0);function KE(n){let e=oM().encode(n),t=new vp;return t.update(e),new Uint8Array(t.digest())}function QE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ci([t,i],0),new ci([r,s],0)]}var rm=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new qi(`Invalid padding: ${t}`);if(i<0)throw new qi(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new qi(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new qi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ci.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(ci.fromNumber(i)));return r.compare(aM)===1&&(r=new ci([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=KE(e),[i,r]=QE(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;let t=KE(e),[i,r]=QE(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},qi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ou=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Ia.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Y.min(),r,new Re(ce),kn(),ee())}},Ia=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,ee(),ee(),ee())}};var is=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},au=class{constructor(e,t){this.targetId=e,this.me=t}},cu=class{constructor(e,t,i=it.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},lu=class{constructor(){this.fe=0,this.ge=JE(),this.pe=it.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ee(),t=ee(),i=ee();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:W()}}),new Ia(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=JE()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,de(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},sm=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=kn(),this.qe=YE(),this.Qe=new Re(ce)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(Yp(s))if(i===0){let o=new z(s.path);this.Ue(t,o,Yt.newNoDocument(o,Y.min()))}else de(i===1);else{let o=this.Ye(t);if(o!==i){let c=this.Ze(e),l=c?this.Xe(c,e,o):1;if(l!==0){this.je(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}HE?.et(function(f,p,g,w,S){var P,D,U,j,F,oe;let Ie={localCacheCount:f,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},te=p.unchangedNames;return te&&(Ie.bloomFilter={applied:S===0,hashCount:(P=te?.hashCount)!==null&&P!==void 0?P:0,bitmapLength:(j=(U=(D=te?.bits)===null||D===void 0?void 0:D.bitmap)===null||U===void 0?void 0:U.length)!==null&&j!==void 0?j:0,padding:(oe=(F=te?.bits)===null||F===void 0?void 0:F.padding)!==null&&oe!==void 0?oe:0,mightContain:b=>{var _;return(_=w?.mightContain(b))!==null&&_!==void 0&&_}}),Ie}(o,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o,c;try{o=li(i).toUint8Array()}catch(l){if(l instanceof nu)return os("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new rm(o,r,s)}catch(l){return os(l instanceof qi?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let c=this.Je(o);if(c){if(s.current&&Yp(c.target)){let l=new z(c.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Yt.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let i=ee();this.qe.forEach((s,o)=>{let c=!0;o.forEachWhile(l=>{let u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let r=new ou(e,t,this.Qe,this.ke,i);return this.ke=kn(),this.qe=YE(),this.Qe=new Re(ce),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new lu,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new nt(ce),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new lu),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function YE(){return new Re(z.comparator)}function JE(){return new Re(z.comparator)}var cM={asc:"ASCENDING",desc:"DESCENDING"},lM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uM={and:"AND",or:"OR"},om=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function am(n,e){return n.useProto3Json||Pu(e)?e:{value:e}}function uu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ob(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hM(n,e){return uu(n,e.toTimestamp())}function hn(n){return de(!!n),Y.fromTimestamp(function(t){let i=Nn(t);return new He(i.seconds,i.nanos)}(n))}function dg(n,e){return cm(n,e).canonicalString()}function cm(n,e){let t=function(r){return new Fe(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Fb(n){let e=Fe.fromString(n);return de(Bb(e)),e}function lm(n,e){return dg(n.databaseId,e.path)}function Cp(n,e){let t=Fb(e);if(t.get(1)!==n.databaseId.projectId)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new z(Vb(t))}function Lb(n,e){return dg(n.databaseId,e)}function dM(n){let e=Fb(n);return e.length===4?Fe.emptyPath():Vb(e)}function um(n){return new Fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Vb(n){return de(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function XE(n,e,t){return{name:lm(n,e),fields:t.value.mapValue.fields}}function fM(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(de(f===void 0||typeof f=="string"),it.fromBase64String(f||"")):(de(f===void 0||f instanceof Buffer||f instanceof Uint8Array),it.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(u){let f=u.code===void 0?N.UNKNOWN:Mb(u.code);return new $(f,u.message||"")}(o);t=new cu(i,r,s,c||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Cp(n,i.document.name),s=hn(i.document.updateTime),o=i.document.createTime?hn(i.document.createTime):Y.min(),c=new Lt({mapValue:{fields:i.document.fields}}),l=Yt.newFoundDocument(r,s,o,c),u=i.targetIds||[],f=i.removedTargetIds||[];t=new is(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Cp(n,i.document),s=i.readTime?hn(i.readTime):Y.min(),o=Yt.newNoDocument(r,s),c=i.removedTargetIds||[];t=new is([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Cp(n,i.document),s=i.removedTargetIds||[];t=new is([],s,r,null)}else{if(!("filter"in e))return W();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new im(r,s),c=i.targetId;t=new au(c,o)}}return t}function pM(n,e){let t;if(e instanceof _s)t={update:XE(n,e.key,e.value)};else if(e instanceof su)t={delete:lm(n,e.key)};else if(e instanceof xn)t={update:XE(n,e.key,e.data),updateMask:bM(e.fieldMask)};else{if(!(e instanceof Zp))return W();t={verify:lm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){let c=o.transform;if(c instanceof ps)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Yi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ji)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ms)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw W()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:hM(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(n,e.precondition)),t}function mM(n,e){return n&&n.length>0?(de(e!==void 0),n.map(t=>function(r,s){let o=r.updateTime?hn(r.updateTime):hn(s);return o.isEqual(Y.min())&&(o=hn(s)),new Xp(o,r.transformResults||[])}(t,e))):[]}function gM(n,e){return{documents:[Lb(n,e.path)]}}function _M(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Lb(n,r);let s=function(u){if(u.length!==0)return jb(fn.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:es(g.field),direction:IM(g.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=am(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:r}}function yM(n){let e=dM(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){de(i===1);let f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let g=Ub(p);return g instanceof fn&&yb(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(g=>function(S){return new hs(ts(S.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(t.orderBy));let c=null;t.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,Pu(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(p){let g=!!p.before,w=p.values||[];return new us(w,g)}(t.startAt));let u=null;return t.endAt&&(u=function(p){let g=!p.before,w=p.values||[];return new us(w,g)}(t.endAt)),zx(e,r,o,s,c,"F",l,u)}function vM(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ub(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=ts(t.unaryFilter.field);return Ve.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=ts(t.unaryFilter.field);return Ve.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ts(t.unaryFilter.field);return Ve.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ts(t.unaryFilter.field);return Ve.create(o,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return Ve.create(ts(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return fn.create(t.compositeFilter.filters.map(i=>Ub(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function IM(n){return cM[n]}function wM(n){return lM[n]}function EM(n){return uM[n]}function es(n){return{fieldPath:n.canonicalString()}}function ts(n){return Tt.fromServerFormat(n.fieldPath)}function jb(n){return n instanceof Ve?function(t){if(t.op==="=="){if(VE(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(LE(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(VE(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NAN"}};if(LE(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(t.field),op:wM(t.op),value:t.value}}}(n):n instanceof fn?function(t){let i=t.getFilters().map(r=>jb(r));return i.length===1?i[0]:{compositeFilter:{op:EM(t.op),filters:i}}}(n):W()}function bM(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Bb(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var wa=class n{constructor(e,t,i,r,s=Y.min(),o=Y.min(),c=it.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var hm=class{constructor(e){this.ct=e}};function TM(n){let e=yM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Jp(e,e.limit,"L"):e}var hu=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ve(e.integerValue));else if("doubleValue"in e){let i=ve(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),_a(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=Nn(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(li(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?mb(e)?this.dt(t,Number.MAX_SAFE_INTEGER):pb(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):W()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;let s=e.fields||{};this.dt(t,53);let o="value",c=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(ve(c)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),z.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};hu.vt=new hu;var dm=class{constructor(){this.un=new fm}addToCollectionParentIndex(e,t){return this.un.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(Ki.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(Ki.min())}updateCollectionGroup(e,t,i){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},fm=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new nt(Fe.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new nt(Fe.comparator)).toArray()}};var s2=new Uint8Array(0);var an=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};an.DEFAULT_COLLECTION_PERCENTILE=10,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,an.DEFAULT=new an(41943040,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),an.DISABLED=new an(-1,0,0);var Ea=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var pm=class{constructor(){this.changes=new ui(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?k.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var mm=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var gm=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&ga(i.mutation,r,cn.empty(),He.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ee()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ee()){let r=zi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=da();return s.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=zi();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ee()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,i,r){let s=kn(),o=ma(),c=function(){return ma()}();return t.forEach((l,u)=>{let f=i.get(u.key);r.has(u.key)&&(f===void 0||f.mutation instanceof xn)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),ga(f.mutation,u,f.mutation.getFieldMask(),He.now())):o.set(u.key,cn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),t.forEach((u,f)=>{var p;return c.set(u,new mm(f,(p=o.get(u))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,t){let i=ma(),r=new Re((o,c)=>o-c),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let f=i.get(l)||cn.empty();f=c.applyToLocalView(u,f),i.set(l,f);let p=(r.get(c.batchId)||ee()).add(l);r=r.insert(c.batchId,p)})}).next(()=>{let o=[],c=r.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),u=l.key,f=l.value,p=Ab();f.forEach(g=>{if(!s.has(g)){let w=kb(t.get(g),i.get(g));w!==null&&p.set(g,w),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return k.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):k.resolve(zi()),c=-1,l=s;return o.next(u=>k.forEach(u,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ee())).next(f=>({batchId:c,changes:Cb(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new z(t)).next(i=>{let r=da();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=da();return this.indexManager.getCollectionParents(e,s).next(c=>k.forEach(c,l=>{let u=function(p,g){return new ds(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,u)=>{let f=u.getKey();o.get(f)===null&&(o=o.insert(f,Yt.newInvalidDocument(f)))});let c=da();return o.forEach((l,u)=>{let f=s.get(l);f!==void 0&&ga(f.mutation,u,cn.empty(),He.now()),ku(t,u)&&(c=c.insert(l,u))}),c})}};var _m=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return k.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:hn(r.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:TM(r.bundledQuery),readTime:hn(r.readTime)}}(t)),k.resolve()}};var ym=class{constructor(){this.overlays=new Re(z.comparator),this.Ir=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let i=zi();return k.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),k.resolve()}getOverlaysForCollection(e,t,i){let r=zi(),s=t.length+1,o=new z(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let l=c.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return k.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Re((u,f)=>u-f),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let f=s.get(u.largestBatchId);f===null&&(f=zi(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}let c=zi(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>c.set(u,f)),!(c.size()>=r)););return k.resolve(c)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new nm(t,i));let s=this.Ir.get(t);s===void 0&&(s=ee(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var vm=class{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var ba=class{constructor(){this.Tr=new nt(Oe.Er),this.dr=new nt(Oe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new Oe(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new Oe(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new z(new Fe([])),i=new Oe(t,e),r=new Oe(t,e+1),s=[];return this.dr.forEachInRange([i,r],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new z(new Fe([])),i=new Oe(t,e),r=new Oe(t,e+1),s=ee();return this.dr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Oe(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},Oe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return z.comparator(e.key,t.key)||ce(e.wr,t.wr)}static Ar(e,t){return ce(e.wr,t.wr)||z.comparator(e.key,t.key)}};var Im=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new nt(Oe.Er)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new em(s,t,i,r);this.mutationQueue.push(o);for(let c of r)this.br=this.br.add(new Oe(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.vr(i),s=r<0?0:r;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new Oe(t,0),r=new Oe(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],o=>{let c=this.Dr(o.wr);s.push(c)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new nt(ce);return t.forEach(r=>{let s=new Oe(r,0),o=new Oe(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],c=>{i=i.add(c.wr)})}),k.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;z.isDocumentKey(s)||(s=s.child(""));let o=new Oe(new z(s),0),c=new nt(ce);return this.br.forEachWhile(l=>{let u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(c=c.add(l.wr)),!0)},o),k.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(i=>{let r=this.Dr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){de(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return k.forEach(t.mutations,r=>{let s=new Oe(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new Oe(t,0),r=this.br.firstAfterOrEqual(i);return k.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var wm=class{constructor(e){this.Mr=e,this.docs=function(){return new Re(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return k.resolve(i?i.document.mutableCopy():Yt.newInvalidDocument(t))}getEntries(e,t){let i=kn();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Yt.newInvalidDocument(r))}),k.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=kn(),o=t.path,c=new z(o.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||kx(Nx(f),i)<=0||(r.has(f.key)||ku(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,i,r){W()}Or(e,t){return k.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Em(this)}getSize(e){return k.resolve(this.size)}},Em=class extends pm{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),k.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var bm=class{constructor(e){this.persistence=e,this.Nr=new ui(t=>cg(t),lg),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ba,this.targetCount=0,this.kr=Ea.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,r)=>t(r)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),k.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Ea(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Kn(t),k.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),k.waitFor(s).next(()=>r)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return k.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),k.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return k.resolve(i)}containsKey(e,t){return k.resolve(this.Br.containsKey(t))}};var Tm=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new db(0),this.Kr=!1,this.Kr=!0,this.$r=new vm,this.referenceDelegate=e(this),this.Ur=new bm(this),this.indexManager=new dm,this.remoteDocumentCache=function(r){return new wm(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new hm(t),this.Gr=new _m(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ym,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new Im(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){V("MemoryPersistence","Starting transaction:",e);let r=new Cm(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(e,t){return k.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},Cm=class extends Lp{constructor(e){super(),this.currentSequenceNumber=e}},Am=class n{constructor(e){this.persistence=e,this.Jr=new ba,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw W()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),k.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),k.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Xr,i=>{let r=z.fromPath(i);return this.ei(e,r).next(s=>{s||t.removeEntry(r,Y.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return k.or([()=>k.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Sm=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=ee(),r=ee();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var Rm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Dm=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rw()?8:Mx(Be())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Rm;return this.Xi(e,t,o).next(c=>{if(s.result=c,this.zi)return this.es(e,t,o,c.size)})}).next(()=>s.result)}es(e,t,i,r){return i.documentReadCount<this.ji?(ha()<=X.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",Zr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),k.resolve()):(ha()<=X.DEBUG&&V("QueryEngine","Query:",Zr(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(ha()<=X.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",Zr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(t))):k.resolve())}Yi(e,t){if($E(t))return k.resolve(null);let i=un(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Jp(t,null,"F"),i=un(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=ee(...s);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,i).next(l=>{let u=this.ts(t,c);return this.ns(t,u,o,l.readTime)?this.Yi(e,Jp(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,i,r){return $E(t)||r.isEqual(Y.min())?k.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let o=this.ts(t,s);return this.ns(t,o,i,r)?k.resolve(null):(ha()<=X.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zr(t)),this.rs(e,o,t,Px(r,-1)).next(c=>c))})}ts(e,t){let i=new nt(bb(e));return t.forEach((r,s)=>{ku(e,s)&&(i=i.add(s))}),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,i){return ha()<=X.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Zr(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ki.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Pm=class{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Re(ce),this._s=new ui(s=>cg(s),lg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gm(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function CM(n,e,t,i){return new Pm(n,e,t,i)}function $b(n,e){return y(this,null,function*(){let t=Q(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let o=[],c=[],l=ee();for(let u of r){o.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}for(let u of s){c.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(i,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:c}))})})})}function AM(n,e){let t=Q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,u,f){let p=u.batch,g=p.keys(),w=k.resolve();return g.forEach(S=>{w=w.next(()=>f.getEntry(l,S)).next(P=>{let D=u.docVersions.get(S);de(D!==null),P.version.compareTo(D)<0&&(p.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),f.addEntry(P)))})}),w.next(()=>c.mutationQueue.removeMutationBatch(l,p))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let l=ee();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(l=l.add(c.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function zb(n){let e=Q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function SM(n,e){let t=Q(n),i=e.snapshotVersion,r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;let c=[];e.targetChanges.forEach((f,p)=>{let g=r.get(p);if(!g)return;c.push(t.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,f.addedDocuments,p)));let w=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(it.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,i)),r=r.insert(p,w),function(P,D,U){return P.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(g,w,f)&&c.push(t.Ur.updateTargetData(s,w))});let l=kn(),u=ee();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(RM(s,o,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!i.isEqual(Y.min())){let f=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(f)}return k.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=r,s))}function RM(n,e,t){let i=ee(),r=ee();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=kn();return t.forEach((c,l)=>{let u=s.get(c);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),l.isNoDocument()&&l.version.isEqual(Y.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):V("LocalStore","Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:r}})}function DM(n,e){let t=Q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function PM(n,e){let t=Q(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ur.getTargetData(i,e).next(s=>s?(r=s,k.resolve(r)):t.Ur.allocateTargetId(i).next(o=>(r=new wa(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function Nm(n,e,t){return y(this,null,function*(){let i=Q(n),r=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Na(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.os=i.os.remove(e),i._s.delete(r.target)})}function ZE(n,e,t){let i=Q(n),r=Y.min(),s=ee();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){let p=Q(l),g=p._s.get(f);return g!==void 0?k.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(i,o,un(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(o,c.targetId).next(l=>{s=l})}).next(()=>i.ss.getDocumentsMatchingQuery(o,e,t?r:Y.min(),t?s:ee())).next(c=>(NM(i,Wx(e),c),{documents:c,Ts:s})))}function NM(n,e,t){let i=n.us.get(e)||Y.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}var du=class{constructor(){this.activeTargetIds=Xx()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var km=class{constructor(){this.so=new du,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new du,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var xm=class{_o(e){}shutdown(){}};var fu=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ql=null;function Ap(){return Ql===null?Ql=function(){return 268435456+Math.round(2147483648*Math.random())}():Ql++,"0x"+Ql.toString(16)}var kM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Mm=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var tt="WebChannelConnection",Om=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(t,i,r,s,o){let c=Ap(),l=this.xo(t,i.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${c}:`,l,r);let u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,r).then(f=>(V("RestConnection",`Received RPC '${t}' ${c}: `,f),f),f=>{throw os("RestConnection",`RPC '${t}' ${c} failed with error: `,f,"url: ",l,"request:",r),f})}Lo(t,i,r,s,o,c){return this.Mo(t,i,r,s,o)}Oo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ws}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}xo(t,i){let r=kM[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){let s=Ap();return new Promise((o,c)=>{let l=new Ip;l.setWithCredentials(!0),l.listenOnce(wp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ua.NO_ERROR:let f=l.getResponseJson();V(tt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case ua.TIMEOUT:V(tt,`RPC '${e}' ${s} timed out`),c(new $(N.DEADLINE_EXCEEDED,"Request time out"));break;case ua.HTTP_ERROR:let p=l.getStatus();if(V(tt,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let w=g?.error;if(w&&w.status&&w.message){let S=function(D){let U=D.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(U)>=0?U:N.UNKNOWN}(w.status);c(new $(S,w.message))}else c(new $(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new $(N.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{V(tt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(r);V(tt,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",u,i,15)})}Bo(e,t,i){let r=Ap(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tp(),c=bp(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;let f=s.join("");V(tt,`Creating RPC '${e}' stream ${r}: ${f}`,l);let p=o.createWebChannel(f,l),g=!1,w=!1,S=new Mm({Io:D=>{w?V(tt,`Not sending because RPC '${e}' stream ${r} is closed:`,D):(g||(V(tt,`Opening RPC '${e}' stream ${r} transport.`),p.open(),g=!0),V(tt,`RPC '${e}' stream ${r} sending:`,D),p.send(D))},To:()=>p.close()}),P=(D,U,j)=>{D.listen(U,F=>{try{j(F)}catch(oe){setTimeout(()=>{throw oe},0)}})};return P(p,Xr.EventType.OPEN,()=>{w||(V(tt,`RPC '${e}' stream ${r} transport opened.`),S.yo())}),P(p,Xr.EventType.CLOSE,()=>{w||(w=!0,V(tt,`RPC '${e}' stream ${r} transport closed`),S.So())}),P(p,Xr.EventType.ERROR,D=>{w||(w=!0,os(tt,`RPC '${e}' stream ${r} transport errored:`,D),S.So(new $(N.UNAVAILABLE,"The operation could not be completed")))}),P(p,Xr.EventType.MESSAGE,D=>{var U;if(!w){let j=D.data[0];de(!!j);let F=j,oe=F.error||((U=F[0])===null||U===void 0?void 0:U.error);if(oe){V(tt,`RPC '${e}' stream ${r} received error:`,oe);let Ie=oe.status,te=function(I){let E=Me[I];if(E!==void 0)return Mb(E)}(Ie),b=oe.message;te===void 0&&(te=N.INTERNAL,b="Unknown error status: "+Ie+" with message "+oe.message),w=!0,S.So(new $(te,b)),p.close()}else V(tt,`RPC '${e}' stream ${r} received:`,j),S.bo(j)}}),P(c,Ep.STAT_EVENT,D=>{D.stat===Hl.PROXY?V(tt,`RPC '${e}' stream ${r} detected buffering proxy`):D.stat===Hl.NOPROXY&&V(tt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}};function Sp(){return typeof document<"u"?document:null}function xu(n){return new om(n,!0)}var pu=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&V("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var mu=class{constructor(e,t,i,r,s,o,c,l){this.ui=e,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new pu(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Pn(t.toString()),Pn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===t&&this.P_(i,r)},i=>{e(()=>{let r=new $(N.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Fm=class extends mu{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=fM(this.serializer,e),i=function(s){if(!("targetChange"in s))return Y.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?hn(o.readTime):Y.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=um(this.serializer),t.addTarget=function(s,o){let c,l=o.target;if(c=Yp(l)?{documents:gM(s,l)}:{query:_M(s,l)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Ob(s,o.resumeToken);let u=am(s,o.expectedCount);u!==null&&(c.expectedCount=u)}else if(o.snapshotVersion.compareTo(Y.min())>0){c.readTime=uu(s,o.snapshotVersion.toTimestamp());let u=am(s,o.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);let i=vM(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=um(this.serializer),t.removeTarget=e,this.a_(t)}},Lm=class extends mu{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return de(!!e.streamToken),this.lastStreamToken=e.streamToken,de(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){de(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=mM(e.writeResults,e.commitTime),i=hn(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=um(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>pM(this.serializer,i))};this.a_(t)}};var Vm=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,cm(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(N.UNKNOWN,s.toString())})}Lo(e,t,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,cm(t,i),r,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(N.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Um=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Pn(t),this.D_=!1):V("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var jm=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{i.enqueueAndForget(()=>y(this,null,function*(){Zi(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(l){return y(this,null,function*(){let u=Q(l);u.L_.add(4),yield ka(u),u.q_.set("Unknown"),u.L_.delete(4),yield Mu(u)})}(this))}))}),this.q_=new Um(i,r)}};function Mu(n){return y(this,null,function*(){if(Zi(n))for(let e of n.B_)yield e(!0)})}function ka(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function qb(n,e){let t=Q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),gg(t)?mg(t):Es(t).r_()&&pg(t,e))}function fg(n,e){let t=Q(n),i=Es(t);t.N_.delete(e),i.r_()&&Gb(t,e),t.N_.size===0&&(i.r_()?i.o_():Zi(t)&&t.q_.set("Unknown"))}function pg(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Es(n).A_(e)}function Gb(n,e){n.Q_.xe(e),Es(n).R_(e)}function mg(n){n.Q_=new sm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Es(n).start(),n.q_.v_()}function gg(n){return Zi(n)&&!Es(n).n_()&&n.N_.size>0}function Zi(n){return Q(n).L_.size===0}function Wb(n){n.Q_=void 0}function xM(n){return y(this,null,function*(){n.q_.set("Online")})}function MM(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{pg(n,e)})})}function OM(n,e){return y(this,null,function*(){Wb(n),gg(n)?(n.q_.M_(e),mg(n)):n.q_.set("Unknown")})}function FM(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof cu&&e.state===2&&e.cause)try{yield function(r,s){return y(this,null,function*(){let o=s.cause;for(let c of s.targetIds)r.N_.has(c)&&(yield r.remoteSyncer.rejectListen(c,o),r.N_.delete(c),r.Q_.removeTarget(c))})}(n,e)}catch(i){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield gu(n,i)}else if(e instanceof is?n.Q_.Ke(e):e instanceof au?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Y.min()))try{let i=yield zb(n.localStore);t.compareTo(i)>=0&&(yield function(s,o){let c=s.Q_.rt(o);return c.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,u)=>{let f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(it.EMPTY_BYTE_STRING,f.snapshotVersion)),Gb(s,l);let p=new wa(f.target,l,u,f.sequenceNumber);pg(s,p)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(i){V("RemoteStore","Failed to raise snapshot:",i),yield gu(n,i)}})}function gu(n,e,t){return y(this,null,function*(){if(!Na(e))throw e;n.L_.add(1),yield ka(n),n.q_.set("Offline"),t||(t=()=>zb(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Mu(n)}))})}function Hb(n,e){return e().catch(t=>gu(n,t,e))}function Ou(n){return y(this,null,function*(){let e=Q(n),t=hi(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;LM(e);)try{let r=yield DM(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,VM(e,r)}catch(r){yield gu(e,r)}Kb(e)&&Qb(e)})}function LM(n){return Zi(n)&&n.O_.length<10}function VM(n,e){n.O_.push(e);let t=hi(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Kb(n){return Zi(n)&&!hi(n).n_()&&n.O_.length>0}function Qb(n){hi(n).start()}function UM(n){return y(this,null,function*(){hi(n).p_()})}function jM(n){return y(this,null,function*(){let e=hi(n);for(let t of n.O_)e.m_(t.mutations)})}function BM(n,e,t){return y(this,null,function*(){let i=n.O_.shift(),r=tm.from(i,e,t);yield Hb(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Ou(n)})}function $M(n,e){return y(this,null,function*(){e&&hi(n).V_&&(yield function(i,r){return y(this,null,function*(){if(function(o){return sM(o)&&o!==N.ABORTED}(r.code)){let s=i.O_.shift();hi(i).s_(),yield Hb(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield Ou(i)}})}(n,e)),Kb(n)&&Qb(n)})}function eb(n,e){return y(this,null,function*(){let t=Q(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let i=Zi(t);t.L_.add(3),yield ka(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Mu(t)})}function zM(n,e){return y(this,null,function*(){let t=Q(n);e?(t.L_.delete(2),yield Mu(t)):e||(t.L_.add(2),yield ka(t),t.q_.set("Unknown"))})}function Es(n){return n.K_||(n.K_=function(t,i,r){let s=Q(t);return s.w_(),new Fm(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:xM.bind(null,n),Ro:MM.bind(null,n),mo:OM.bind(null,n),d_:FM.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),gg(n)?mg(n):n.q_.set("Unknown")):(yield n.K_.stop(),Wb(n))}))),n.K_}function hi(n){return n.U_||(n.U_=function(t,i,r){let s=Q(t);return s.w_(),new Lm(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UM.bind(null,n),mo:$M.bind(null,n),f_:jM.bind(null,n),g_:BM.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield Ou(n)):(yield n.U_.stop(),n.O_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Bm=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Dn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,c=new n(e,t,o,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function _g(n,e){if(Pn("AsyncQueue",`${e}: ${n}`),Na(n))return new $(N.UNAVAILABLE,`${e}: ${n}`);throw n}var _u=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||z.comparator(t.key,i.key):(t,i)=>z.comparator(t.key,i.key),this.keyedMap=da(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var yu=class{constructor(){this.W_=new Re(z.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):W():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},ys=class n{constructor(e,t,i,r,s,o,c,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,_u.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var $m=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},zm=class{constructor(){this.queries=tb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let r=Q(t),s=r.queries;r.queries=tb(),s.forEach((o,c)=>{for(let l of c.j_)l.onError(i)})})(this,new $(N.ABORTED,"Firestore shutting down"))}};function tb(){return new ui(n=>Eb(n),Nu)}function qM(n,e){return y(this,null,function*(){let t=Q(n),i=3,r=e.query,s=t.queries.get(r);s?!s.H_()&&e.J_()&&(i=2):(s=new $m,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(r,!0);break;case 1:s.z_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){let c=_g(o,`Initialization of query '${Zr(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&yg(t)})}function GM(n,e){return y(this,null,function*(){let t=Q(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?r=e.J_()?0:1:!s.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function WM(n,e){let t=Q(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let c of o.j_)c.X_(r)&&(i=!0);o.z_=r}}i&&yg(t)}function HM(n,e,t){let i=Q(n),r=i.queries.get(e);if(r)for(let s of r.j_)s.onError(t);i.queries.delete(e)}function yg(n){n.Y_.forEach(e=>{e.next()})}var qm,nb;(nb=qm||(qm={})).ea="default",nb.Cache="cache";var Gm=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new ys(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ys.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==qm.Cache}};var vu=class{constructor(e){this.key=e}},Iu=class{constructor(e){this.key=e}},Wm=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ee(),this.mutatedKeys=ee(),this.Aa=bb(e),this.Ra=new _u(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new yu,r=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=r,c=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,p)=>{let g=r.get(f),w=ku(this.query,p)?p:null,S=!!g&&this.mutatedKeys.has(g.key),P=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),D=!1;g&&w?g.data.isEqual(w.data)?S!==P&&(i.track({type:3,doc:w}),D=!0):this.ga(g,w)||(i.track({type:2,doc:w}),D=!0,(l&&this.Aa(w,l)>0||u&&this.Aa(w,u)<0)&&(c=!0)):!g&&w?(i.track({type:0,doc:w}),D=!0):g&&!w&&(i.track({type:1,doc:g}),D=!0,(l||u)&&(c=!0)),D&&(w?(o=o.add(w),s=P?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),i.track({type:1,doc:f})}return{Ra:o,fa:i,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((f,p)=>function(w,S){let P=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return P(w)-P(S)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(i),r=r!=null&&r;let c=t&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new ys(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new yu,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ee(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new Iu(i))}),this.da.forEach(i=>{e.has(i)||t.push(new vu(i))}),t}ba(e){this.Ta=e.Ts,this.da=ee();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ys.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Hm=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},Km=class{constructor(e){this.key=e,this.va=!1}},Qm=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ui(c=>Eb(c),Nu),this.Ma=new Map,this.xa=new Set,this.Oa=new Re(z.comparator),this.Na=new Map,this.La=new ba,this.Ba={},this.ka=new Map,this.qa=Ea.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function KM(n,e,t=!0){return y(this,null,function*(){let i=tT(n),r,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield Yb(i,e,t,!0),r})}function QM(n,e){return y(this,null,function*(){let t=tT(n);yield Yb(t,e,!0,!1)})}function Yb(n,e,t,i){return y(this,null,function*(){let r=yield PM(n.localStore,un(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return i&&(c=yield YM(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&qb(n.remoteStore,r),c})}function YM(n,e,t,i,r){return y(this,null,function*(){n.Ka=(p,g,w)=>function(P,D,U,j){return y(this,null,function*(){let F=D.view.ma(U);F.ns&&(F=yield ZE(P.localStore,D.query,!1).then(({documents:b})=>D.view.ma(b,F)));let oe=j&&j.targetChanges.get(D.targetId),Ie=j&&j.targetMismatches.get(D.targetId)!=null,te=D.view.applyChanges(F,P.isPrimaryClient,oe,Ie);return rb(P,D.targetId,te.wa),te.snapshot})}(n,p,g,w);let s=yield ZE(n.localStore,e,!0),o=new Wm(e,s.Ts),c=o.ma(s.documents),l=Ia.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=o.applyChanges(c,n.isPrimaryClient,l);rb(n,t,u.wa);let f=new Hm(e,t,o);return n.Fa.set(e,f),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot})}function JM(n,e,t){return y(this,null,function*(){let i=Q(n),r=i.Fa.get(e),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(o=>!Nu(o,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Nm(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&fg(i.remoteStore,r.targetId),Ym(i,r.targetId)}).catch(Pa))):(Ym(i,r.targetId),yield Nm(i.localStore,r.targetId,!0))})}function XM(n,e){return y(this,null,function*(){let t=Q(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),fg(t.remoteStore,i.targetId))})}function ZM(n,e,t){return y(this,null,function*(){let i=oO(n);try{let r=yield function(o,c){let l=Q(o),u=He.now(),f=c.reduce((w,S)=>w.add(S.key),ee()),p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let S=kn(),P=ee();return l.cs.getEntries(w,f).next(D=>{S=D,S.forEach((U,j)=>{j.isValidDocument()||(P=P.add(U))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,S)).next(D=>{p=D;let U=[];for(let j of c){let F=rM(j,p.get(j.key).overlayedDocument);F!=null&&U.push(new xn(j.key,F,gb(F.value.mapValue),Wi.exists(!0)))}return l.mutationQueue.addMutationBatch(w,u,U,c)}).next(D=>{g=D;let U=D.applyToLocalDocumentSet(p,P);return l.documentOverlayCache.saveOverlays(w,D.batchId,U)})}).then(()=>({batchId:g.batchId,changes:Cb(p)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,c,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new Re(ce)),u=u.insert(c,l),o.Ba[o.currentUser.toKey()]=u}(i,r.batchId,t),yield xa(i,r.changes),yield Ou(i.remoteStore)}catch(r){let s=_g(r,"Failed to persist write");t.reject(s)}})}function Jb(n,e){return y(this,null,function*(){let t=Q(n);try{let i=yield SM(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.Na.get(s);o&&(de(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?de(o.va):r.removedDocuments.size>0&&(de(o.va),o.va=!1))}),yield xa(t,i,e)}catch(i){yield Pa(i)}})}function ib(n,e,t){let i=Q(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Fa.forEach((s,o)=>{let c=o.view.Z_(e);c.snapshot&&r.push(c.snapshot)}),function(o,c){let l=Q(o);l.onlineState=c;let u=!1;l.queries.forEach((f,p)=>{for(let g of p.j_)g.Z_(c)&&(u=!0)}),u&&yg(l)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function eO(n,e,t){return y(this,null,function*(){let i=Q(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Na.get(e),s=r&&r.key;if(s){let o=new Re(z.comparator);o=o.insert(s,Yt.newNoDocument(s,Y.min()));let c=ee().add(s),l=new ou(Y.min(),new Map,new Re(ce),o,c);yield Jb(i,l),i.Oa=i.Oa.remove(s),i.Na.delete(e),vg(i)}else yield Nm(i.localStore,e,!1).then(()=>Ym(i,e,t)).catch(Pa)})}function tO(n,e){return y(this,null,function*(){let t=Q(n),i=e.batch.batchId;try{let r=yield AM(t.localStore,e);Zb(t,i,null),Xb(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield xa(t,r)}catch(r){yield Pa(r)}})}function nO(n,e,t){return y(this,null,function*(){let i=Q(n);try{let r=yield function(o,c){let l=Q(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,c).next(p=>(de(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(i.localStore,e);Zb(i,e,t),Xb(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield xa(i,r)}catch(r){yield Pa(r)}})}function Xb(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Zb(n,e,t){let i=Q(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function Ym(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||eT(n,i)})}function eT(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(fg(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),vg(n))}function rb(n,e,t){for(let i of t)i instanceof vu?(n.La.addReference(i.key,e),iO(n,i)):i instanceof Iu?(V("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||eT(n,i.key)):W()}function iO(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(V("SyncEngine","New document in limbo: "+t),n.xa.add(i),vg(n))}function vg(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new z(Fe.fromString(e)),i=n.qa.next();n.Na.set(i,new Km(t)),n.Oa=n.Oa.insert(t,i),qb(n.remoteStore,new wa(un(ug(t.path)),i,"TargetPurposeLimboResolution",db.oe))}}function xa(n,e,t){return y(this,null,function*(){let i=Q(n),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((c,l)=>{o.push(i.Ka(l,e,t).then(u=>{var f;if((u||t)&&i.isPrimaryClient){let p=u?!u.fromCache:(f=t?.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;i.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){r.push(u);let p=Sm.Wi(l.targetId,u);s.push(p)}}))}),yield Promise.all(o),i.Ca.d_(r),yield function(l,u){return y(this,null,function*(){let f=Q(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>k.forEach(u,g=>k.forEach(g.$i,w=>f.persistence.referenceDelegate.addReference(p,g.targetId,w)).next(()=>k.forEach(g.Ui,w=>f.persistence.referenceDelegate.removeReference(p,g.targetId,w)))))}catch(p){if(!Na(p))throw p;V("LocalStore","Failed to update sequence numbers: "+p)}for(let p of u){let g=p.targetId;if(!p.fromCache){let w=f.os.get(g),S=w.snapshotVersion,P=w.withLastLimboFreeSnapshotVersion(S);f.os=f.os.insert(g,P)}}})}(i.localStore,s))})}function rO(n,e){return y(this,null,function*(){let t=Q(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let i=yield $b(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new $(N.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield xa(t,i.hs)}})}function sO(n,e){let t=Q(n),i=t.Na.get(e);if(i&&i.va)return ee().add(i.key);{let r=ee(),s=t.Ma.get(e);if(!s)return r;for(let o of s){let c=t.Fa.get(o);r=r.unionWith(c.view.Va)}return r}}function tT(n){let e=Q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eO.bind(null,e),e.Ca.d_=WM.bind(null,e.eventManager),e.Ca.$a=HM.bind(null,e.eventManager),e}function oO(n){let e=Q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nO.bind(null,e),e}var sb=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=xu(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return CM(this.persistence,new Dm,t.initialUser,this.serializer)}Ga(t){return new Tm(Am.Zr,this.serializer)}Wa(t){return new km}terminate(){return y(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var aO=(()=>{class n{initialize(t,i){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ib(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=rO.bind(null,this.syncEngine),yield zM(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new zm}()}createDatastore(t){let i=xu(t.databaseInfo.databaseId),r=function(o){return new Om(o)}(t.databaseInfo);return function(o,c,l,u){return new Vm(o,c,l,u)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,s,o,c,l){return new jm(r,s,o,c,l)}(this.localStore,this.datastore,t.asyncQueue,i=>ib(this.syncEngine,i,0),function(){return fu.D()?new fu:new xm}())}createSyncEngine(t,i){return function(s,o,c,l,u,f,p){let g=new Qm(s,o,c,l,u,f);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return y(this,null,function*(){var t,i;yield function(s){return y(this,null,function*(){let o=Q(s);V("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield ka(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var Jm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Pn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Xm=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ze.UNAUTHENTICATED,this.clientId=Zl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>y(this,null,function*(){V("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(V("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Dn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=_g(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Rp(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>y(this,null,function*(){i.isEqual(r)||(yield $b(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function ob(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield cO(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>eb(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>eb(e.remoteStore,r)),n._onlineComponents=e})}function cO(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Rp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===N.FAILED_PRECONDITION||r.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;os("Error using user provided cache. Falling back to memory cache: "+t),yield Rp(n,new sb)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield Rp(n,new sb);return n._offlineComponents})}function nT(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield ob(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield ob(n,new aO))),n._onlineComponents})}function lO(n){return nT(n).then(e=>e.syncEngine)}function ab(n){return y(this,null,function*(){let e=yield nT(n),t=e.eventManager;return t.onListen=KM.bind(null,e.syncEngine),t.onUnlisten=JM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XM.bind(null,e.syncEngine),t})}function iT(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var cb=new Map;function uO(n,e,t){if(!t)throw new $(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hO(n,e,t,i){if(e===!0&&i===!0)throw new $(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function lb(n){if(!z.isDocumentKey(n))throw new $(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ig(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new $(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ig(n);throw new $(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var wu=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new $(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iT((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ta=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wu({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wu(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Dp;switch(i.type){case"firstParty":return new xp(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new $(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=cb.get(t);i&&(V("ComponentProvider","Removing Datastore"),cb.delete(t),i.terminate())}(this),Promise.resolve()}};function rT(n,e,t,i={}){var r;let s=(n=rs(n,Ta))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&os("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let c,l;if(typeof i.mockUserToken=="string")c=i.mockUserToken,l=ze.MOCK_USER;else{c=_l(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new $(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ze(u)}n._authCredentials=new Pp(new Xl(c,l))}}var Eu=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Vt=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ca(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ca=class n extends Eu{constructor(e,t,i){super(e,t,ug(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new z(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function sT(n,e,...t){if(n=xe(n),arguments.length===1&&(e=Zl.newId()),uO("doc","path",e),n instanceof Ta){let i=Fe.fromString(e,...t);return lb(i),new Vt(n,null,new z(i))}{if(!(n instanceof Vt||n instanceof Ca))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Fe.fromString(e,...t));return lb(i),new Vt(n.firestore,n instanceof Ca?n.converter:null,new z(i))}}var bu=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new pu(this,"async_queue_retry"),this.Vu=()=>{let i=Sp();i&&V("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=Sp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Sp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Dn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return y(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Na(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let r=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(i);throw Pn("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let r=Bm.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&W()}verifyOperationInProgress(){}wu(){return y(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function ub(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}var vs=class extends Ta{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new bu,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new bu(e),this._firestoreClient=void 0,yield e}})}};function oT(n,e){let t=typeof n=="object"?n:bn(),i=typeof n=="string"?n:e||"(default)",r=En(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=gl("firestore");s&&rT(r,...s)}return r}function aT(n){if(n._terminated)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dO(n),n._firestoreClient}function dO(n){var e,t,i;let r=n._freezeSettings(),s=function(c,l,u,f){return new Vp(c,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,iT(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new Xm(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var Aa=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(it.fromBase64String(e))}catch(t){throw new $(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Is=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Sa=class{constructor(e){this._methodName=e}};var Ra=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}};var Da=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}};var fO=/^__.*__$/;var Tu=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new xn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function cT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var Zm=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Au(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(cT(this.Cu)&&fO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},eg=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||xu(e)}Qu(e,t,i,r=!1){return new Zm({Cu:e,methodName:t,qu:i,path:Tt.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function pO(n){let e=n._freezeSettings(),t=xu(n._databaseId);return new eg(n._databaseId,!!e.ignoreUndefinedProperties,t)}var Cu=class n extends Sa{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function mO(n,e,t,i){let r=n.Qu(1,e,t);uT("Data must be an object, but it was:",r,i);let s=[],o=Lt.empty();Xi(i,(l,u)=>{let f=wg(e,l,t);u=xe(u);let p=r.Nu(f);if(u instanceof Cu)s.push(f);else{let g=Fu(u,p);g!=null&&(s.push(f),o.set(f,g))}});let c=new cn(s);return new Tu(o,c,r.fieldTransforms)}function gO(n,e,t,i,r,s){let o=n.Qu(1,e,t),c=[hb(e,i,t)],l=[r];if(s.length%2!=0)throw new $(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(hb(e,s[g])),l.push(s[g+1]);let u=[],f=Lt.empty();for(let g=c.length-1;g>=0;--g)if(!vO(u,c[g])){let w=c[g],S=l[g];S=xe(S);let P=o.Nu(w);if(S instanceof Cu)u.push(w);else{let D=Fu(S,P);D!=null&&(u.push(w),f.set(w,D))}}let p=new cn(u);return new Tu(f,p,o.fieldTransforms)}function Fu(n,e){if(lT(n=xe(n)))return uT("Unsupported field value:",e,n),_O(n,e);if(n instanceof Sa)return function(i,r){if(!cT(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){let s=[],o=0;for(let c of i){let l=Fu(c,r.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=xe(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Zx(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=He.fromDate(i);return{timestampValue:uu(r.serializer,s)}}if(i instanceof He){let s=new He(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:uu(r.serializer,s)}}if(i instanceof Ra)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Aa)return{bytesValue:Ob(r.serializer,i._byteString)};if(i instanceof Vt){let s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dg(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Da)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw c.Bu("VectorValues must only contain numeric values.");return hg(c.serializer,l)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${Ig(i)}`)}(n,e)}function _O(n,e){let t={};return fb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xi(n,(i,r)=>{let s=Fu(r,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function lT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof Ra||n instanceof Aa||n instanceof Vt||n instanceof Sa||n instanceof Da)}function uT(n,e,t){if(!lT(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=Ig(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function hb(n,e,t){if((e=xe(e))instanceof Is)return e._internalPath;if(typeof e=="string")return wg(n,e);throw Au("Field path arguments must be of type string or ",n,!1,void 0,t)}var yO=new RegExp("[~\\*/\\[\\]]");function wg(n,e,t){if(e.search(yO)>=0)throw Au(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Is(...e.split("."))._internalPath}catch{throw Au(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Au(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new $(N.INVALID_ARGUMENT,c+n+l)}function vO(n,e){return n.some(t=>t.isEqual(e))}var Su=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new tg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(hT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},tg=class extends Su{data(){return super.data()}};function hT(n,e){return typeof e=="string"?wg(n,e):e instanceof Is?e._internalPath:e._delegate._internalPath}function IO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new $(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ng=class{convertValue(e,t="none"){switch(Qi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Xi(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>ve(o.doubleValue));return new Da(s)}convertGeoPoint(e){return new Ra(ve(e.latitude),ve(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=og(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ya(e));default:return null}}convertTimestamp(e){let t=Nn(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Fe.fromString(e);de(Bb(i));let r=new iu(i.get(1),i.get(3)),s=new z(i.popFirst(5));return r.isEqual(t)||Pn(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var Gi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ru=class extends Su{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ss(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(hT("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},ss=class extends Ru{data(e={}){return super.data(e)}},ig=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Gi(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new ss(this._firestore,this._userDataWriter,i.key,i,new Gi(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(c=>{let l=new ss(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Gi(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new ss(r._firestore,r._userDataWriter,c.doc.key,c.doc,new Gi(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),u=-1,f=-1;return c.type!==0&&(u=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:wO(c.type),doc:l,oldIndex:u,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function wO(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}var Du=class extends ng{constructor(e){super(),this.firestore=e}convertBytes(e){return new Aa(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,t)}};function dT(n,e,t,...i){n=rs(n,Vt);let r=rs(n.firestore,vs),s=pO(r),o;return o=typeof(e=xe(e))=="string"||e instanceof Is?gO(s,"updateDoc",n._key,e,t,i):mO(s,"updateDoc",n._key,e),EO(r,[o.toMutation(n._key,Wi.exists(!0))])}function Eg(n,...e){var t,i,r;n=xe(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ub(e[o])||(s=e[o],o++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ub(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(i=p.error)===null||i===void 0?void 0:i.bind(p),e[o+2]=(r=p.complete)===null||r===void 0?void 0:r.bind(p)}let l,u,f;if(n instanceof Vt)u=rs(n.firestore,vs),f=ug(n._key.path),l={next:p=>{e[o]&&e[o](bO(u,n,p))},error:e[o+1],complete:e[o+2]};else{let p=rs(n,Eu);u=rs(p.firestore,vs),f=p._query;let g=new Du(u);l={next:w=>{e[o]&&e[o](new ig(u,g,p,w))},error:e[o+1],complete:e[o+2]},IO(n._query)}return function(g,w,S,P){let D=new Jm(P),U=new Gm(w,D,S);return g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return qM(yield ab(g),U)})),()=>{D.Za(),g.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return GM(yield ab(g),U)}))}}(aT(u),f,c,l)}function EO(n,e){return function(i,r){let s=new Dn;return i.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return ZM(yield lO(i),r,s)})),s.promise}(aT(n),e)}function bO(n,e,t){let i=t.docs.get(e._key),r=new Du(n);return new Ru(n,r,e._key,i,new Gi(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){ws=r})(Et),wt(new et("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),c=new vs(new Np(i.getProvider("auth-internal")),new Op(i.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new $(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new iu(u.options.projectId,f)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),ue(xE,"4.7.3",e),ue(xE,"4.7.3","esm2017")})();var er=class{constructor(e){return e}},fT="firestore",bg=class{constructor(){return Fi(fT)}};var Tg=new H("angularfire2.firestore-instances");function TO(n,e){let t=Qr(fT,n,e);return t&&new er(t)}function CO(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new er(i)}}var AO={provide:bg,deps:[[new De,Tg]]},SO={provide:er,useFactory:TO,deps:[[new De,Tg],Qt]};function pT(n,...e){return ue("angularfire",Ft.full,"fst"),ht([SO,AO,{provide:Tg,useFactory:CO(n),multi:!0,deps:[he,Rt,ii,Tn,[new De,$i],[new De,ni],...e]}])}var Cg=bt(sT,!0);var mT=bt(oT,!0);var gT=bt(dT,!0);var Ag=class{constructor(e,t){this._delegate=e,this.firebase=t,Wr(e,new et("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),ta(this._delegate)))}_getService(e,t=rn){var i;this._delegate.checkDestroyed();let r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=rn){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Wr(this._delegate,e)}_addOrOverwriteComponent(e){Pf(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var RO={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},_T=new kt("app-compat","Firebase",RO);function DO(n){let e={},t={__esModule:!0,initializeApp:s,app:r,registerVersion:ue,setLogLevel:Cl,onLog:Tl,apps:null,SDK_VERSION:Et,INTERNAL:{registerComponent:c,removeApp:i,useAsService:l,modularAPIs:Nf}};t.default=t,Object.defineProperty(t,"apps",{get:o});function i(u){delete e[u]}function r(u){if(u=u||rn,!It(e,u))throw _T.create("no-app",{appName:u});return e[u]}r.App=n;function s(u,f={}){let p=Hr(u,f);if(It(e,p.name))return e[p.name];let g=new n(p,t);return e[p.name]=g,g}function o(){return Object.keys(e).map(u=>e[u])}function c(u){let f=u.name,p=f.replace("-compat","");if(wt(u)&&u.type==="PUBLIC"){let g=(w=r())=>{if(typeof w[p]!="function")throw _T.create("invalid-app-argument",{appName:f});return w[p]()};u.serviceProps!==void 0&&jr(g,u.serviceProps),t[p]=g,n.prototype[p]=function(...w){return this._getService.bind(this,f).apply(this,u.multipleInstances?w:[])}}return u.type==="PUBLIC"?t[p]:null}function l(u,f){return f==="serverAuth"?null:f}return t}function vT(){let n=DO(Ag);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:vT,extendNamespace:e,createSubscribe:vl,ErrorFactory:kt,deepExtend:jr});function e(t){jr(n,t)}return n}var PO=vT();var yT=new xt("@firebase/app-compat"),NO="@firebase/app-compat",kO="0.2.43";function xO(n){ue(NO,kO,n)}try{let n=df();if(n.firebase!==void 0){yT.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&yT.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var Mn=PO;xO();var MO="firebase",OO="10.14.1";Mn.registerVersion(MO,OO,"app-compat");var Lu=class{constructor(e){return e}},IT=new H("angularfire2.app.options"),wT=new H("angularfire2.app.name");function FO(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=Mn.apps.filter(c=>c&&c.name===r.name)[0]||e.runOutsideAngular(()=>Mn.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let c=!!module.hot;LO("error",`${o.name} Firebase App already initialized with different options${c?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Lu(o)}var LO=(n,...e)=>{gv()&&typeof console<"u"&&console[n](...e)},VO={provide:Lu,useFactory:FO,deps:[IT,he,[new De,wT]]},ET=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:IT,useValue:t},{provide:wT,useValue:i}]}}constructor(t){Mn.registerVersion("angularfire",Ft.full,"core"),Mn.registerVersion("angularfire",Ft.full,"app-compat"),Mn.registerVersion("angular",Mc.full,t.toString())}static \u0275fac=function(i){return new(i||n)(B(_t))};static \u0275mod=Ae({type:n});static \u0275inj=Ce({providers:[VO]})}return n})();var z$=typeof module<"u"&&!!module.hot;globalThis.\u0275AngularfireInstanceCache||=[];var Vu=(()=>{class n{constructor(){this.authService=L(Bi),this.user=Ze(void 0),this.errorMessage=Ze(""),Cr(()=>console.log(`new user logged in ${this.user()}`))}login(t,i){try{console.log(`${t} ${i}`),DE(this.authService,t,i).then(r=>{let s={email:r.user.email,id:r.user.uid};console.log(`user: ${s.email} ${s.id}`),this.user.set(s)}).catch(r=>{console.log(r),this.errorMessage.set(r)})}catch{console.log(`error logging in as: ${t}`)}}createNewAccount(t,i){try{console.log(`${t} ${i}`),SE(this.authService,t,i).then(r=>{let s={email:r.user.email,id:r.user.uid};console.log(`user: ${s.email} ${s.id}`),this.user.set(s)}).catch(r=>{console.log(r),this.errorMessage.set(r)})}catch{console.log(`error logging in as: ${t}`)}}logout(){PE(this.authService)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var UO=["*"];var jO=new H("MAT_CARD_CONFIG"),bT=(()=>{class n{constructor(t){this.appearance=t?.appearance||"raised"}static{this.\u0275fac=function(i){return new(i||n)(Ee(jO,8))}}static{this.\u0275cmp=Ue({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,r){i&2&&Qn("mat-mdc-card-outlined",r.appearance==="outlined")("mdc-card--outlined",r.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[je],ngContentSelectors:UO,decls:1,vars:0,template:function(i,r){i&1&&(vr(),vi(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface));border-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-app-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-app-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-app-corner-medium));border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color, var(--mat-app-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-app-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-app-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-app-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-app-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-app-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-app-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-app-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-app-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-app-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-app-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-app-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-app-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}}return n})();var TT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=ut({type:n,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"],standalone:!0})}}return n})();var CT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({imports:[In,Xh,In]})}}return n})();function $O(n,e){if(n&1&&(Pe(0,"mat-card",0)(1,"h2",1),dt(2),Ne(),Pe(3,"mat-card-content",2),dt(4),Ne()()),n&2){let t=Ht();Xe(2),xc(t.task().title),Xe(2),Ii(" ",t.task().description," ")}}var AT=(()=>{class n{constructor(){this.task=lo.required()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["app-task"]],inputs:{task:[1,"task"]},standalone:!0,features:[je],decls:1,vars:1,consts:[["appearance","outlined",1,"item"],[1,"title"],[1,"description"]],template:function(i,r){i&1&&Wh(0,$O,5,2,"mat-card",0),i&2&&Kh(r.task()?0:-1)},dependencies:[CT,bT,TT],styles:[".item[_ngcontent-%COMP%]{background-color:#d2d0dd;padding:20%}"]})}}return n})();function zO(n,e){if(n&1){let t=Pc();Pe(0,"div",1),Wt("mousedown",function(){let r=Hn(t).$implicit,s=Ht();return Kn(s.startDragging(r))}),Yn(1,"app-task",2),Ne(),Yn(2,"div",3)}if(n&2){let t=e.$implicit;yr("id",t.id),Xe(),yr("task",t)}}var ST=(()=>{class n{constructor(){this.tasks=Gh([]),this.title=lo.required(),this.draggedElement=Gh(void 0),this.lane=lo.required()}startDragging(t){this.draggedElement.set(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["app-lane"]],inputs:{tasks:[1,"tasks"],title:[1,"title"],draggedElement:[1,"draggedElement"],lane:[1,"lane"]},outputs:{tasks:"tasksChange",draggedElement:"draggedElementChange"},standalone:!0,features:[je],decls:5,vars:1,consts:[[1,"lane"],[2,"user-select","none",3,"mousedown","id"],[3,"task"],[2,"height","30px"]],template:function(i,r){i&1&&(Pe(0,"div",0)(1,"h2"),dt(2),Ne(),Rc(3,zO,3,2,null,null,Sc),Ne()),i&2&&(Xe(2),xc(r.title()),Xe(),Dc(r.tasks()))},dependencies:[AT],styles:[".lane[_ngcontent-%COMP%]{gap:16px}"]})}}return n})();function qO(n,e){if(n&1){let t=Pc();Pe(0,"div",3),Wt("mouseover",function(){let r=Hn(t).$implicit,s=Ht();return Kn(s.overLane(r))})("mouseleave",function(){Hn(t);let r=Ht();return Kn(r.resetLane())})("mouseup",function(){Hn(t);let r=Ht();return Kn(r.drop())}),Pe(1,"app-lane",4),mo("tasksChange",function(r){let s=Hn(t).$implicit;return wr(s.tasks,r)||(s.tasks=r),Kn(r)})("draggedElementChange",function(r){Hn(t);let s=Ht();return wr(s.draggedElement,r)||(s.draggedElement=r),Kn(r)}),Ne()()}if(n&2){let t=e.$implicit,i=Ht();Xe(),Ir("tasks",t.tasks),yr("title",t.title)("lane",t),Ir("draggedElement",i.draggedElement)}}var RT=(()=>{class n{constructor(){this.firestore=L(er),this.loginService=L(Vu),this.router=L(Vr),this.tasks=Ze([]),this.lanes=Ze([]),this.currentLane=Ze(void 0),this.draggedElement=Ze(void 0),this.lastEditedBy=Ze("")}ngOnInit(){this.loginService.user()==null&&this.router.navigateByUrl("/login"),this.tasks.set([{id:"1",title:"Task 1",description:"Description for Task 1"},{id:"2",title:"Task 2",description:"Description for Task 2"},{id:"3",title:"Task 3",description:"Description for Task 3"},{id:"4",title:"Task 4",description:"Description for Task 4"},{id:"5",title:"Task 5",description:"Description for Task 5"}]),this.lanes.set([{id:0,title:"Lane 1",tasks:[this.tasks()[0],this.tasks()[1]]},{id:1,title:"Lane 2",tasks:[this.tasks()[2],this.tasks()[3]]},{id:2,title:"Lane 3",tasks:[this.tasks()[4]]}]),this.writeDatabase(),this.unsubscribe=Eg(Cg(this.firestore,"kanbanFire/lanes"),t=>{if(t.exists()){let i=t.data();this.lanes.set(i.lanes),this.lastEditedBy.set(i.lastEditedBy)}else console.warn("Document does not exist")})}ngOnDestroy(){this.unsubscribe(),this.loginService.logout()}taskEdited(t){console.log(t)}overLane(t){this.currentLane.set(t)}resetLane(){this.currentLane.set(void 0)}drop(){this.currentLane()!==void 0&&this.draggedElement()!==void 0&&(this.lanes.update(t=>{let i=t.where(r=>r.id===this.currentLane()?.id).first();return t.forEach(r=>{r.tasks=r.tasks.filter(s=>s.id!==this.draggedElement()?.id)}),t[i.id].tasks.push(this.draggedElement()),t}),this.writeDatabase(),this.draggedElement.set(void 0))}writeDatabase(){let t=Cg(this.firestore,"kanbanFire/lanes");return gT(t,{lanes:this.lanes(),lastEditedBy:this.loginService.user()?.email??""})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["app-board"]],standalone:!0,features:[je],decls:7,vars:1,consts:[["color","primary"],[1,"container"],[1,"item"],[1,"item",3,"mouseover","mouseleave","mouseup"],[3,"tasksChange","draggedElementChange","tasks","title","lane","draggedElement"]],template:function(i,r){i&1&&(Pe(0,"mat-toolbar",0)(1,"span"),dt(2,"Kanban Fire"),Ne()(),Pe(3,"div",1),Rc(4,qO,2,4,"div",2,Sc),Ne(),dt(6)),i&2&&(Xe(4),Dc(r.lanes()),Xe(2),Ii(" Last edited by: ",r.lastEditedBy(),`
`))},dependencies:[QI,KI,YI,ST,ET],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;gap:40px;width:100%}.item[_ngcontent-%COMP%]{flex:1;margin:0 5px;background-color:#b7c9e2;border-radius:10px;padding:10px}"]})}}return n})();var FT=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(Ee(Ac),Ee(Dt))}}static{this.\u0275dir=ut({type:n})}}return n})(),GO=(()=>{class n extends FT{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=co(n)))(r||n)}})()}static{this.\u0275dir=ut({type:n,features:[po]})}}return n})(),LT=new H("");var WO={provide:LT,useExisting:$h(()=>zu),multi:!0};function HO(){let n=Ar()?Ar().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var KO=new H(""),zu=(()=>{class n extends FT{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!HO())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(Ee(Ac),Ee(Dt),Ee(KO,8))}}static{this.\u0275dir=ut({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&Wt("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[go([WO]),po]})}}return n})();var QO=new H(""),YO=new H("");function VT(n){return n!=null}function UT(n){return Fc(n)?lt(n):n}function jT(n){let e={};return n.forEach(t=>{e=t!=null?O(O({},e),t):e}),Object.keys(e).length===0?null:e}function BT(n,e){return e.map(t=>t(n))}function JO(n){return!n.validate}function $T(n){return n.map(e=>JO(e)?e:t=>e.validate(t))}function XO(n){if(!n)return null;let e=n.filter(VT);return e.length==0?null:function(t){return jT(BT(t,e))}}function zT(n){return n!=null?XO($T(n)):null}function ZO(n){if(!n)return null;let e=n.filter(VT);return e.length==0?null:function(t){let i=BT(t,e).map(UT);return tv(i).pipe(Z(jT))}}function qT(n){return n!=null?ZO($T(n)):null}function DT(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function eF(n){return n._rawValidators}function tF(n){return n._rawAsyncValidators}function Sg(n){return n?Array.isArray(n)?n:[n]:[]}function ju(n,e){return Array.isArray(n)?n.includes(e):n===e}function PT(n,e){let t=Sg(e);return Sg(n).forEach(r=>{ju(t,r)||t.push(r)}),t}function NT(n,e){return Sg(e).filter(t=>!ju(n,t))}var Bu=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=zT(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=qT(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Rg=class extends Bu{get formDirective(){return null}get path(){return null}},Va=class extends Bu{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Dg=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},nF={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},jz=fe(O({},nF),{"[class.ng-submitted]":"isSubmitted"}),GT=(()=>{class n extends Dg{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(Ee(Va,2))}}static{this.\u0275dir=ut({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Qn("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[po]})}}return n})();var Ma="VALID",Uu="INVALID",bs="PENDING",Oa="DISABLED",Cs=class{},$u=class extends Cs{constructor(e,t){super(),this.value=e,this.source=t}},Fa=class extends Cs{constructor(e,t){super(),this.pristine=e,this.source=t}},La=class extends Cs{constructor(e,t){super(),this.touched=e,this.source=t}},Ts=class extends Cs{constructor(e,t){super(),this.status=e,this.source=t}};function iF(n){return(qu(n)?n.validators:n)||null}function rF(n){return Array.isArray(n)?zT(n):n||null}function sF(n,e){return(qu(e)?e.asyncValidators:n)||null}function oF(n){return Array.isArray(n)?qT(n):n||null}function qu(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var Pg=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Tr(()=>this.statusReactive()),this.statusReactive=Ze(void 0),this._pristine=Tr(()=>this.pristineReactive()),this.pristineReactive=Ze(!0),this._touched=Tr(()=>this.touchedReactive()),this.touchedReactive=Ze(!1),this._events=new zt,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return wi(this.statusReactive)}set status(e){wi(()=>this.statusReactive.set(e))}get valid(){return this.status===Ma}get invalid(){return this.status===Uu}get pending(){return this.status==bs}get disabled(){return this.status===Oa}get enabled(){return this.status!==Oa}get pristine(){return wi(this.pristineReactive)}set pristine(e){wi(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return wi(this.touchedReactive)}set touched(e){wi(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(PT(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(PT(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(NT(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(NT(e,this._rawAsyncValidators))}hasValidator(e){return ju(this._rawValidators,e)}hasAsyncValidator(e){return ju(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(fe(O({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new La(!0,i))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new La(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(fe(O({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Fa(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Fa(!0,i))}markAsPending(e={}){this.status=bs;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ts(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(fe(O({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Oa,this.errors=null,this._forEachChild(r=>{r.disable(fe(O({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new $u(this.value,i)),this._events.next(new Ts(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(fe(O({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ma,this._forEachChild(i=>{i.enable(fe(O({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(fe(O({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ma||this.status===bs)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new $u(this.value,t)),this._events.next(new Ts(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(fe(O({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Oa:Ma}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=bs,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let i=UT(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new Ts(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new Gt,this.statusChanges=new Gt}_calculateStatus(){return this._allControlsDisabled()?Oa:this.errors?Uu:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bs)?bs:this._anyControlsHaveStatus(Uu)?Uu:Ma}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new Fa(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new La(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){qu(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=rF(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=oF(this._rawAsyncValidators)}};var WT=new H("CallSetDisabledState",{providedIn:"root",factory:()=>Ng}),Ng="always";function aF(n,e){return[...e.path,n]}function cF(n,e,t=Ng){uF(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),hF(n,e),fF(n,e),dF(n,e),lF(n,e)}function kT(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function lF(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function uF(n,e){let t=eF(n);e.validator!==null?n.setValidators(DT(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=tF(n);e.asyncValidator!==null?n.setAsyncValidators(DT(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();kT(e._rawValidators,r),kT(e._rawAsyncValidators,r)}function hF(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&HT(n,e)})}function dF(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&HT(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function HT(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function fF(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function pF(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function mF(n){return Object.getPrototypeOf(n.constructor)===GO}function gF(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(s=>{s.constructor===zu?t=s:mF(s)?i=s:r=s}),r||i||t||null}function xT(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function MT(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var _F=class extends Pg{constructor(e=null,t,i){super(iF(t),sF(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),qu(t)&&(t.nonNullable||t.initialValueIsDefault)&&(MT(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){xT(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){xT(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){MT(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var yF={provide:Va,useExisting:$h(()=>kg)},OT=Promise.resolve(),kg=(()=>{class n extends Va{constructor(t,i,r,s,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new _F,this._registered=!1,this.name="",this.update=new Gt,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=gF(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),pF(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){cF(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){OT.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&_o(i);OT.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?aF(t,this._parent):[t]}static{this.\u0275fac=function(i){return new(i||n)(Ee(Rg,9),Ee(QO,10),Ee(YO,10),Ee(LT,10),Ee(br,8),Ee(WT,8))}}static{this.\u0275dir=ut({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[go([yF]),po,ao]})}}return n})();var vF=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({})}}return n})();var KT=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:WT,useValue:t.callSetDisabledState??Ng}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ae({type:n})}static{this.\u0275inj=Ce({imports:[vF]})}}return n})();var QT=(()=>{class n{constructor(){this.loginService=L(Vu),this.router=L(Vr),this.password=Ze(""),this.email=Ze(""),this.errorMessage=Tr(()=>this.loginService.errorMessage()),Cr(()=>this.loginService.user()!==void 0?this.redirect():console.log("not logged in")),Cr(()=>this.errorMessage()?alert(this.errorMessage()):void 0)}ngOnDestroy(){this.loginService.logout()}login(){this.loginService.login(this.email(),this.password())}register(){this.loginService.createNewAccount(this.email(),this.password())}redirect(){this.router.navigateByUrl("/board")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["app-login"]],standalone:!0,features:[je],decls:16,vars:3,consts:[[1,"container"],[1,"row"],["for","email-input"],["id","email-input","type","text",3,"ngModelChange","ngModel"],["for","password-input"],["id","password-input","type","password",3,"ngModelChange","ngModel"],[1,"group"],["type","button",3,"click"],[1,"errorMessage"]],template:function(i,r){i&1&&(Pe(0,"div",0)(1,"div",1)(2,"label",2),dt(3,"Email:"),Ne(),Pe(4,"input",3),mo("ngModelChange",function(o){return wr(r.email,o)||(r.email=o),o}),Ne()(),Pe(5,"div",1)(6,"label",4),dt(7,"Password:"),Ne(),Pe(8,"input",5),mo("ngModelChange",function(o){return wr(r.password,o)||(r.password=o),o}),Ne()(),Pe(9,"div",6)(10,"button",7),Wt("click",function(){return r.login()}),dt(11,"Login"),Ne(),Pe(12,"button",7),Wt("click",function(){return r.register()}),dt(13,"Registrieren"),Ne()()(),Pe(14,"div",8),dt(15),Ne()),i&2&&(Xe(4),Ir("ngModel",r.email),Xe(4),Ir("ngModel",r.password),Xe(7),Ii(" ",r.errorMessage(),`
`))},dependencies:[KT,zu,GT,kg],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:95vh;padding-top:400px;width:300px}.group[_ngcontent-%COMP%]{display:flex;margin-top:50px;gap:5px}button[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{display:flex}.errorMessage[_ngcontent-%COMP%]{color:red}"]})}}return n})();var YT=[{path:"board",component:RT},{path:"login",component:QT},{path:"",redirectTo:"login",pathMatch:"full"}];var xg=new H("basePath");var Mg={apiRoot:"http://localhost:5000",firebaseConfig:{apiKey:"AIzaSyBj7JNt2Mv68ItGqnQXgK5I0RFvcklzteI",authDomain:"fir-demo-9327e.firebaseapp.com",projectId:"fir-demo-9327e",storageBucket:"fir-demo-9327e.firebasestorage.app",messagingSenderId:"560572989170",appId:"1:560572989170:web:476a7e61b14503a1c61a6b",measurementId:"G-MP9JS8CWPG"}};var EF=(()=>{class n extends zc{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||n)(B(Se),B(yo),B($c))}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})();function bF(){return new Tv}function TF(n,e,t){return new Av(n,e,t)}var XT=[{provide:$c,useFactory:bF},{provide:zc,useClass:EF},{provide:_r,useFactory:TF,deps:[Sr,zc,he]}],CF=[{provide:yo,useFactory:()=>new Cv},{provide:gr,useValue:"BrowserAnimations"},...XT],Pq=[{provide:yo,useClass:bv},{provide:gr,useValue:"NoopAnimations"},...XT];function ZT(){return fo("NgEagerAnimations"),[...CF]}var eC="18.5.5",tC="2024-11-16";var AF="@",SF=(()=>{class n{constructor(t,i,r,s,o){this.doc=t,this.delegate=i,this.zone=r,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=L(hv,{optional:!0}),this.loadingSchedulerFn=L(RF,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-YJRHABKX.js").then(r=>r),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(t):i=t(),i.catch(r=>{throw new we(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(t,i){let r=this.delegate.createRenderer(t,i);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let s=new Og(r);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(t,i);s.use(c),this.scheduler?.notify(10)}).catch(o=>{s.use(r)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(i){qh()}}static{this.\u0275prov=q({token:n,factory:n.\u0275fac})}}return n})(),Og=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,i,r){this.delegate.insertBefore(e,t,i,r)}removeChild(e,t,i){this.delegate.removeChild(e,t,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){this.shouldReplay(t)&&this.replay.push(r=>r.setProperty(e,t,i)),this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.shouldReplay(t)&&this.replay.push(r=>r.listen(e,t,i)),this.delegate.listen(e,t,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(AF)}},RF=new H("");function nC(n="animations"){return fo("NgAsyncAnimations"),ht([{provide:_r,useFactory:(e,t,i)=>new SF(e,t,i,n),deps:[Se,Sr,he]},{provide:gr,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var iC="@firebase/database",rC="1.0.8";var x_="";function DF(n){x_=n}var zg=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),$e(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Ur(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var qg=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return It(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var FC=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new zg(e)}}catch{}return new qg},nr=FC("localStorage"),Gg=FC("sessionStorage");var Ds=new xt("@firebase/database"),PF=function(){let n=1;return function(){return n++}}(),LC=function(n){let e=uw(n),t=new fl;t.update(e);let i=t.digest();return pl.encodeByteArray(i)},Ja=function(...n){let e="";for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Ja.apply(null,i):typeof i=="object"?e+=$e(i):e+=i,e+=" "}return e},ir=null,sC=!0,NF=function(n,e){M(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ds.logLevel=X.VERBOSE,ir=Ds.log.bind(Ds),e&&Gg.set("logging_enabled",!0)):typeof n=="function"?ir=n:(ir=null,Gg.remove("logging_enabled"))},rt=function(...n){if(sC===!0&&(sC=!1,ir===null&&Gg.get("logging_enabled")===!0&&NF(!0)),ir){let e=Ja.apply(null,n);ir(e)}},Xa=function(n){return function(...e){rt(n,...e)}},Wg=function(...n){let e="FIREBASE INTERNAL ERROR: "+Ja(...n);Ds.error(e)},Fn=function(...n){let e=`FIREBASE FATAL ERROR: ${Ja(...n)}`;throw Ds.error(e),new Error(e)},Ct=function(...n){let e="FIREBASE WARNING: "+Ja(...n);Ds.warn(e)},kF=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ct("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},VC=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},xF=function(n){if(tn()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ns="[MIN_NAME]",rr="[MAX_NAME]",Vs=function(n,e){if(n===e)return 0;if(n===Ns||e===rr)return-1;if(e===Ns||n===rr)return 1;{let t=oC(n),i=oC(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},MF=function(n,e){return n===e?0:n<e?-1:1},Ua=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+$e(e))},M_=function(n){if(typeof n!="object"||n===null)return $e(n);let e=[];for(let i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=$e(e[i]),t+=":",t+=M_(n[e[i]]);return t+="}",t},UC=function(n,e){let t=n.length;if(t<=e)return[n];let i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function Bt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var jC=function(n){M(!VC(n),"Invalid JSON number");let e=11,t=52,i=(1<<e-1)-1,r,s,o,c,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(c=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=c+i,o=Math.round(n*Math.pow(2,t-c)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));let u=[];for(l=t;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(r?1:0),u.reverse();let f=u.join(""),p="";for(l=0;l<64;l+=8){let g=parseInt(f.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},OF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},FF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var LF=new RegExp("^-?(0*)\\d{1,10}$"),VF=-2147483648,UF=2147483647,oC=function(n){if(LF.test(n)){let e=Number(n);if(e>=VF&&e<=UF)return e}return null},Za=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw Ct("Exception was thrown by user callback.",t),e},Math.floor(0))}},jF=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qa=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Hg=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Ct(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Kg=class{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ct(e)}},Ga=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Wu="5",BC="v",$C="s",zC="r",qC="f",GC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,WC="ls",HC="p",Qg="ac",KC="websocket",QC="long_polling";var Hu=class{constructor(e,t,i,r,s=!1,o="",c=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=nr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&nr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function BF(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function YC(n,e,t){M(typeof e=="string","typeof type must == string"),M(typeof t=="object","typeof params must == object");let i;if(e===KC)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===QC)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);BF(n)&&(t.ns=n.namespace);let r=[];return Bt(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var Yg=class{constructor(){this.counters_={}}incrementCounter(e,t=1){It(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ZI(this.counters_)}};var Fg={},Lg={};function O_(n){let e=n.toString();return Fg[e]||(Fg[e]=new Yg),Fg[e]}function $F(n,e){let t=n.toString();return Lg[t]||(Lg[t]=e()),Lg[t]}var Jg=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Za(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var aC="start",zF="close",qF="pLPCommand",GF="pRTLPCB",JC="id",XC="pw",ZC="ser",WF="cb",HF="seg",KF="ts",QF="d",YF="dframe",eA=1870,tA=30,JF=eA-tA,XF=25e3,ZF=3e4,Xg=class n{constructor(e,t,i,r,s,o,c){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xa(e),this.stats_=O_(t),this.urlFn=l=>(this.appCheckToken&&(l[Qg]=this.appCheckToken),YC(t,QC,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Jg(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(ZF)),xF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Zg((...s)=>{let[o,c,l,u,f]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===aC)this.id=c,this.password=l;else if(o===zF)c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,c]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,c)},()=>{this.onClosed_()},this.urlFn);let i={};i[aC]="t",i[ZC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[WF]=this.scriptTagHolder.uniqueCallbackIdentifier),i[BC]=Wu,this.transportSessionId&&(i[$C]=this.transportSessionId),this.lastSessionId&&(i[WC]=this.lastSessionId),this.applicationId&&(i[HC]=this.applicationId),this.appCheckToken&&(i[Qg]=this.appCheckToken),typeof location<"u"&&location.hostname&&GC.test(location.hostname)&&(i[zC]=qC);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return tn()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!OF()&&!FF()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=$e(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=hf(t),r=UC(i,JF);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(tn())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[YF]="t",i[JC]=e,i[XC]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=$e(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Zg=class n{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,tn())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=PF(),window[qF+this.uniqueCallbackIdentifier]=e,window[GF+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(c){rt("frame writing exception"),c.stack&&rt(c.stack),rt(c)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||rt("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[JC]=this.myID,e[XC]=this.myPW,e[ZC]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tA+i.length<=eA;){let o=this.pendingSegs.shift();i=i+"&"+HF+r+"="+o.seg+"&"+KF+r+"="+o.ts+"&"+QF+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(XF)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){tn()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{rt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var eL=16384,tL=45e3,Ku=null;typeof MozWebSocket<"u"?Ku=MozWebSocket:typeof WebSocket<"u"&&(Ku=WebSocket);var ja=(()=>{class n{constructor(t,i,r,s,o,c,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xa(this.connId),this.stats_=O_(i),this.connURL=n.connectionURL_(i,c,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){let c={};return c[BC]=Wu,!tn()&&typeof location<"u"&&location.hostname&&GC.test(location.hostname)&&(c[zC]=qC),i&&(c[$C]=i),r&&(c[WC]=r),s&&(c[Qg]=s),o&&(c[HC]=o),YC(t,KC,c)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,nr.set("previous_websocket_failure",!0);try{let r;if(tn()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${Wu}/${x_}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,c=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;c&&(r.proxy={origin:c})}this.mySock=new Ku(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&Ku!==null&&!n.forceDisallow_}static previouslyFailed(){return nr.isInMemoryStorage||nr.get("previous_websocket_failure")===!0}markConnectionHealthy(){nr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=Ur(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(M(this.frames===null,"We already have a frame buffer"),t.length<=6){let i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let i=$e(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=UC(i,eL);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(tL))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),nL=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Xg,ja]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let i=ja&&ja.isAvailable(),r=i&&!ja.previouslyFailed();if(t.webSocketOnly&&(i||Ct("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ja];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),iL=6e4,rL=5e3,sL=10*1024,oL=100*1024,Vg="t",cC="d",aL="s",lC="r",cL="e",uC="o",hC="a",dC="n",fC="p",lL="h",e_=class{constructor(e,t,i,r,s,o,c,l,u,f){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=c,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xa("c:"+this.id+":"),this.transportManager_=new nL(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=qa(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>oL?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>sL?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Vg in e){let t=e[Vg];t===hC?this.upgradeIfSecondaryHealthy_():t===lC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===uC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Ua("t",e),i=Ua("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:fC,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:hC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:dC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Ua("t",e),i=Ua("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Ua(Vg,e);if(cC in e){let i=e[cC];if(t===lL){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===dC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===aL?this.onConnectionShutdown_(i):t===lC?this.onReset_(i):t===cL?Wg("Server Error: "+i):t===uC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Wg("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Wu!==i&&Ct("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),qa(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(iL))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qa(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(rL))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:fC,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(nr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Qu=class{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}};var Yu=class{constructor(e){this.allowedEvents_=e,this.listeners_={},M(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){M(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Ju=class n extends Yu{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Qo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return M(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var pC=32,mC=768,ge=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function pe(){return new ge("")}function re(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function fi(n){return n.pieces_.length-n.pieceNum_}function ye(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ge(n.pieces_,e)}function nA(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function uL(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function iA(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function rA(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ge(e,0)}function qe(n,e){let t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof ge)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new ge(t,0)}function ne(n){return n.pieceNum_>=n.pieces_.length}function Ut(n,e){let t=re(n),i=re(e);if(t===null)return e;if(t===i)return Ut(ye(n),ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function sA(n,e){if(fi(n)!==fi(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Xt(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(fi(n)>fi(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}var t_=class{constructor(e,t){this.errorPrefix_=t,this.parts_=iA(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Xo(this.parts_[i]);oA(this)}};function hL(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Xo(e),oA(n)}function dL(n){let e=n.parts_.pop();n.byteLength_-=Xo(e),n.parts_.length>0&&(n.byteLength_-=1)}function oA(n){if(n.byteLength_>mC)throw new Error(n.errorPrefix_+"has a key path longer than "+mC+" bytes ("+n.byteLength_+").");if(n.parts_.length>pC)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+pC+") or object contains a cycle "+tr(n))}function tr(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var n_=class n extends Yu{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new n}getInitialEvent(e){return M(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ba=1e3,fL=60*5*1e3,gC=30*1e3,pL=1.3,mL=3e4,gL="server_kill",_C=3,F_=(()=>{class n extends Qu{constructor(t,i,r,s,o,c,l,u){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Xa("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ba,this.maxReconnectDelay_=fL,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!tn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");n_.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Ju.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){let s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_($e(o)),M(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();let i=new Di,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:c=>{let l=c.d;c.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();let o=t._queryIdentifier,c=t._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),M(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),M(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(c).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){let i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},c="q";t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(c,o,l=>{let u=l.d,f=l.s;n.warnOnListenWarnings_(u,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),f!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(f,u))})}static warnOnListenWarnings_(t,i){if(t&&typeof t=="object"&&It(t,"w")){let r=Ni(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();Ct(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||cw(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=gC)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,i=aw(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,c=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let i=t.s,r=t.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){let r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),M(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);let o={p:t},c="n";s&&(o.q=r,o.t=s),this.sendRequest(c,o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();let c={p:i,d:r};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:t,request:c,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(t){let i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+$e(t));let i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),t==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):t==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):t==="c"?this.onListenRevoked_(i.p,i.q):t==="ac"?this.onAuthRevoked_(i.s,i.d):t==="apc"?this.onAppCheckRevoked_(i.s,i.d):t==="sd"?this.onSecurityDebugPacket_(i):Wg("Unrecognized action received from server: "+$e(t)+`
Are you using the latest client?`)}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){M(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ba,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ba,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>mL&&(this.reconnectDelay_=Ba),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*pL)}this.onConnectStatus_(!1)}establishConnection_(){return y(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,c=!1,l=null,u=function(){l?l.close():(c=!0,r())},f=function(g){M(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(g)};this.realtime_={close:u,sendRequest:f};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,w]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);c?rt("getToken() completed but was canceled"):(rt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=w&&w.token,l=new e_(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,i,r,S=>{Ct(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(gL)},o))}catch(g){this.log_("Failed to get token: "+g),c||(this.repoInfo_.nodeAdmin&&Ct(g),u())}}})}interrupt(t){rt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){rt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Yo(this.interruptReasons_)&&(this.reconnectDelay_=Ba,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let i=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;i?r=i.map(o=>M_(o)).join("$"):r="default";let s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){let r=new ge(t).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){rt("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_C&&(this.reconnectDelay_=gC,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){rt("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_C&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},i="js";tn()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),t["sdk."+i+"."+x_.replace(/\./g,"-")]=1,Qo()?t["framework.cordova"]=1:yl()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Ju.getInstance().currentlyOnline();return Yo(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),se=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var ks=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new se(Ns,e),r=new se(Ns,t);return this.compare(i,r)!==0}minPost(){return se.MIN}};var Gu,Xu=class extends ks{static get __EMPTY_NODE(){return Gu}static set __EMPTY_NODE(e){Gu=e}compare(e,t){return Vs(e.name,t.name)}isDefinedOn(e){throw Pi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return se.MIN}maxPost(){return new se(rr,Gu)}makePost(e,t){return M(typeof e=="string","KeyIndex indexValue must always be a string."),new se(e,Gu)}toString(){return".key"}},Ps=new Xu;var Ss=class{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Jt=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??jt.EMPTY_NODE,this.right=o??jt.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return jt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(t,r.key)===0){if(r.right.isEmpty())return jt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),i_=class{copy(e,t,i,r,s){return this}insert(e,t,i){return new Jt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},jt=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Jt.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Jt.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ss(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ss(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ss(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ss(this.root_,null,this.comparator_,!0,e)}};jt.EMPTY_NODE=new i_;function _L(n,e){return Vs(n.name,e.name)}function L_(n,e){return Vs(n,e)}var r_;function yL(n){r_=n}var aA=function(n){return typeof n=="number"?"number:"+jC(n):"string:"+n},cA=function(n){if(n.isLeafNode()){let e=n.val();M(typeof e=="string"||typeof e=="number"||typeof e=="object"&&It(e,".sv"),"Priority must be a string or number.")}else M(n===r_||n.isEmpty(),"priority of unexpected type.");M(n===r_||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var yC,xs=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,M(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),cA(this.priorityNode_)}static set __childrenNodeConstructor(t){yC=t}static get __childrenNodeConstructor(){return yC}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ne(t)?this:re(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return t===".priority"?this.updatePriority(i):i.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){let r=re(t);return r===null?i:i.isEmpty()&&r!==".priority"?this:(M(r!==".priority"||fi(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(ye(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+aA(this.priorityNode_.val())+":");let i=typeof this.value_;t+=i+":",i==="number"?t+=jC(this.value_):t+=this.value_,this.lazyHash_=LC(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(M(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return M(s>=0,"Unknown leaf type: "+i),M(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),lA,uA;function vL(n){lA=n}function IL(n){uA=n}var s_=class extends ks{compare(e,t){let i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?Vs(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return se.MIN}maxPost(){return new se(rr,new xs("[PRIORITY-POST]",uA))}makePost(e,t){let i=lA(e);return new se(t,new xs("[PRIORITY-POST]",i))}toString(){return".priority"}},ot=new s_;var wL=Math.log(2),o_=class{constructor(e){let t=s=>parseInt(Math.log(s)/wL,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Zu=function(n,e,t,i){n.sort(e);let r=function(l,u){let f=u-l,p,g;if(f===0)return null;if(f===1)return p=n[l],g=t?t(p):p,new Jt(g,p.node,Jt.BLACK,null,null);{let w=parseInt(f/2,10)+l,S=r(l,w),P=r(w+1,u);return p=n[w],g=t?t(p):p,new Jt(g,p.node,Jt.BLACK,S,P)}},s=function(l){let u=null,f=null,p=n.length,g=function(S,P){let D=p-S,U=p;p-=S;let j=r(D+1,U),F=n[D],oe=t?t(F):F;w(new Jt(oe,F.node,P,null,j))},w=function(S){u?(u.left=S,u=S):(f=S,u=S)};for(let S=0;S<l.count;++S){let P=l.nextBitIsOne(),D=Math.pow(2,l.count-(S+1));P?g(D,Jt.BLACK):(g(D,Jt.BLACK),g(D,Jt.RED))}return f},o=new o_(n.length),c=s(o);return new jt(i||e,c)};var Ug,As={},Ms=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return M(As&&ot,"ChildrenNode.ts has not been loaded"),Ug=Ug||new n({".priority":As},{".priority":ot}),Ug}get(e){let t=Ni(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof jt?t:null}hasIndex(e){return It(this.indexSet_,e.toString())}addIndex(e,t){M(e!==Ps,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=t.getIterator(se.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let c;r?c=Zu(i,e.getCompare()):c=As;let l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;let f=Object.assign({},this.indexes_);return f[l]=c,new n(f,u)}addToIndexes(e,t){let i=Jo(this.indexes_,(r,s)=>{let o=Ni(this.indexSet_,s);if(M(o,"Missing index implementation for "+s),r===As)if(o.isDefinedOn(e.node)){let c=[],l=t.getIterator(se.Wrap),u=l.getNext();for(;u;)u.name!==e.name&&c.push(u),u=l.getNext();return c.push(e),Zu(c,o.getCompare())}else return As;else{let c=t.get(e.name),l=r;return c&&(l=l.remove(new se(e.name,c))),l.insert(e,e.node)}});return new n(i,this.indexSet_)}removeFromIndexes(e,t){let i=Jo(this.indexes_,r=>{if(r===As)return r;{let s=t.get(e.name);return s?r.remove(new se(e.name,s)):r}});return new n(i,this.indexSet_)}};var $a,be=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&cA(this.priorityNode_),this.children_.isEmpty()&&M(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $a||($a=new n(new jt(L_),null,Ms.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$a}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let i=this.children_.get(t);return i===null?$a:i}}getChild(t){let i=re(t);return i===null?this:this.getImmediateChild(i).getChild(ye(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,i){if(M(i,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(i);{let r=new se(t,i),s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));let c=s.isEmpty()?$a:this.priorityNode_;return new n(s,c,o)}}updateChild(t,i){let r=re(t);if(r===null)return i;{M(re(t)!==".priority"||fi(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(ye(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(ot,(c,l)=>{i[c]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!t&&o&&s<2*r){let c=[];for(let l in i)c[l]=i[l];return c}else return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+aA(this.getPriority().val())+":"),this.forEachChild(ot,(i,r)=>{let s=r.hash();s!==""&&(t+=":"+i+":"+s)}),this.lazyHash_=t===""?"":LC(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new se(t,i));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let i=this.getFirstChildName(t);return i?new se(i,this.children_.get(i)):null}getLastChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let i=this.getLastChildName(t);return i?new se(i,this.children_.get(i)):null}forEachChild(t,i){let r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,se.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,se.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ec?-1:0}withIndex(t){if(t===Ps||this.indexMap_.hasIndex(t))return this;{let i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===Ps||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let i=t;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(ot),s=i.getIterator(ot),o=r.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=r.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(t){return t===Ps?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),a_=class extends be{constructor(){super(new jt(L_),be.EMPTY_NODE,Ms.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return be.EMPTY_NODE}isEmpty(){return!1}},ec=new a_;Object.defineProperties(se,{MIN:{value:new se(Ns,be.EMPTY_NODE)},MAX:{value:new se(rr,ec)}});Xu.__EMPTY_NODE=be.EMPTY_NODE;xs.__childrenNodeConstructor=be;yL(ec);IL(ec);var EL=!0;function st(n,e=null){if(n===null)return be.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),M(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new xs(t,st(e))}if(!(n instanceof Array)&&EL){let t=[],i=!1;if(Bt(n,(o,c)=>{if(o.substring(0,1)!=="."){let l=st(c);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new se(o,l)))}}),t.length===0)return be.EMPTY_NODE;let s=Zu(t,_L,o=>o.name,L_);if(i){let o=Zu(t,ot.getCompare());return new be(s,st(e),new Ms({".priority":o},{".priority":ot}))}else return new be(s,st(e),Ms.Default)}else{let t=be.EMPTY_NODE;return Bt(n,(i,r)=>{if(It(n,i)&&i.substring(0,1)!=="."){let s=st(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(st(e))}}vL(st);var c_=class extends ks{constructor(e){super(),this.indexPath_=e,M(!ne(e)&&re(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?Vs(e.name,t.name):s}makePost(e,t){let i=st(e),r=be.EMPTY_NODE.updateChild(this.indexPath_,i);return new se(t,r)}maxPost(){let e=be.EMPTY_NODE.updateChild(this.indexPath_,ec);return new se(rr,e)}toString(){return iA(this.indexPath_,0).join("/")}};var l_=class extends ks{compare(e,t){let i=e.node.compareTo(t.node);return i===0?Vs(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return se.MIN}maxPost(){return se.MAX}makePost(e,t){let i=st(e);return new se(t,i)}toString(){return".value"}},bL=new l_;function TL(n){return{type:"value",snapshotNode:n}}function CL(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function AL(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function vC(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function SL(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var u_=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ot}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return M(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return M(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ns}hasEnd(){return this.endSet_}getIndexEndValue(){return M(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return M(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:rr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return M(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ot}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function IC(n){let e={};if(n.isDefault())return e;let t;if(n.index_===ot?t="$priority":n.index_===bL?t="$value":n.index_===Ps?t="$key":(M(n.index_ instanceof c_,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=$e(t),n.startSet_){let i=n.startAfterSet_?"startAfter":"startAt";e[i]=$e(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+$e(n.indexStartName_))}if(n.endSet_){let i=n.endBeforeSet_?"endBefore":"endAt";e[i]=$e(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+$e(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function wC(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==ot&&(e.i=n.index_.toString()),e}var h_=class n extends Qu{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Xa("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(M(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,i),c={};this.listens_[o]=c;let l=IC(e._queryParams);this.restRequest_(s+".json",l,(u,f)=>{let p=f;if(u===404&&(p=null,u=null),u===null&&this.onDataUpdate_(s,p,!1,i),Ni(this.listens_,o)===c){let g;u?u===401?g="permission_denied":g="rest_error:"+u:g="ok",r(g,null)}})}unlisten(e,t){let i=n.getListenId_(e,t);delete this.listens_[i]}get(e){let t=IC(e._queryParams),i=e._path.toString(),r=new Di;return this.restRequest_(i+".json",t,(s,o)=>{let c=o;s===404&&(c=null,s=null),s===null?(this.onDataUpdate_(i,c,!1,null),r.resolve(c)):r.reject(new Error(c))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+xi(t);this.log_("Sending REST request for "+o);let c=new XMLHttpRequest;c.onreadystatechange=()=>{if(i&&c.readyState===4){this.log_("REST Response for "+o+" received. status:",c.status,"response:",c.responseText);let l=null;if(c.status>=200&&c.status<300){try{l=Ur(c.responseText)}catch{Ct("Failed to parse JSON response for "+o+": "+c.responseText)}i(null,l)}else c.status!==401&&c.status!==404&&Ct("Got unsuccessful REST response for "+o+" Status: "+c.status),i(c.status);i=null}},c.open("GET",o,!0),c.send()})}};var d_=class{constructor(){this.rootNode_=be.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function eh(){return{value:null,children:new Map}}function hA(n,e,t){if(ne(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let i=re(e);n.children.has(i)||n.children.set(i,eh());let r=n.children.get(i);e=ye(e),hA(r,e,t)}}function f_(n,e,t){n.value!==null?t(e,n.value):RL(n,(i,r)=>{let s=new ge(e.toString()+"/"+i);f_(r,s,t)})}function RL(n,e){n.children.forEach((t,i)=>{e(i,t)})}var p_=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Bt(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}};var EC=10*1e3,DL=30*1e3,PL=5*60*1e3,m_=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new p_(e);let i=EC+(DL-EC)*Math.random();qa(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;Bt(e,(r,s)=>{s>0&&It(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),qa(this.reportStats_.bind(this),Math.floor(Math.random()*2*PL))}};var On=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(On||{});function dA(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function fA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function pA(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var g_=class n{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=On.ACK_USER_WRITE,this.source=dA()}operationForChild(e){if(ne(this.path)){if(this.affectedTree.value!=null)return M(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new ge(e));return new n(pe(),t,this.revert)}}else return M(re(this.path)===e,"operationForChild called for unrelated child."),new n(ye(this.path),this.affectedTree,this.revert)}};var Os=class n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=On.OVERWRITE}operationForChild(e){return ne(this.path)?new n(this.source,pe(),this.snap.getImmediateChild(e)):new n(this.source,ye(this.path),this.snap)}};var th=class n{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=On.MERGE}operationForChild(e){if(ne(this.path)){let t=this.children.subtree(new ge(e));return t.isEmpty()?null:t.value?new Os(this.source,pe(),t.value):new n(this.source,pe(),t)}else return M(re(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Ka=class{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ne(e))return this.isFullyInitialized()&&!this.filtered_;let t=re(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function NL(n,e,t,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(SL(o.childName,o.snapshotNode))}),za(n,r,"child_removed",e,i,t),za(n,r,"child_added",e,i,t),za(n,r,"child_moved",s,i,t),za(n,r,"child_changed",e,i,t),za(n,r,"value",e,i,t),r}function za(n,e,t,i,r,s){let o=i.filter(c=>c.type===t);o.sort((c,l)=>xL(n,c,l)),o.forEach(c=>{let l=kL(n,c,s);r.forEach(u=>{u.respondsTo(c.type)&&e.push(u.createEvent(l,n.query_))})})}function kL(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function xL(n,e,t){if(e.childName==null||t.childName==null)throw Pi("Should only compare child_ events.");let i=new se(e.childName,e.snapshotNode),r=new se(t.childName,t.snapshotNode);return n.index_.compare(i,r)}function mA(n,e){return{eventCache:n,serverCache:e}}function Wa(n,e,t,i){return mA(new Ka(e,t,i),n.serverCache)}function gA(n,e,t,i){return mA(n.eventCache,new Ka(e,t,i))}function __(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function sr(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var jg,ML=()=>(jg||(jg=new jt(MF)),jg),pt=class n{constructor(e,t=ML()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Bt(e,(i,r)=>{t=t.set(new ge(i),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:pe(),value:this.value};if(ne(e))return null;{let i=re(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(ye(e),t);return s!=null?{path:qe(new ge(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ne(e))return this;{let t=re(e),i=this.children.get(t);return i!==null?i.subtree(ye(e)):new n(null)}}set(e,t){if(ne(e))return new n(t,this.children);{let i=re(e),s=(this.children.get(i)||new n(null)).set(ye(e),t),o=this.children.insert(i,s);return new n(this.value,o)}}remove(e){if(ne(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=re(e),i=this.children.get(t);if(i){let r=i.remove(ye(e)),s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(ne(e))return this.value;{let t=re(e),i=this.children.get(t);return i?i.get(ye(e)):null}}setTree(e,t){if(ne(e))return t;{let i=re(e),s=(this.children.get(i)||new n(null)).setTree(ye(e),t),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new n(this.value,o)}}fold(e){return this.fold_(pe(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(qe(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,pe(),t)}findOnPath_(e,t,i){let r=this.value?i(t,this.value):!1;if(r)return r;if(ne(e))return null;{let s=re(e),o=this.children.get(s);return o?o.findOnPath_(ye(e),qe(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,pe(),t)}foreachOnPath_(e,t,i){if(ne(e))return this;{this.value&&i(t,this.value);let r=re(e),s=this.children.get(r);return s?s.foreachOnPath_(ye(e),qe(t,r),i):new n(null)}}foreach(e){this.foreach_(pe(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(qe(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}};var Zt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new pt(null))}};function Ha(n,e,t){if(ne(e))return new Zt(new pt(t));{let i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=Ut(r,e);return s=s.updateChild(o,t),new Zt(n.writeTree_.set(r,s))}else{let r=new pt(t),s=n.writeTree_.setTree(e,r);return new Zt(s)}}}function bC(n,e,t){let i=n;return Bt(t,(r,s)=>{i=Ha(i,qe(e,r),s)}),i}function TC(n,e){if(ne(e))return Zt.empty();{let t=n.writeTree_.setTree(e,new pt(null));return new Zt(t)}}function y_(n,e){return or(n,e)!=null}function or(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Ut(t.path,e)):null}function CC(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(ot,(i,r)=>{e.push(new se(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new se(i,r.value))}),e}function di(n,e){if(ne(e))return n;{let t=or(n,e);return t!=null?new Zt(new pt(t)):new Zt(n.writeTree_.subtree(e))}}function v_(n){return n.writeTree_.isEmpty()}function Fs(n,e){return _A(pe(),n.writeTree_,e)}function _A(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(M(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=_A(qe(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(qe(n,".priority"),i)),t}}function yA(n,e){return bA(e,n)}function OL(n,e,t,i,r){M(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Ha(n.visibleWrites,e,t)),n.lastWriteId=i}function FL(n,e){for(let t=0;t<n.allWrites.length;t++){let i=n.allWrites[t];if(i.writeId===e)return i}return null}function LL(n,e){let t=n.allWrites.findIndex(c=>c.writeId===e);M(t>=0,"removeWrite called with nonexistent writeId.");let i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){let c=n.allWrites[o];c.visible&&(o>=t&&VL(c,i.path)?r=!1:Xt(i.path,c.path)&&(s=!0)),o--}if(r){if(s)return UL(n),!0;if(i.snap)n.visibleWrites=TC(n.visibleWrites,i.path);else{let c=i.children;Bt(c,l=>{n.visibleWrites=TC(n.visibleWrites,qe(i.path,l))})}return!0}else return!1}function VL(n,e){if(n.snap)return Xt(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Xt(qe(n.path,t),e))return!0;return!1}function UL(n){n.visibleWrites=vA(n.allWrites,jL,pe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function jL(n){return n.visible}function vA(n,e,t){let i=Zt.empty();for(let r=0;r<n.length;++r){let s=n[r];if(e(s)){let o=s.path,c;if(s.snap)Xt(t,o)?(c=Ut(t,o),i=Ha(i,c,s.snap)):Xt(o,t)&&(c=Ut(o,t),i=Ha(i,pe(),s.snap.getChild(c)));else if(s.children){if(Xt(t,o))c=Ut(t,o),i=bC(i,c,s.children);else if(Xt(o,t))if(c=Ut(o,t),ne(c))i=bC(i,pe(),s.children);else{let l=Ni(s.children,re(c));if(l){let u=l.getChild(ye(c));i=Ha(i,pe(),u)}}}else throw Pi("WriteRecord should have .snap or .children")}}return i}function IA(n,e,t,i,r){if(!i&&!r){let s=or(n.visibleWrites,e);if(s!=null)return s;{let o=di(n.visibleWrites,e);if(v_(o))return t;if(t==null&&!y_(o,pe()))return null;{let c=t||be.EMPTY_NODE;return Fs(o,c)}}}else{let s=di(n.visibleWrites,e);if(!r&&v_(s))return t;if(!r&&t==null&&!y_(s,pe()))return null;{let o=function(u){return(u.visible||r)&&(!i||!~i.indexOf(u.writeId))&&(Xt(u.path,e)||Xt(e,u.path))},c=vA(n.allWrites,o,e),l=t||be.EMPTY_NODE;return Fs(c,l)}}}function BL(n,e,t){let i=be.EMPTY_NODE,r=or(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(ot,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){let s=di(n.visibleWrites,e);return t.forEachChild(ot,(o,c)=>{let l=Fs(di(s,new ge(o)),c);i=i.updateImmediateChild(o,l)}),CC(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=di(n.visibleWrites,e);return CC(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function $L(n,e,t,i,r){M(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=qe(e,t);if(y_(n.visibleWrites,s))return null;{let o=di(n.visibleWrites,s);return v_(o)?r.getChild(t):Fs(o,r.getChild(t))}}function zL(n,e,t,i){let r=qe(e,t),s=or(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){let o=di(n.visibleWrites,r);return Fs(o,i.getNode().getImmediateChild(t))}else return null}function qL(n,e){return or(n.visibleWrites,e)}function GL(n,e,t,i,r,s,o){let c,l=di(n.visibleWrites,e),u=or(l,pe());if(u!=null)c=u;else if(t!=null)c=Fs(l,t);else return[];if(c=c.withIndex(o),!c.isEmpty()&&!c.isLeafNode()){let f=[],p=o.getCompare(),g=s?c.getReverseIteratorFrom(i,o):c.getIteratorFrom(i,o),w=g.getNext();for(;w&&f.length<r;)p(w,i)!==0&&f.push(w),w=g.getNext();return f}else return[]}function WL(){return{visibleWrites:Zt.empty(),allWrites:[],lastWriteId:-1}}function I_(n,e,t,i){return IA(n.writeTree,n.treePath,e,t,i)}function wA(n,e){return BL(n.writeTree,n.treePath,e)}function AC(n,e,t,i){return $L(n.writeTree,n.treePath,e,t,i)}function nh(n,e){return qL(n.writeTree,qe(n.treePath,e))}function HL(n,e,t,i,r,s){return GL(n.writeTree,n.treePath,e,t,i,r,s)}function V_(n,e,t){return zL(n.writeTree,n.treePath,e,t)}function EA(n,e){return bA(qe(n.treePath,e),n.writeTree)}function bA(n,e){return{treePath:n,writeTree:e}}var w_=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;M(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),M(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,vC(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,AL(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,CL(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,vC(i,e.snapshotNode,r.oldSnap));else throw Pi("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var E_=class{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}},TA=new E_,Qa=class{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new Ka(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return V_(this.writes_,e,i)}}getChildAfterChild(e,t,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:sr(this.viewCache_),s=HL(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}};function KL(n,e){M(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),M(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function QL(n,e,t,i,r){let s=new w_,o,c;if(t.type===On.OVERWRITE){let u=t;u.source.fromUser?o=b_(n,e,u.path,u.snap,i,r,s):(M(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered()&&!ne(u.path),o=ih(n,e,u.path,u.snap,i,r,c,s))}else if(t.type===On.MERGE){let u=t;u.source.fromUser?o=JL(n,e,u.path,u.children,i,r,s):(M(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered(),o=T_(n,e,u.path,u.children,i,r,c,s))}else if(t.type===On.ACK_USER_WRITE){let u=t;u.revert?o=e1(n,e,u.path,i,r,s):o=XL(n,e,u.path,u.affectedTree,i,r,s)}else if(t.type===On.LISTEN_COMPLETE)o=ZL(n,e,t.path,i,s);else throw Pi("Unknown operation type: "+t.type);let l=s.getChanges();return YL(e,o,l),{viewCache:o,changes:l}}function YL(n,e,t){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=__(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(TL(__(e)))}}function CA(n,e,t,i,r,s){let o=e.eventCache;if(nh(i,t)!=null)return e;{let c,l;if(ne(t))if(M(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=sr(e),f=u instanceof be?u:be.EMPTY_NODE,p=wA(i,f);c=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let u=I_(i,sr(e));c=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=re(t);if(u===".priority"){M(fi(t)===1,"Can't have a priority with additional path components");let f=o.getNode();l=e.serverCache.getNode();let p=AC(i,t,f,l);p!=null?c=n.filter.updatePriority(f,p):c=o.getNode()}else{let f=ye(t),p;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();let g=AC(i,t,o.getNode(),l);g!=null?p=o.getNode().getImmediateChild(u).updateChild(f,g):p=o.getNode().getImmediateChild(u)}else p=V_(i,u,e.serverCache);p!=null?c=n.filter.updateChild(o.getNode(),u,p,f,r,s):c=o.getNode()}}return Wa(e,c,o.isFullyInitialized()||ne(t),n.filter.filtersNodes())}}function ih(n,e,t,i,r,s,o,c){let l=e.serverCache,u,f=o?n.filter:n.filter.getIndexedFilter();if(ne(t))u=f.updateFullNode(l.getNode(),i,null);else if(f.filtersNodes()&&!l.isFiltered()){let w=l.getNode().updateChild(t,i);u=f.updateFullNode(l.getNode(),w,null)}else{let w=re(t);if(!l.isCompleteForPath(t)&&fi(t)>1)return e;let S=ye(t),D=l.getNode().getImmediateChild(w).updateChild(S,i);w===".priority"?u=f.updatePriority(l.getNode(),D):u=f.updateChild(l.getNode(),w,D,S,TA,null)}let p=gA(e,u,l.isFullyInitialized()||ne(t),f.filtersNodes()),g=new Qa(r,p,s);return CA(n,p,t,r,g,c)}function b_(n,e,t,i,r,s,o){let c=e.eventCache,l,u,f=new Qa(r,e,s);if(ne(t))u=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Wa(e,u,!0,n.filter.filtersNodes());else{let p=re(t);if(p===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),i),l=Wa(e,u,c.isFullyInitialized(),c.isFiltered());else{let g=ye(t),w=c.getNode().getImmediateChild(p),S;if(ne(g))S=i;else{let P=f.getCompleteChild(p);P!=null?nA(g)===".priority"&&P.getChild(rA(g)).isEmpty()?S=P:S=P.updateChild(g,i):S=be.EMPTY_NODE}if(w.equals(S))l=e;else{let P=n.filter.updateChild(c.getNode(),p,S,g,f,o);l=Wa(e,P,c.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function SC(n,e){return n.eventCache.isCompleteForChild(e)}function JL(n,e,t,i,r,s,o){let c=e;return i.foreach((l,u)=>{let f=qe(t,l);SC(e,re(f))&&(c=b_(n,c,f,u,r,s,o))}),i.foreach((l,u)=>{let f=qe(t,l);SC(e,re(f))||(c=b_(n,c,f,u,r,s,o))}),c}function RC(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function T_(n,e,t,i,r,s,o,c){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;ne(t)?u=i:u=new pt(null).setTree(t,i);let f=e.serverCache.getNode();return u.children.inorderTraversal((p,g)=>{if(f.hasChild(p)){let w=e.serverCache.getNode().getImmediateChild(p),S=RC(n,w,g);l=ih(n,l,new ge(p),S,r,s,o,c)}}),u.children.inorderTraversal((p,g)=>{let w=!e.serverCache.isCompleteForChild(p)&&g.value===null;if(!f.hasChild(p)&&!w){let S=e.serverCache.getNode().getImmediateChild(p),P=RC(n,S,g);l=ih(n,l,new ge(p),P,r,s,o,c)}}),l}function XL(n,e,t,i,r,s,o){if(nh(r,t)!=null)return e;let c=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(ne(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return ih(n,e,t,l.getNode().getChild(t),r,s,c,o);if(ne(t)){let u=new pt(null);return l.getNode().forEachChild(Ps,(f,p)=>{u=u.set(new ge(f),p)}),T_(n,e,t,u,r,s,c,o)}else return e}else{let u=new pt(null);return i.foreach((f,p)=>{let g=qe(t,f);l.isCompleteForPath(g)&&(u=u.set(f,l.getNode().getChild(g)))}),T_(n,e,t,u,r,s,c,o)}}function ZL(n,e,t,i,r){let s=e.serverCache,o=gA(e,s.getNode(),s.isFullyInitialized()||ne(t),s.isFiltered());return CA(n,o,t,i,TA,r)}function e1(n,e,t,i,r,s){let o;if(nh(i,t)!=null)return e;{let c=new Qa(i,e,r),l=e.eventCache.getNode(),u;if(ne(t)||re(t)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=I_(i,sr(e));else{let p=e.serverCache.getNode();M(p instanceof be,"serverChildren would be complete if leaf node"),f=wA(i,p)}f=f,u=n.filter.updateFullNode(l,f,s)}else{let f=re(t),p=V_(i,f,e.serverCache);p==null&&e.serverCache.isCompleteForChild(f)&&(p=l.getImmediateChild(f)),p!=null?u=n.filter.updateChild(l,f,p,ye(t),c,s):e.eventCache.getNode().hasChild(f)?u=n.filter.updateChild(l,f,be.EMPTY_NODE,ye(t),c,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=I_(i,sr(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||nh(i,pe())!=null,Wa(e,u,o,n.filter.filtersNodes())}}function t1(n,e){let t=sr(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ne(e)&&!t.getImmediateChild(re(e)).isEmpty())?t.getChild(e):null}function DC(n,e,t,i){e.type===On.MERGE&&e.source.queryId!==null&&(M(sr(n.viewCache_),"We should always have a full cache before handling merges"),M(__(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,s=QL(n.processor_,r,e,t,i);return KL(n.processor_,s.viewCache),M(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,n1(n,s.changes,s.viewCache.eventCache.getNode(),null)}function n1(n,e,t,i){let r=i?[i]:n.eventRegistrations_;return NL(n.eventGenerator_,e,t,r)}var PC;function i1(n){M(!PC,"__referenceConstructor has already been defined"),PC=n}function U_(n,e,t,i){let r=e.source.queryId;if(r!==null){let s=n.views.get(r);return M(s!=null,"SyncTree gave us an op for an invalid query."),DC(s,e,t,i)}else{let s=[];for(let o of n.views.values())s=s.concat(DC(o,e,t,i));return s}}function j_(n,e){let t=null;for(let i of n.views.values())t=t||t1(i,e);return t}var NC;function r1(n){M(!NC,"__referenceConstructor has already been defined"),NC=n}var rh=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pt(null),this.pendingWriteTree_=WL(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function s1(n,e,t,i,r){return OL(n.pendingWriteTree_,e,t,i,r),r?oh(n,new Os(dA(),e,t)):[]}function Rs(n,e,t=!1){let i=FL(n.pendingWriteTree_,e);if(LL(n.pendingWriteTree_,e)){let s=new pt(null);return i.snap!=null?s=s.set(pe(),!0):Bt(i.children,o=>{s=s.set(new ge(o),!0)}),oh(n,new g_(i.path,s,t))}else return[]}function sh(n,e,t){return oh(n,new Os(fA(),e,t))}function o1(n,e,t){let i=pt.fromObject(t);return oh(n,new th(fA(),e,i))}function a1(n,e,t,i){let r=DA(n,i);if(r!=null){let s=PA(r),o=s.path,c=s.queryId,l=Ut(o,e),u=new Os(pA(c),l,t);return NA(n,o,u)}else return[]}function c1(n,e,t,i){let r=DA(n,i);if(r){let s=PA(r),o=s.path,c=s.queryId,l=Ut(o,e),u=pt.fromObject(t),f=new th(pA(c),l,u);return NA(n,o,f)}else return[]}function AA(n,e,t){let r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,c)=>{let l=Ut(o,e),u=j_(c,l);if(u)return u});return IA(r,e,s,t,!0)}function oh(n,e){return SA(e,n.syncPointTree_,null,yA(n.pendingWriteTree_,pe()))}function SA(n,e,t,i){if(ne(n.path))return RA(n,e,t,i);{let r=e.get(pe());t==null&&r!=null&&(t=j_(r,pe()));let s=[],o=re(n.path),c=n.operationForChild(o),l=e.children.get(o);if(l&&c){let u=t?t.getImmediateChild(o):null,f=EA(i,o);s=s.concat(SA(c,l,u,f))}return r&&(s=s.concat(U_(r,n,i,t))),s}}function RA(n,e,t,i){let r=e.get(pe());t==null&&r!=null&&(t=j_(r,pe()));let s=[];return e.children.inorderTraversal((o,c)=>{let l=t?t.getImmediateChild(o):null,u=EA(i,o),f=n.operationForChild(o);f&&(s=s.concat(RA(f,c,l,u)))}),r&&(s=s.concat(U_(r,n,i,t))),s}function DA(n,e){return n.tagToQueryMap.get(e)}function PA(n){let e=n.indexOf("$");return M(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ge(n.substr(0,e))}}function NA(n,e,t){let i=n.syncPointTree_.get(e);M(i,"Missing sync point for query tag that we're tracking");let r=yA(n.pendingWriteTree_,e);return U_(i,t,r,null)}var C_=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},A_=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=qe(this.path_,e);return new n(this.syncTree_,t)}node(){return AA(this.syncTree_,this.path_)}},l1=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},kC=function(n,e,t){if(!n||typeof n!="object")return n;if(M(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return u1(n[".sv"],e,t);if(typeof n[".sv"]=="object")return h1(n[".sv"],e);M(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},u1=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:M(!1,"Unexpected server value: "+n)}},h1=function(n,e,t){n.hasOwnProperty("increment")||M(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let i=n.increment;typeof i!="number"&&M(!1,"Unexpected increment value: "+i);let r=e.node();if(M(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},d1=function(n,e,t,i){return B_(e,new A_(t,n),i)},f1=function(n,e,t){return B_(n,new C_(e),t)};function B_(n,e,t){let i=n.getPriority().val(),r=kC(i,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,c=kC(o.getValue(),e,t);return c!==o.getValue()||r!==o.getPriority().val()?new xs(c,st(r)):n}else{let o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new xs(r))),o.forEachChild(ot,(c,l)=>{let u=B_(l,e.getImmediateChild(c),t);u!==l&&(s=s.updateImmediateChild(c,u))}),s}}var Ya=class{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}};function $_(n,e){let t=e instanceof ge?e:new ge(e),i=n,r=re(t);for(;r!==null;){let s=Ni(i.node.children,r)||{children:{},childCount:0};i=new Ya(r,i,s),t=ye(t),r=re(t)}return i}function Us(n){return n.node.value}function kA(n,e){n.node.value=e,S_(n)}function xA(n){return n.node.childCount>0}function p1(n){return Us(n)===void 0&&!xA(n)}function ah(n,e){Bt(n.node.children,(t,i)=>{e(new Ya(t,n,i))})}function MA(n,e,t,i){t&&!i&&e(n),ah(n,r=>{MA(r,e,!0,i)}),t&&i&&e(n)}function m1(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function tc(n){return new ge(n.parent===null?n.name:tc(n.parent)+"/"+n.name)}function S_(n){n.parent!==null&&g1(n.parent,n.name,n)}function g1(n,e,t){let i=p1(t),r=It(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,S_(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,S_(n))}var _1=/[\[\].#$\/\u0000-\u001F\u007F]/,y1=/[\[\].#$\u0000-\u001F\u007F]/,Bg=10*1024*1024,OA=function(n){return typeof n=="string"&&n.length!==0&&!_1.test(n)},v1=function(n){return typeof n=="string"&&n.length!==0&&!y1.test(n)},I1=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),v1(n)};var FA=function(n,e,t){let i=t instanceof ge?new t_(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+tr(i));if(typeof e=="function")throw new Error(n+"contains a function "+tr(i)+" with contents = "+e.toString());if(VC(e))throw new Error(n+"contains "+e.toString()+" "+tr(i));if(typeof e=="string"&&e.length>Bg/3&&Xo(e)>Bg)throw new Error(n+"contains a string greater than "+Bg+" utf8 bytes "+tr(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Bt(e,(o,c)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!OA(o)))throw new Error(n+" contains an invalid key ("+o+") "+tr(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);hL(i,o),FA(n,c,i),dL(i)}),r&&s)throw new Error(n+' contains ".value" child '+tr(i)+" in addition to actual children.")}};var w1=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!OA(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!I1(t))throw new Error(lw(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var R_=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function E1(n,e){let t=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();t!==null&&!sA(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function ar(n,e,t){E1(n,t),b1(n,i=>Xt(i,e)||Xt(e,i))}function b1(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){let r=n.eventLists_[i];if(r){let s=r.path;e(s)?(T1(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function T1(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let i=t.getEventRunner();ir&&rt("event: "+t.toString()),Za(i)}}}var C1="repo_interrupt",A1=25,D_=class{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new R_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=eh(),this.transactionQueueTree_=new Ya,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function S1(n,e,t){if(n.stats_=O_(n.repoInfo_),n.forceRestClient_||jF())n.server_=new h_(n.repoInfo_,(i,r,s,o)=>{xC(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>MC(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{$e(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new F_(n.repoInfo_,e,(i,r,s,o)=>{xC(n,i,r,s,o)},i=>{MC(n,i)},i=>{D1(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=$F(n.repoInfo_,()=>new m_(n.stats_,n.server_)),n.infoData_=new d_,n.infoSyncTree_=new rh({startListening:(i,r,s,o)=>{let c=[],l=n.infoData_.getNode(i._path);return l.isEmpty()||(c=sh(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),c},stopListening:()=>{}}),z_(n,"connected",!1),n.serverSyncTree_=new rh({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(c,l)=>{let u=o(c,l);ar(n.eventQueue_,i._path,u)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function R1(n){let t=n.infoData_.getNode(new ge(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function LA(n){return l1({timestamp:R1(n)})}function xC(n,e,t,i,r){n.dataUpdateCount++;let s=new ge(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){let l=Jo(t,u=>st(u));o=c1(n.serverSyncTree_,s,l,r)}else{let l=st(t);o=a1(n.serverSyncTree_,s,l,r)}else if(i){let l=Jo(t,u=>st(u));o=o1(n.serverSyncTree_,s,l)}else{let l=st(t);o=sh(n.serverSyncTree_,s,l)}let c=s;o.length>0&&(c=G_(n,s)),ar(n.eventQueue_,c,o)}function MC(n,e){z_(n,"connected",e),e===!1&&N1(n)}function D1(n,e){Bt(e,(t,i)=>{z_(n,t,i)})}function z_(n,e,t){let i=new ge("/.info/"+e),r=st(t);n.infoData_.updateSnapshot(i,r);let s=sh(n.infoSyncTree_,i,r);ar(n.eventQueue_,i,s)}function P1(n){return n.nextWriteId_++}function N1(n){VA(n,"onDisconnectEvents");let e=LA(n),t=eh();f_(n.onDisconnect_,pe(),(r,s)=>{let o=d1(r,s,n.serverSyncTree_,e);hA(t,r,o)});let i=[];f_(t,pe(),(r,s)=>{i=i.concat(sh(n.serverSyncTree_,r,s));let o=O1(n,r);G_(n,o)}),n.onDisconnect_=eh(),ar(n.eventQueue_,pe(),i)}function k1(n){n.persistentConnection_&&n.persistentConnection_.interrupt(C1)}function VA(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),rt(t,...e)}function UA(n,e,t){return AA(n.serverSyncTree_,e,t)||be.EMPTY_NODE}function q_(n,e=n.transactionQueueTree_){if(e||ch(n,e),Us(e)){let t=BA(n,e);M(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&x1(n,tc(e),t)}else xA(e)&&ah(e,t=>{q_(n,t)})}function x1(n,e,t){let i=t.map(u=>u.currentWriteId),r=UA(n,e,i),s=r,o=r.hash();for(let u=0;u<t.length;u++){let f=t[u];M(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;let p=Ut(e,f.path);s=s.updateChild(p,f.currentOutputSnapshotRaw)}let c=s.val(!0),l=e;n.server_.put(l.toString(),c,u=>{VA(n,"transaction put response",{path:l.toString(),status:u});let f=[];if(u==="ok"){let p=[];for(let g=0;g<t.length;g++)t[g].status=2,f=f.concat(Rs(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&p.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();ch(n,$_(n.transactionQueueTree_,e)),q_(n,n.transactionQueueTree_),ar(n.eventQueue_,e,f);for(let g=0;g<p.length;g++)Za(p[g])}else{if(u==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{Ct("transaction at "+l.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}G_(n,e)}},o)}function G_(n,e){let t=jA(n,e),i=tc(t),r=BA(n,t);return M1(n,r,i),i}function M1(n,e,t){if(e.length===0)return;let i=[],r=[],o=e.filter(c=>c.status===0).map(c=>c.currentWriteId);for(let c=0;c<e.length;c++){let l=e[c],u=Ut(t,l.path),f=!1,p;if(M(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,p=l.abortReason,r=r.concat(Rs(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=A1)f=!0,p="maxretry",r=r.concat(Rs(n.serverSyncTree_,l.currentWriteId,!0));else{let g=UA(n,l.path,o);l.currentInputSnapshot=g;let w=e[c].update(g.val());if(w!==void 0){FA("transaction failed: Data returned ",w,l.path);let S=st(w);typeof w=="object"&&w!=null&&It(w,".priority")||(S=S.updatePriority(g.getPriority()));let D=l.currentWriteId,U=LA(n),j=f1(S,g,U);l.currentOutputSnapshotRaw=S,l.currentOutputSnapshotResolved=j,l.currentWriteId=P1(n),o.splice(o.indexOf(D),1),r=r.concat(s1(n.serverSyncTree_,l.path,j,l.currentWriteId,l.applyLocally)),r=r.concat(Rs(n.serverSyncTree_,D,!0))}else f=!0,p="nodata",r=r.concat(Rs(n.serverSyncTree_,l.currentWriteId,!0))}ar(n.eventQueue_,t,r),r=[],f&&(e[c].status=2,function(g){setTimeout(g,Math.floor(0))}(e[c].unwatcher),e[c].onComplete&&(p==="nodata"?i.push(()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot)):i.push(()=>e[c].onComplete(new Error(p),!1,null))))}ch(n,n.transactionQueueTree_);for(let c=0;c<i.length;c++)Za(i[c]);q_(n,n.transactionQueueTree_)}function jA(n,e){let t,i=n.transactionQueueTree_;for(t=re(e);t!==null&&Us(i)===void 0;)i=$_(i,t),e=ye(e),t=re(e);return i}function BA(n,e){let t=[];return $A(n,e,t),t.sort((i,r)=>i.order-r.order),t}function $A(n,e,t){let i=Us(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);ah(e,r=>{$A(n,r,t)})}function ch(n,e){let t=Us(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,kA(e,t.length>0?t:void 0)}ah(e,i=>{ch(n,i)})}function O1(n,e){let t=tc(jA(n,e)),i=$_(n.transactionQueueTree_,e);return m1(i,r=>{$g(n,r)}),$g(n,i),MA(i,r=>{$g(n,r)}),t}function $g(n,e){let t=Us(e);if(t){let i=[],r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(M(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(M(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(Rs(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?kA(e,void 0):t.length=s+1,ar(n.eventQueue_,tc(e),r);for(let o=0;o<i.length;o++)Za(i[o])}}function F1(n){let e="",t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function L1(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Ct(`Invalid query segment '${t}' in query '${n}'`)}return e}var OC=function(n,e){let t=V1(n),i=t.namespace;t.domain==="firebase.com"&&Fn(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Fn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||kF();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Hu(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new ge(t.pathString)}},V1=function(n){let e="",t="",i="",r="",s="",o=!0,c="https",l=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(c=n.substring(0,u-1),n=n.substring(u+2));let f=n.indexOf("/");f===-1&&(f=n.length);let p=n.indexOf("?");p===-1&&(p=n.length),e=n.substring(0,Math.min(f,p)),f<p&&(r=F1(n.substring(f,p)));let g=L1(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o=c==="https"||c==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;let w=e.slice(0,u);if(w.toLowerCase()==="localhost")t="localhost";else if(w.split(".").length<=2)t=w;else{let S=e.indexOf(".");i=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=i}"ns"in g&&(s=g.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:c,pathString:r,namespace:s}};var P_=class n{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return ne(this._path)?null:nA(this._path)}get ref(){return new Ls(this._repo,this._path)}get _queryIdentifier(){let e=wC(this._queryParams),t=M_(e);return t==="{}"?"default":t}get _queryObject(){return wC(this._queryParams)}isEqual(e){if(e=xe(e),!(e instanceof n))return!1;let t=this._repo===e._repo,i=sA(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+uL(this._path)}};var Ls=class n extends P_{constructor(e,t){super(e,t,new u_,!1)}get parent(){let e=rA(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};i1(Ls);r1(Ls);var U1="FIREBASE_DATABASE_EMULATOR_HOST",N_={},j1=!1;function B1(n,e,t,i){n.repoInfo_=new Hu(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function $1(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||Fn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),rt("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=OC(s,r),c=o.repoInfo,l,u;typeof process<"u"&&process.env&&(u=process.env[U1]),u?(l=!0,s=`http://${u}?ns=${c.namespace}`,o=OC(s,r),c=o.repoInfo):l=!o.repoInfo.secure;let f=r&&l?new Ga(Ga.OWNER):new Kg(n.name,n.options,e);w1("Invalid Firebase Database URL",o),ne(o.path)||Fn("Database URL must point to the root of a Firebase Database (not including a child path).");let p=q1(c,n,f,new Hg(n.name,t));return new k_(p,n)}function z1(n,e){let t=N_[e];(!t||t[n.key]!==n)&&Fn(`Database ${e}(${n.repoInfo_}) has already been deleted.`),k1(n),delete t[n.key]}function q1(n,e,t,i){let r=N_[e.name];r||(r={},N_[e.name]=r);let s=r[n.toURLString()];return s&&Fn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new D_(n,j1,t,i),r[n.toURLString()]=s,s}var k_=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(S1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ls(this._repo,pe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(z1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Fn("Cannot call "+e+" on a deleted database.")}};function zA(n=bn(),e){let t=En(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let i=gl("database");i&&qA(t,...i)}return t}function qA(n,e,t,i={}){n=xe(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Fn("Cannot call useEmulator() after instance has already been initialized.");let r=n._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Fn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ga(Ga.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:_l(i.mockUserToken,n.app.options.projectId);s=new Ga(o)}B1(r,e,t,s)}function G1(n){DF(Et),wt(new et("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return $1(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),ue(iC,rC,n),ue(iC,rC,"esm2017")}F_.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};F_.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};G1();var nc=class{constructor(e){return e}},GA="database",W_=class{constructor(){return Fi(GA)}};var H_=new H("angularfire2.database-instances");function W1(n,e){let t=Qr(GA,n,e);return t&&new nc(t)}function H1(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new nc(i)}}var K1={provide:W_,deps:[[new De,H_]]},Q1={provide:nc,useFactory:W1,deps:[[new De,H_],Qt]};function WA(n,...e){return ue("angularfire",Ft.full,"rtdb"),ht([Q1,K1,{provide:H_,useFactory:H1(n),multi:!0,deps:[he,Rt,ii,Tn,[new De,$i],[new De,ni],...e]}])}var HA=bt(zA,!0);var KA={providers:[mv({eventCoalescing:!0}),PI(YT,NI()),Vv(Uv()),{provide:xg,useValue:Mg.apiRoot},ZT(),nC(),Dw(()=>Pw(Mg.firebaseConfig)),AE(()=>RE()),pT(()=>mT()),WA(()=>HA())]};console.log(`Based on Angular18 Template v${{version:eC}} [${tC}]`);var QA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Ue({type:n,selectors:[["app-root"]],standalone:!0,features:[je],decls:1,vars:0,template:function(i,r){i&1&&Yn(0,"router-outlet")},dependencies:[Wd],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;gap:40px;width:100%}.item[_ngcontent-%COMP%]{flex:1;margin:0 5px;background-color:#b7c9e2;border-radius:10px;padding:10px}"]})}}return n})();Wv(QA,KA).catch(n=>console.error(n));
