import{$ as Ae,$a as uh,A as qa,Aa as Lt,Ab as cc,B as Zu,Ba as qt,Bb as _h,C as Vn,Ca as sh,Cb as Ny,D as ir,Da as vy,Db as ky,E as ui,Ea as ar,Eb as lc,F as uy,Fa as Iy,Fb as uc,G as eh,Ga as qs,H as Un,Ha as Ws,I as hy,Ia as oh,J as rr,Ja as wy,K as jn,Ka as Ey,L as th,La as ah,Lb as xy,M as dy,Ma as cr,Mb as Hs,N as fy,Na as lr,Nb as hc,O as py,Oa as ch,P as Wa,Pa as lh,Q as lt,Qa as Ya,R as Ga,Ra as Ja,S as Pe,Sa as Xa,Sb as Oy,T as Ee,Ta as ht,Tb as dc,U as G,Ua as dt,V as De,Va as ur,Vb as My,W as my,Wa as Za,X as J,Xa as hr,Y as nh,Ya as Ft,Z as B,Za as dr,_ as U,_a as di,_b as Ly,a as L,aa as js,ab as ec,b as Oe,ba as it,bb as tc,c as hC,ca as Ne,cb as zn,d as Mn,da as un,db as nc,e as I,ea as nt,eb as hh,f as ry,fa as gy,fb as dh,g as sy,ga as sr,gb as fh,h as Ln,ha as Ot,hb as Ty,i as Ku,ia as ih,ib as rt,j as Qu,ja as Bn,jb as Gs,k as ln,ka as $n,kb as ic,l as It,la as rh,lb as rc,m as oy,ma as Mt,mb as by,n as ay,na as Ha,nb as ph,o as Fn,oa as hi,ob as sc,p as Yu,pa as he,pb as mh,q as Ju,qa as Ka,qb as Ay,r as Xu,ra as Bs,rb as Cy,s as ct,sa as hn,sb as oc,t as W,ta as _y,tb as Sy,u as Us,ua as Qa,ub as Ry,v as cy,va as yy,vb as gh,w as ly,wa as ut,wb as Py,x as ne,xa as or,xb as Dy,y as nr,ya as $s,yb as Te,z as wt,za as zs,zb as ac}from"./chunk-XXLTCPR3.js";var Qs=class{},Ys=class{},dn=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var vh=class{encodeKey(e){return Fy(e)}encodeValue(e){return Fy(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function fC(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,c]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(c),t.set(o,l)}),t}var pC=/%(\d[a-f0-9])/gi,mC={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Fy(n){return encodeURIComponent(n).replace(pC,(e,t)=>mC[t]??e)}function fc(n){return`${n}`}var Wn=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new vh,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=fC(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(fc):[fc(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(fc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(fc(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Ih=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function gC(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Vy(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Uy(n){return typeof Blob<"u"&&n instanceof Blob}function jy(n){return typeof FormData<"u"&&n instanceof FormData}function _C(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Ks=class n{constructor(e,t,i,r){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(gC(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new dn,this.context??=new Ih,!this.params)this.params=new Wn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Vy(this.body)||Uy(this.body)||jy(this.body)||_C(this.body)?this.body:this.body instanceof Wn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||jy(this.body)?null:Uy(this.body)?this.body.type||null:Vy(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Wn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,u=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(u=Object.keys(e.setHeaders).reduce((g,w)=>g.set(w,e.setHeaders[w]),u)),e.setParams&&(f=Object.keys(e.setParams).reduce((g,w)=>g.set(w,e.setParams[w]),f)),new n(t,i,o,{params:f,headers:u,context:p,reportProgress:l,responseType:r,withCredentials:c,transferCache:s})}},Gn=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Gn||{}),Js=class{constructor(e,t=200,i="OK"){this.headers=e.headers||new dn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},pc=class n extends Js{constructor(e={}){super(e),this.type=Gn.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Xs=class n extends Js{constructor(e={}){super(e),this.type=Gn.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},qn=class extends Js{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},qy=200,yC=204;function yh(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var vC=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Ks)s=t;else{let l;r.headers instanceof dn?l=r.headers:l=new dn(r.headers);let u;r.params&&(r.params instanceof Wn?u=r.params:u=new Wn({fromObject:r.params})),s=new Ks(t,i,r.body!==void 0?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let o=W(s).pipe(ui(l=>this.handler.handle(l)));if(t instanceof Ks||r.observe==="events")return o;let c=o.pipe(Vn(l=>l instanceof Xs));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(ne(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(ne(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(ne(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(ne(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Wn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,yh(r,i))}post(t,i,r={}){return this.request("POST",t,yh(r,i))}put(t,i,r={}){return this.request("PUT",t,yh(r,i))}static{this.\u0275fac=function(i){return new(i||n)(B(Qs))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),IC=/^\)\]\}',?\n/,wC="X-Request-URL";function By(n){if(n.url)return n.url;let e=wC.toLocaleLowerCase();return n.headers.get(e)}var wh=(()=>{class n{constructor(){this.fetchImpl=U(Eh,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=U(he)}handle(t){return new Ln(i=>{let r=new AbortController;return this.doRequest(t,r.signal,i).then(Th,s=>i.error(new qn({error:s}))),()=>r.abort()})}doRequest(t,i,r){return I(this,null,function*(){let s=this.createRequestInit(t),o;try{let w=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,L({signal:i},s)));EC(w),r.next({type:Gn.Sent}),o=yield w}catch(w){r.error(new qn({error:w,status:w.status??0,statusText:w.statusText,url:t.urlWithParams,headers:w.headers}));return}let c=new dn(o.headers),l=o.statusText,u=By(o)??t.urlWithParams,f=o.status,p=null;if(t.reportProgress&&r.next(new pc({headers:c,status:f,statusText:l,url:u})),o.body){let w=o.headers.get("content-length"),S=[],D=o.body.getReader(),P=0,V,j,M=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>I(this,null,function*(){for(;;){let{done:ve,value:ee}=yield D.read();if(ve)break;if(S.push(ee),P+=ee.length,t.reportProgress){j=t.responseType==="text"?(j??"")+(V??=new TextDecoder).decode(ee,{stream:!0}):void 0;let T=()=>r.next({type:Gn.DownloadProgress,total:w?+w:void 0,loaded:P,partialText:j});M?M.run(T):T()}}}));let oe=this.concatChunks(S,P);try{let ve=o.headers.get("Content-Type")??"";p=this.parseBody(t,oe,ve)}catch(ve){r.error(new qn({error:ve,headers:new dn(o.headers),status:o.status,statusText:o.statusText,url:By(o)??t.urlWithParams}));return}}f===0&&(f=p?qy:0),f>=200&&f<300?(r.next(new Xs({body:p,headers:c,status:f,statusText:l,url:u})),r.complete()):r.error(new qn({error:p,headers:c,status:f,statusText:l,url:u}))})}parseBody(t,i,r){switch(t.responseType){case"json":let s=new TextDecoder().decode(i).replace(IC,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(t){let i={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((s,o)=>i[s]=o.join(",")),t.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(i["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:i,credentials:r}}concatChunks(t,i){let r=new Uint8Array(i),s=0;for(let o of t)r.set(o,s),s+=o.length;return r}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Eh=class{};function Th(){}function EC(n){n.then(Th,Th)}function TC(n,e){return e(n)}function bC(n,e,t){return(i,r)=>Ot(t,()=>e(i,s=>n(s,r)))}var Wy=new J(""),AC=new J(""),CC=new J("",{providedIn:"root",factory:()=>!0});var $y=(()=>{class n extends Qs{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=U(Ha),this.contributeToStability=U(CC)}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(Wy),...this.injector.get(AC,[])]));this.chain=i.reduceRight((r,s)=>bC(r,s,this.injector),TC)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(rr(()=>this.pendingTasks.remove(i)))}else return this.chain(t,i=>this.backend.handle(i))}static{this.\u0275fac=function(i){return new(i||n)(B(Ys),B(sr))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();var SC=/^\)\]\}',?\n/;function RC(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var zy=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new Ee(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?ct(i.\u0275loadImpl()):W(null)).pipe(lt(()=>new Ln(s=>{let o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((D,P)=>o.setRequestHeader(D,P.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let D=t.detectContentTypeHeader();D!==null&&o.setRequestHeader("Content-Type",D)}if(t.responseType){let D=t.responseType.toLowerCase();o.responseType=D!=="json"?D:"text"}let c=t.serializeBody(),l=null,u=()=>{if(l!==null)return l;let D=o.statusText||"OK",P=new dn(o.getAllResponseHeaders()),V=RC(o)||t.url;return l=new pc({headers:P,status:o.status,statusText:D,url:V}),l},f=()=>{let{headers:D,status:P,statusText:V,url:j}=u(),M=null;P!==yC&&(M=typeof o.response>"u"?o.responseText:o.response),P===0&&(P=M?qy:0);let oe=P>=200&&P<300;if(t.responseType==="json"&&typeof M=="string"){let ve=M;M=M.replace(SC,"");try{M=M!==""?JSON.parse(M):null}catch(ee){M=ve,oe&&(oe=!1,M={error:ee,text:M})}}oe?(s.next(new Xs({body:M,headers:D,status:P,statusText:V,url:j||void 0})),s.complete()):s.error(new qn({error:M,headers:D,status:P,statusText:V,url:j||void 0}))},p=D=>{let{url:P}=u(),V=new qn({error:D,status:o.status||0,statusText:o.statusText||"Unknown Error",url:P||void 0});s.error(V)},g=!1,w=D=>{g||(s.next(u()),g=!0);let P={type:Gn.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(P.total=D.total),t.responseType==="text"&&o.responseText&&(P.partialText=o.responseText),s.next(P)},S=D=>{let P={type:Gn.UploadProgress,loaded:D.loaded};D.lengthComputable&&(P.total=D.total),s.next(P)};return o.addEventListener("load",f),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),t.reportProgress&&(o.addEventListener("progress",w),c!==null&&o.upload&&o.upload.addEventListener("progress",S)),o.send(c),s.next({type:Gn.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",f),o.removeEventListener("timeout",p),t.reportProgress&&(o.removeEventListener("progress",w),c!==null&&o.upload&&o.upload.removeEventListener("progress",S)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(i){return new(i||n)(B(uc))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Gy=new J(""),PC="XSRF-TOKEN",DC=new J("",{providedIn:"root",factory:()=>PC}),NC="X-XSRF-TOKEN",kC=new J("",{providedIn:"root",factory:()=>NC}),mc=class{},xC=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=cc(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(i){return new(i||n)(B(Te),B(ut),B(DC))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();function OC(n,e){let t=n.url.toLowerCase();if(!U(Gy)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let i=U(mc).getToken(),r=U(kC);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var Hy=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(Hy||{});function MC(n,e){return{\u0275kind:n,\u0275providers:e}}function Ky(...n){let e=[vC,zy,$y,{provide:Qs,useExisting:$y},{provide:Ys,useFactory:()=>U(wh,{optional:!0})??U(zy)},{provide:Wy,useValue:OC,multi:!0},{provide:Gy,useValue:!0},{provide:mc,useClass:xC}];for(let t of n)e.push(...t.\u0275providers);return nt(e)}function Qy(){return MC(Hy.Fetch,[wh,{provide:Ys,useExisting:wh}])}var Ch=class extends Dy{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Sh=class n extends Ch{static makeCurrent(){Py(new n)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=FC();return t==null?null:VC(t)}resetBaseElement(){Zs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cc(document.cookie,e)}},Zs=null;function FC(){return Zs=Zs||document.querySelector("base"),Zs?Zs.getAttribute("href"):null}function VC(n){return new URL(n,document.baseURI).pathname}var UC=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Rh=new J(""),Xy=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new Ee(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(B(Rh),B(he))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),gc=class{constructor(e){this._doc=e}},bh="ng-app-id",Zy=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=lc(s),this.resetHostNodes()}addStyles(t){for(let i of t)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(t){for(let i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){let i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${bh}="${this.appId}"]`);if(t?.length){let i=new Map;return t.forEach(r=>{r.textContent!=null&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){let r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(bh),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(bh,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){let r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(B(Te),B(Qa),B($s,8),B(ut))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Ah={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Dh=/%COMP%/g,ev="%COMP%",jC=`_nghost-${ev}`,BC=`_ngcontent-${ev}`,$C=!0,zC=new J("",{providedIn:"root",factory:()=>$C});function qC(n){return BC.replace(Dh,n)}function WC(n){return jC.replace(Dh,n)}function tv(n,e){return e.map(t=>t.replace(Dh,n))}var fr=(()=>{class n{constructor(t,i,r,s,o,c,l,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=lc(c),this.defaultRenderer=new eo(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===js.ShadowDom&&(i=Oe(L({},i),{encapsulation:js.Emulated}));let r=this.getOrCreateRenderer(t,i);return r instanceof _c?r.applyToHost(t):r instanceof to&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,s=r.get(i.id);if(!s){let o=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(i.encapsulation){case js.Emulated:s=new _c(l,u,i,this.appId,f,o,c,p);break;case js.ShadowDom:return new Ph(l,u,t,i,o,c,this.nonce,p);default:s=new to(l,u,i,f,o,c,p);break}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(B(Xy),B(Zy),B(Qa),B(zC),B(Te),B(ut),B(he),B($s))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),eo=class{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Ah[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Yy(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Yy(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Ee(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let s=Ah[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=Ah[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(zs.DashCase|zs.Important)?e.style.setProperty(t,i,r&zs.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&zs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=gh().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Yy(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Ph=class extends eo{constructor(e,t,i,r,s,o,c,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=tv(r.id,r.styles);for(let f of u){let p=document.createElement("style");c&&p.setAttribute("nonce",c),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},to=class extends eo{constructor(e,t,i,r,s,o,c,l){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?tv(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},_c=class extends to{constructor(e,t,i,r,s,o,c,l){let u=r+"-"+i.id;super(e,t,i,s,o,c,l,u),this.contentAttr=qC(u),this.hostAttr=WC(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},GC=(()=>{class n extends gc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(B(Te))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Jy=["alt","control","meta","shift"],HC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},KC={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},QC=(()=>{class n extends gc{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r){let s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gh().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let s=n._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),Jy.forEach(u=>{let f=i.indexOf(u);f>-1&&(i.splice(f,1),o+=u+".")}),o+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=HC[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Jy.forEach(o=>{if(o!==r){let c=KC[o];c(t)&&(s+=o+".")}}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(B(Te))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();function nv(n,e){return Sy(L({rootComponent:n},YC(e)))}function YC(n){return{appProviders:[...tS,...n?.providers??[]],platformProviders:eS}}function JC(){Sh.makeCurrent()}function XC(){return new Ka}function ZC(){return _y(document),document}var eS=[{provide:ut,useValue:Ny},{provide:yy,useValue:JC,multi:!0},{provide:Te,useFactory:ZC,deps:[]}];var tS=[{provide:gy,useValue:"root"},{provide:Ka,useFactory:XC,deps:[]},{provide:Rh,useClass:GC,multi:!0,deps:[Te,he,ut]},{provide:Rh,useClass:QC,multi:!0,deps:[Te]},fr,Zy,Xy,{provide:ar,useExisting:fr},{provide:uc,useClass:UC,deps:[]},[]];var iv=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(i){return new(i||n)(B(Te))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Y="primary",vo=Symbol("RouteTitle"),Mh=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function vr(n){return new Mh(n)}function sS(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],c=n[s];if(o[0]===":")r[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function oS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Wt(n[t],e[t]))return!1;return!0}function Wt(n,e){let t=n?Lh(n):void 0,i=e?Lh(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!fv(n[r],e[r]))return!1;return!0}function Lh(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function fv(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}else return n===e}function pv(n){return n.length>0?n[n.length-1]:null}function Hn(n){return cy(n)?n:by(n)?ct(Promise.resolve(n)):W(n)}var aS={exact:gv,subset:_v},mv={exact:cS,subset:lS,ignored:()=>!0};function rv(n,e,t){return aS[t.paths](n.root,e.root,t.matrixParams)&&mv[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function cS(n,e){return Wt(n,e)}function gv(n,e,t){if(!pi(n.segments,e.segments)||!Ic(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!gv(n.children[i],e.children[i],t))return!1;return!0}function lS(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>fv(n[t],e[t]))}function _v(n,e,t){return yv(n,e,e.segments,t)}function yv(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!pi(r,t)||e.hasChildren()||!Ic(r,t,i))}else if(n.segments.length===t.length){if(!pi(n.segments,t)||!Ic(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!_v(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!pi(n.segments,r)||!Ic(n.segments,r,i)||!n.children[Y]?!1:yv(n.children[Y],e,s,i)}}function Ic(n,e,t){return e.every((i,r)=>mv[t](n[r].parameters,i.parameters))}var pn=class{constructor(e=new le([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=vr(this.queryParams),this._queryParamMap}toString(){return dS.serialize(this)}},le=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wc(this)}},fi=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=vr(this.parameters),this._parameterMap}toString(){return Iv(this)}};function uS(n,e){return pi(n,e)&&n.every((t,i)=>Wt(t.parameters,e[i].parameters))}function pi(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function hS(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===Y&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==Y&&(t=t.concat(e(r,i)))}),t}var ud=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:()=>new co,providedIn:"root"})}}return n})(),co=class{parse(e){let t=new Vh(e);return new pn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${no(e.root,!0)}`,i=mS(e.queryParams),r=typeof e.fragment=="string"?`#${fS(e.fragment)}`:"";return`${t}${i}${r}`}},dS=new co;function wc(n){return n.segments.map(e=>Iv(e)).join("/")}function no(n,e){if(!n.hasChildren())return wc(n);if(e){let t=n.children[Y]?no(n.children[Y],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==Y&&i.push(`${r}:${no(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=hS(n,(i,r)=>r===Y?[no(n.children[Y],!1)]:[`${r}:${no(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[Y]!=null?`${wc(n)}/${t[0]}`:`${wc(n)}/(${t.join("//")})`}}function vv(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yc(n){return vv(n).replace(/%3B/gi,";")}function fS(n){return encodeURI(n)}function Fh(n){return vv(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ec(n){return decodeURIComponent(n)}function sv(n){return Ec(n.replace(/\+/g,"%20"))}function Iv(n){return`${Fh(n.path)}${pS(n.parameters)}`}function pS(n){return Object.entries(n).map(([e,t])=>`;${Fh(e)}=${Fh(t)}`).join("")}function mS(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${yc(t)}=${yc(r)}`).join("&"):`${yc(t)}=${yc(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var gS=/^[^\/()?;#]+/;function Nh(n){let e=n.match(gS);return e?e[0]:""}var _S=/^[^\/()?;=#]+/;function yS(n){let e=n.match(_S);return e?e[0]:""}var vS=/^[^=?&#]+/;function IS(n){let e=n.match(vS);return e?e[0]:""}var wS=/^[^&#]+/;function ES(n){let e=n.match(wS);return e?e[0]:""}var Vh=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new le([],{}):new le([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Y]=new le(e,t)),i}parseSegment(){let e=Nh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Ee(4009,!1);return this.capture(e),new fi(Ec(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=yS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=Nh(this.remaining);r&&(i=r,this.capture(i))}e[Ec(t)]=Ec(i)}parseQueryParam(e){let t=IS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=ES(this.remaining);o&&(i=o,this.capture(i))}let r=sv(t),s=sv(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Nh(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new Ee(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Y);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[Y]:new le([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Ee(4011,!1)}};function wv(n){return n.segments.length>0?new le([],{[Y]:n}):n}function Ev(n){let e={};for(let[i,r]of Object.entries(n.children)){let s=Ev(r);if(i===Y&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let t=new le(n.segments,e);return TS(t)}function TS(n){if(n.numberOfChildren===1&&n.children[Y]){let e=n.children[Y];return new le(n.segments.concat(e.segments),e.children)}return n}function lo(n){return n instanceof pn}function bS(n,e,t=null,i=null){let r=Tv(n);return bv(r,e,t,i)}function Tv(n){let e;function t(s){let o={};for(let l of s.children){let u=t(l);o[l.outlet]=u}let c=new le(s.url,o);return s===n&&(e=c),c}let i=t(n.root),r=wv(i);return e??r}function bv(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return kh(r,r,r,t,i);let s=AS(e);if(s.toRoot())return kh(r,r,new le([],{}),t,i);let o=CS(s,r,n),c=o.processChildren?so(o.segmentGroup,o.index,s.commands):Cv(o.segmentGroup,o.index,s.commands);return kh(r,o.segmentGroup,c,t,i)}function Tc(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function uo(n){return typeof n=="object"&&n!=null&&n.outlets}function kh(n,e,t,i,r){let s={};i&&Object.entries(i).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`});let o;n===e?o=t:o=Av(n,e,t);let c=wv(Ev(o));return new pn(c,s,r)}function Av(n,e,t){let i={};return Object.entries(n.children).forEach(([r,s])=>{s===e?i[r]=t:i[r]=Av(s,e,t)}),new le(n.segments,i)}var bc=class{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Tc(i[0]))throw new Ee(4003,!1);let r=i.find(uo);if(r&&r!==pv(i))throw new Ee(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function AS(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new bc(!0,0,n);let e=0,t=!1,i=n.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,u])=>{c[l]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&r.push(c))}),r):[...r,s]},[]);return new bc(t,e,i)}var gr=class{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function CS(n,e,t){if(n.isAbsolute)return new gr(e,!0,0);if(!t)return new gr(e,!1,NaN);if(t.parent===null)return new gr(t,!0,0);let i=Tc(n.commands[0])?0:1,r=t.segments.length-1+i;return SS(t,r,n.numberOfDoubleDots)}function SS(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Ee(4005,!1);r=i.segments.length}return new gr(i,!1,r-s)}function RS(n){return uo(n[0])?n[0].outlets:{[Y]:n}}function Cv(n,e,t){if(n??=new le([],{}),n.segments.length===0&&n.hasChildren())return so(n,e,t);let i=PS(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let s=new le(n.segments.slice(0,i.pathIndex),{});return s.children[Y]=new le(n.segments.slice(i.pathIndex),n.children),so(s,0,r)}else return i.match&&r.length===0?new le(n.segments,{}):i.match&&!n.hasChildren()?Uh(n,e,t):i.match?so(n,0,r):Uh(n,e,t)}function so(n,e,t){if(t.length===0)return new le(n.segments,{});{let i=RS(t),r={};if(Object.keys(i).some(s=>s!==Y)&&n.children[Y]&&n.numberOfChildren===1&&n.children[Y].segments.length===0){let s=so(n.children[Y],e,t);return new le(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=Cv(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new le(n.segments,r)}}function PS(n,e,t){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;let o=n.segments[r],c=t[i];if(uo(c))break;let l=`${c}`,u=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!av(l,u,o))return s;i+=2}else{if(!av(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function Uh(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(uo(s)){let l=DS(s.outlets);return new le(i,l)}if(r===0&&Tc(t[0])){let l=n.segments[e];i.push(new fi(l.path,ov(t[0]))),r++;continue}let o=uo(s)?s.outlets[Y]:`${s}`,c=r<t.length-1?t[r+1]:null;o&&c&&Tc(c)?(i.push(new fi(o,ov(c))),r+=2):(i.push(new fi(o,{})),r++)}return new le(i,{})}function DS(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=Uh(new le([],{}),0,i))}),e}function ov(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function av(n,e,t){return n==t.path&&Wt(e,t.parameters)}var oo="imperative",Be=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Be||{}),Et=class{constructor(e,t){this.id=e,this.url=t}},ho=class extends Et{constructor(e,t,i="imperative",r=null){super(e,t),this.type=Be.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},mi=class extends Et{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=Be.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},pt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(pt||{}),jh=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(jh||{}),fn=class extends Et{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=Be.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},gi=class extends Et{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=Be.NavigationSkipped}},fo=class extends Et{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=Be.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ac=class extends Et{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=Be.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bh=class extends Et{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=Be.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},$h=class extends Et{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=Be.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},zh=class extends Et{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=Be.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qh=class extends Et{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=Be.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wh=class{constructor(e){this.route=e,this.type=Be.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Gh=class{constructor(e){this.route=e,this.type=Be.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Hh=class{constructor(e){this.snapshot=e,this.type=Be.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kh=class{constructor(e){this.snapshot=e,this.type=Be.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qh=class{constructor(e){this.snapshot=e,this.type=Be.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yh=class{constructor(e){this.snapshot=e,this.type=Be.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var po=class{},Ir=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function NS(n,e){return n.providers&&!n._injector&&(n._injector=Ey(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Vt(n){return n.outlet||Y}function kS(n,e){let t=n.filter(i=>Vt(i)===e);return t.push(...n.filter(i=>Vt(i)!==e)),t}function Io(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Jh=class{get injector(){return Io(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new kc(this.rootInjector),this.attachRef=null}},kc=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Jh(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(i){return new(i||n)(B(sr))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Cc=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Xh(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=Xh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Zh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Zh(e,this._root).map(t=>t.value)}};function Xh(n,e){if(n===e.value)return e;for(let t of e.children){let i=Xh(n,t);if(i)return i}return null}function Zh(n,e){if(n===e.value)return[e];for(let t of e.children){let i=Zh(n,t);if(i.length)return i.unshift(e),i}return[]}var ft=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function mr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Sc=class extends Cc{constructor(e,t){super(e),this.snapshot=t,hd(this,e)}toString(){return this.snapshot.toString()}};function Sv(n){let e=xS(n),t=new It([new fi("",{})]),i=new It({}),r=new It({}),s=new It({}),o=new It(""),c=new wr(t,i,s,o,r,Y,n,e.root);return c.snapshot=e.root,new Sc(new ft(c,[]),e)}function xS(n){let e={},t={},i={},r="",s=new _r([],e,i,r,t,Y,n,null,{});return new Pc("",new ft(s,[]))}var wr=class{constructor(e,t,i,r,s,o,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(ne(u=>u[vo]))??W(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ne(e=>vr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ne(e=>vr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Rc(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:L(L({},e.params),n.params),data:L(L({},e.data),n.data),resolve:L(L(L(L({},n.data),e.data),r?.data),n._resolvedData)}:i={params:L({},n.params),data:L({},n.data),resolve:L(L({},n.data),n._resolvedData??{})},r&&Pv(r)&&(i.resolve[vo]=r.title),i}var _r=class{get title(){return this.data?.[vo]}constructor(e,t,i,r,s,o,c,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=vr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=vr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Pc=class extends Cc{constructor(e,t){super(t),this.url=e,hd(this,t)}toString(){return Rv(this._root)}};function hd(n,e){e.value._routerState=n,e.children.forEach(t=>hd(n,t))}function Rv(n){let e=n.children.length>0?` { ${n.children.map(Rv).join(", ")} } `:"";return`${n.value}${e}`}function xh(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Wt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Wt(e.params,t.params)||n.paramsSubject.next(t.params),oS(e.url,t.url)||n.urlSubject.next(t.url),Wt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ed(n,e){let t=Wt(n.params,e.params)&&uS(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||ed(n.parent,e.parent))}function Pv(n){return typeof n.title=="string"||n.title===null}var OS=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Y,this.activateEvents=new hi,this.deactivateEvents=new hi,this.attachEvents=new hi,this.detachEvents=new hi,this.parentContexts=U(kc),this.location=U(Iy),this.changeDetector=U(oc),this.inputBinder=U(xc,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ee(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ee(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ee(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Ee(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new td(t,c,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=un({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ih]})}}return n})(),td=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===wr?this.route:e===kc?this.childContexts:this.parent.get(e,t)}},xc=new J(""),cv=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:i}=t,r=nr([i.queryParams,i.params,i.data]).pipe(lt(([s,o,c],l)=>(c=L(L(L({},s),o),c),l===0?W(c):Promise.resolve(c)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(t);return}let o=Ry(i.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:c}of o.inputs)t.activatedComponentRef.setInput(c,s[c])});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();function MS(n,e,t){let i=mo(n,e._root,t?t._root:void 0);return new Sc(i,e)}function mo(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=LS(n,e,t);return new ft(i,r)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>mo(n,c)),o}}let i=FS(e.value),r=e.children.map(s=>mo(n,s));return new ft(i,r)}}function LS(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return mo(n,i,r);return mo(n,i)})}function FS(n){return new wr(new It(n.url),new It(n.params),new It(n.queryParams),new It(n.fragment),new It(n.data),n.outlet,n.component,n)}var go=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Dv="ngNavigationCancelingError";function Dc(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=lo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=Nv(!1,pt.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function Nv(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Dv]=!0,t.cancellationCode=e,t}function VS(n){return kv(n)&&lo(n.url)}function kv(n){return!!n&&n[Dv]}var US=(n,e,t,i)=>ne(r=>(new nd(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),nd=class{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),xh(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=mr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=mr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=mr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=mr(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Yh(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Kh(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(xh(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),xh(c.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}},Nc=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},yr=class{constructor(e,t){this.component=e,this.route=t}};function jS(n,e,t){let i=n._root,r=e?e._root:null;return io(i,r,t,[i.value])}function BS(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Tr(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!my(n)?n:e.get(n):i}function io(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=mr(e);return n.children.forEach(o=>{$S(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>ao(c,t.getContext(o),r)),r}function $S(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=zS(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Nc(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?io(n,e,c?c.children:null,i,r):io(n,e,t,i,r),l&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new yr(c.outlet.component,o))}else o&&ao(e,c,r),r.canActivateChecks.push(new Nc(i)),s.component?io(n,null,c?c.children:null,i,r):io(n,null,t,i,r);return r}function zS(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!pi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!pi(n.url,e.url)||!Wt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ed(n,e)||!Wt(n.queryParams,e.queryParams);case"paramsChange":default:return!ed(n,e)}}function ao(n,e,t){let i=mr(n),r=n.value;Object.entries(i).forEach(([s,o])=>{r.component?e?ao(o,e.children.getContext(s),t):ao(o,null,t):ao(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new yr(e.outlet.component,r)):t.canDeactivateChecks.push(new yr(null,r)):t.canDeactivateChecks.push(new yr(null,r))}function wo(n){return typeof n=="function"}function qS(n){return typeof n=="boolean"}function WS(n){return n&&wo(n.canLoad)}function GS(n){return n&&wo(n.canActivate)}function HS(n){return n&&wo(n.canActivateChild)}function KS(n){return n&&wo(n.canDeactivate)}function QS(n){return n&&wo(n.canMatch)}function xv(n){return n instanceof ly||n?.name==="EmptyError"}var vc=Symbol("INITIAL_VALUE");function Er(){return lt(n=>nr(n.map(e=>e.pipe(Un(1),Wa(vc)))).pipe(ne(e=>{for(let t of e)if(t!==!0){if(t===vc)return vc;if(t===!1||YS(t))return t}return!0}),Vn(e=>e!==vc),Un(1)))}function YS(n){return lo(n)||n instanceof go}function JS(n,e){return wt(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?W(Oe(L({},t),{guardsResult:!0})):XS(o,i,r,n).pipe(wt(c=>c&&qS(c)?ZS(i,s,n,e):W(c)),ne(c=>Oe(L({},t),{guardsResult:c})))})}function XS(n,e,t,i){return ct(n).pipe(wt(r=>r0(r.component,r.route,t,e,i)),jn(r=>r!==!0,!0))}function ZS(n,e,t,i){return ct(e).pipe(ui(r=>qa(t0(r.route.parent,i),e0(r.route,i),i0(n,r.path,t),n0(n,r.route,t))),jn(r=>r!==!0,!0))}function e0(n,e){return n!==null&&e&&e(new Qh(n)),W(!0)}function t0(n,e){return n!==null&&e&&e(new Hh(n)),W(!0)}function n0(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return W(!0);let r=i.map(s=>Zu(()=>{let o=Io(e)??t,c=Tr(s,o),l=GS(c)?c.canActivate(e,n):Ot(o,()=>c(e,n));return Hn(l).pipe(jn())}));return W(r).pipe(Er())}function i0(n,e,t){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>BS(o)).filter(o=>o!==null).map(o=>Zu(()=>{let c=o.guards.map(l=>{let u=Io(o.node)??t,f=Tr(l,u),p=HS(f)?f.canActivateChild(i,n):Ot(u,()=>f(i,n));return Hn(p).pipe(jn())});return W(c).pipe(Er())}));return W(s).pipe(Er())}function r0(n,e,t,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return W(!0);let o=s.map(c=>{let l=Io(e)??r,u=Tr(c,l),f=KS(u)?u.canDeactivate(n,e,t,i):Ot(l,()=>u(n,e,t,i));return Hn(f).pipe(jn())});return W(o).pipe(Er())}function s0(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return W(!0);let s=r.map(o=>{let c=Tr(o,n),l=WS(c)?c.canLoad(e,t):Ot(n,()=>c(e,t));return Hn(l)});return W(s).pipe(Er(),Ov(i))}function Ov(n){return sy(Pe(e=>{if(typeof e!="boolean")throw Dc(n,e)}),ne(e=>e===!0))}function o0(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return W(!0);let s=r.map(o=>{let c=Tr(o,n),l=QS(c)?c.canMatch(e,t):Ot(n,()=>c(e,t));return Hn(l)});return W(s).pipe(Er(),Ov(i))}var _o=class{constructor(e){this.segmentGroup=e||null}},yo=class extends Error{constructor(e){super(),this.urlTree=e}};function pr(n){return Us(new _o(n))}function a0(n){return Us(new Ee(4e3,!1))}function c0(n){return Us(Nv(!1,pt.GuardRejected))}var id=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return W(i);if(r.numberOfChildren>1||!r.children[Y])return a0(`${e.redirectTo}`);r=r.children[Y]}}applyRedirectCommands(e,t,i,r,s){if(typeof t!="string"){let c=t,{queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,params:w,data:S,title:D}=r,P=Ot(s,()=>c({params:w,data:S,queryParams:l,fragment:u,routeConfig:f,url:p,outlet:g,title:D}));if(P instanceof pn)throw new yo(P);t=P}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t[0]==="/")throw new yo(o);return o}applyRedirectCreateUrlTree(e,t,i,r){let s=this.createSegmentGroup(e,t.root,i,r);return new pn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);i[r]=t[c]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){let s=this.createSegments(e,t.segments,i,r),o={};return Object.entries(t.children).forEach(([c,l])=>{o[c]=this.createSegmentGroup(e,l,i,r)}),new le(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new Ee(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}},rd={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function l0(n,e,t,i,r){let s=Mv(n,e,t);return s.matched?(i=NS(e,i),o0(i,e,t,r).pipe(ne(o=>o===!0?s:L({},rd)))):W(s)}function Mv(n,e,t){if(e.path==="**")return u0(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?L({},rd):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||sS)(t,n,e);if(!r)return L({},rd);let s={};Object.entries(r.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let o=r.consumed.length>0?L(L({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function u0(n){return{matched:!0,parameters:n.length>0?pv(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function lv(n,e,t,i){return t.length>0&&f0(n,t,i)?{segmentGroup:new le(e,d0(i,new le(t,n.children))),slicedSegments:[]}:t.length===0&&p0(n,t,i)?{segmentGroup:new le(n.segments,h0(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new le(n.segments,n.children),slicedSegments:t}}function h0(n,e,t,i){let r={};for(let s of t)if(Oc(n,e,s)&&!i[Vt(s)]){let o=new le([],{});r[Vt(s)]=o}return L(L({},i),r)}function d0(n,e){let t={};t[Y]=e;for(let i of n)if(i.path===""&&Vt(i)!==Y){let r=new le([],{});t[Vt(i)]=r}return t}function f0(n,e,t){return t.some(i=>Oc(n,e,i)&&Vt(i)!==Y)}function p0(n,e,t){return t.some(i=>Oc(n,e,i))}function Oc(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function m0(n,e,t){return e.length===0&&!n.children[t]}var sd=class{};function g0(n,e,t,i,r,s,o="emptyOnly"){return new od(n,e,t,i,r,o,s).recognize()}var _0=31,od=class{constructor(e,t,i,r,s,o,c){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new id(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Ee(4002,`'${e.segmentGroup}'`)}recognize(){let e=lv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ne(({children:t,rootSnapshot:i})=>{let r=new ft(i,t),s=new Pc("",r),o=bS(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new _r([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Y,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Y,t).pipe(ne(i=>({children:i,rootSnapshot:t})),ir(i=>{if(i instanceof yo)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof _o?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,s){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,r,!0,s).pipe(ne(o=>o instanceof ft?[o]:[]))}processChildren(e,t,i,r){let s=[];for(let o of Object.keys(i.children))o==="primary"?s.unshift(o):s.push(o);return ct(s).pipe(ui(o=>{let c=i.children[o],l=kS(t,o);return this.processSegmentGroup(e,l,c,o,r)}),fy((o,c)=>(o.push(...c),o)),eh(null),dy(),wt(o=>{if(o===null)return pr(i);let c=Lv(o);return y0(c),W(c)}))}processSegment(e,t,i,r,s,o,c){return ct(t).pipe(ui(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,s,o,c).pipe(ir(u=>{if(u instanceof _o)return W(null);throw u}))),jn(l=>!!l),ir(l=>{if(xv(l))return m0(i,r,s)?W(new sd):pr(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,s,o,c,l){return Vt(i)!==o&&(o===Y||!Oc(r,s,i))?pr(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o,l):pr(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o,c){let{matched:l,parameters:u,consumedSegments:f,positionalParamSegments:p,remainingSegments:g}=Mv(t,r,s);if(!l)return pr(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>_0&&(this.allowRedirects=!1));let w=new _r(s,u,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,uv(r),Vt(r),r.component??r._loadedComponent??null,r,hv(r)),S=Rc(w,c,this.paramsInheritanceStrategy);w.params=Object.freeze(S.params),w.data=Object.freeze(S.data);let D=this.applyRedirects.applyRedirectCommands(f,r.redirectTo,p,w,e);return this.applyRedirects.lineralizeSegments(r,D).pipe(wt(P=>this.processSegment(e,i,t,P.concat(g),o,!1,c)))}matchSegmentAgainstRoute(e,t,i,r,s,o){let c=l0(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),c.pipe(lt(l=>l.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(lt(({routes:u})=>{let f=i._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:w}=l,S=new _r(g,p,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,uv(i),Vt(i),i.component??i._loadedComponent??null,i,hv(i)),D=Rc(S,o,this.paramsInheritanceStrategy);S.params=Object.freeze(D.params),S.data=Object.freeze(D.data);let{segmentGroup:P,slicedSegments:V}=lv(t,g,w,u);if(V.length===0&&P.hasChildren())return this.processChildren(f,u,P,S).pipe(ne(M=>new ft(S,M)));if(u.length===0&&V.length===0)return W(new ft(S,[]));let j=Vt(i)===s;return this.processSegment(f,u,P,V,j?Y:s,!0,S).pipe(ne(M=>new ft(S,M instanceof ft?[M]:[])))}))):pr(t)))}getChildConfig(e,t,i){return t.children?W({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?W({routes:t._loadedRoutes,injector:t._loadedInjector}):s0(e,t,i,this.urlSerializer).pipe(wt(r=>r?this.configLoader.loadChildren(e,t).pipe(Pe(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):c0(t))):W({routes:[],injector:e})}};function y0(n){n.sort((e,t)=>e.value.outlet===Y?-1:t.value.outlet===Y?1:e.value.outlet.localeCompare(t.value.outlet))}function v0(n){let e=n.value.routeConfig;return e&&e.path===""}function Lv(n){let e=[],t=new Set;for(let i of n){if(!v0(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=Lv(i.children);e.push(new ft(i.value,r))}return e.filter(i=>!t.has(i))}function uv(n){return n.data||{}}function hv(n){return n.resolve||{}}function I0(n,e,t,i,r,s){return wt(o=>g0(n,e,t,i,o.extractedUrl,r,s).pipe(ne(({state:c,tree:l})=>Oe(L({},o),{targetSnapshot:c,urlAfterRedirects:l}))))}function w0(n,e){return wt(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return W(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let u of Fv(l))o.add(u);let c=0;return ct(o).pipe(ui(l=>s.has(l)?E0(l,i,n,e):(l.data=Rc(l,l.parent,n).resolve,W(void 0))),Pe(()=>c++),th(1),wt(l=>c===o.size?W(t):Fn))})}function Fv(n){let e=n.children.map(t=>Fv(t)).flat();return[n,...e]}function E0(n,e,t,i){let r=n.routeConfig,s=n._resolve;return r?.title!==void 0&&!Pv(r)&&(s[vo]=r.title),T0(s,n,e,i).pipe(ne(o=>(n._resolvedData=o,n.data=Rc(n,n.parent,t).resolve,null)))}function T0(n,e,t,i){let r=Lh(n);if(r.length===0)return W({});let s={};return ct(r).pipe(wt(o=>b0(n[o],e,t,i).pipe(jn(),Pe(c=>{if(c instanceof go)throw Dc(new co,c);s[o]=c}))),th(1),hy(s),ir(o=>xv(o)?Fn:Us(o)))}function b0(n,e,t,i){let r=Io(e)??i,s=Tr(n,r),o=s.resolve?s.resolve(e,t):Ot(r,()=>s(e,t));return Hn(o)}function Oh(n){return lt(e=>{let t=n(e);return t?ct(t).pipe(ne(()=>e)):W(e)})}var Vv=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Y);return i}getResolvedTitleForRoute(t){return t.data[vo]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:()=>U(A0),providedIn:"root"})}}return n})(),A0=(()=>{class n extends Vv{constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||n)(B(iv))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),dd=new J("",{providedIn:"root",factory:()=>({})}),C0=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=it({type:n,selectors:[["ng-component"]],standalone:!0,features:[rt],decls:1,vars:0,template:function(i,r){i&1&&ur(0,"router-outlet")},dependencies:[OS],encapsulation:2})}}return n})();function fd(n){let e=n.children&&n.children.map(fd),t=e?Oe(L({},n),{children:e}):L({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Y&&(t.component=C0),t}var pd=new J(""),S0=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=U(mh)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return W(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let i=Hn(t.loadComponent()).pipe(ne(Uv),Pe(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),rr(()=>{this.componentLoaders.delete(t)})),r=new Qu(i,()=>new ln).pipe(Ku());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return W({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=R0(i,this.compiler,t,this.onLoadEndListener).pipe(rr(()=>{this.childrenLoaders.delete(i)})),o=new Qu(s,()=>new ln).pipe(Ku());return this.childrenLoaders.set(i,o),o}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function R0(n,e,t,i){return Hn(n.loadChildren()).pipe(ne(Uv),wt(r=>r instanceof wy||Array.isArray(r)?W(r):ct(e.compileModuleAsync(r))),ne(r=>{i&&i(n);let s,o,c=!1;return Array.isArray(r)?(o=r,c=!0):(s=r.create(t).injector,o=s.get(pd,[],{optional:!0,self:!0}).flat()),{routes:o.map(fd),injector:s}}))}function P0(n){return n&&typeof n=="object"&&"default"in n}function Uv(n){return P0(n)?n.default:n}var md=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:()=>U(D0),providedIn:"root"})}}return n})(),D0=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),N0=new J("");var k0=new J(""),x0=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ln,this.transitionAbortSubject=new ln,this.configLoader=U(S0),this.environmentInjector=U(sr),this.urlSerializer=U(ud),this.rootContexts=U(kc),this.location=U(ac),this.inputBindingEnabled=U(xc,{optional:!0})!==null,this.titleStrategy=U(Vv),this.options=U(dd,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=U(md),this.createViewTransition=U(N0,{optional:!0}),this.navigationErrorHandler=U(k0,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>W(void 0),this.rootComponentType=null;let t=r=>this.events.next(new Wh(r)),i=r=>this.events.next(new Gh(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(Oe(L(L({},this.transitions.value),t),{id:i}))}setupNavigations(t,i,r){return this.transitions=new It({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:oo,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vn(s=>s.id!==0),ne(s=>Oe(L({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),lt(s=>{let o=!1,c=!1;return W(s).pipe(lt(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",pt.SupersededByNewNavigation),Fn;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Oe(L({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&f!=="reload"){let p="";return this.events.next(new gi(l.id,this.urlSerializer.serialize(l.rawUrl),p,jh.IgnoredSameUrlNavigation)),l.resolve(!1),Fn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return W(l).pipe(lt(p=>{let g=this.transitions?.getValue();return this.events.next(new ho(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?Fn:Promise.resolve(p)}),I0(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Pe(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Oe(L({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new Ac(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:g,source:w,restoredState:S,extras:D}=l,P=new ho(p,this.urlSerializer.serialize(g),w,S);this.events.next(P);let V=Sv(this.rootComponentType).snapshot;return this.currentTransition=s=Oe(L({},l),{targetSnapshot:V,urlAfterRedirects:g,extras:Oe(L({},D),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,W(s)}else{let p="";return this.events.next(new gi(l.id,this.urlSerializer.serialize(l.extractedUrl),p,jh.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Fn}}),Pe(l=>{let u=new Bh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),ne(l=>(this.currentTransition=s=Oe(L({},l),{guards:jS(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),JS(this.environmentInjector,l=>this.events.next(l)),Pe(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Dc(this.urlSerializer,l.guardsResult);let u=new $h(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Vn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",pt.GuardRejected),!1)),Oh(l=>{if(l.guards.canActivateChecks.length)return W(l).pipe(Pe(u=>{let f=new zh(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}),lt(u=>{let f=!1;return W(u).pipe(w0(this.paramsInheritanceStrategy,this.environmentInjector),Pe({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(u,"",pt.NoDataFromResolver)}}))}),Pe(u=>{let f=new qh(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}))}),Oh(l=>{let u=f=>{let p=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(f.routeConfig).pipe(Pe(g=>{f.component=g}),ne(()=>{})));for(let g of f.children)p.push(...u(g));return p};return nr(u(l.targetSnapshot.root)).pipe(eh(null),Un(1))}),Oh(()=>this.afterPreactivation()),lt(()=>{let{currentSnapshot:l,targetSnapshot:u}=s,f=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return f?ct(f).pipe(ne(()=>s)):W(s)}),ne(l=>{let u=MS(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=Oe(L({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),Pe(()=>{this.events.next(new po)}),US(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Un(1),Pe({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new mi(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),Ga(this.transitionAbortSubject.pipe(Pe(l=>{throw l}))),rr(()=>{!o&&!c&&this.cancelNavigationTransition(s,"",pt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),ir(l=>{if(c=!0,kv(l))this.events.next(new fn(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),VS(l)?this.events.next(new Ir(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let u=new fo(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let f=Ot(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(f instanceof go){let{message:p,cancellationCode:g}=Dc(this.urlSerializer,f);this.events.next(new fn(s.id,this.urlSerializer.serialize(s.extractedUrl),p,g)),this.events.next(new Ir(f.redirectTo,f.navigationBehaviorOptions))}else{this.events.next(u);let p=t.errorHandler(l);s.resolve(!!p)}}catch(f){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(f)}}return Fn}))}))}cancelNavigationTransition(t,i,r){let s=new fn(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function O0(n){return n!==oo}var M0=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:()=>U(L0),providedIn:"root"})}}return n})(),ad=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},L0=(()=>{class n extends ad{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=rh(n)))(r||n)}})()}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),jv=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:()=>U(F0),providedIn:"root"})}}return n})(),F0=(()=>{class n extends jv{constructor(){super(...arguments),this.location=U(ac),this.urlSerializer=U(ud),this.options=U(dd,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=U(md),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new pn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Sv(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof ho)this.stateMemento=this.createStateMemento();else if(t instanceof gi)this.rawUrlTree=i.initialUrl;else if(t instanceof Ac){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??r,i)}}else t instanceof po?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof fn&&(t.code===pt.GuardRejected||t.code===pt.NoDataFromResolver)?this.restoreHistory(i):t instanceof fo?this.restoreHistory(i,!0):t instanceof mi&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){let r=t instanceof pn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){let s=this.browserPageId,o=L(L({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(r,"",o)}else{let s=L(L({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=rh(n)))(r||n)}})()}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ro=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(ro||{});function V0(n,e){n.events.pipe(Vn(t=>t instanceof mi||t instanceof fn||t instanceof fo||t instanceof gi),ne(t=>t instanceof mi||t instanceof gi?ro.COMPLETE:(t instanceof fn?t.code===pt.Redirect||t.code===pt.SupersededByNewNavigation:!1)?ro.REDIRECTING:ro.FAILED),Vn(t=>t!==ro.REDIRECTING),Un(1)).subscribe(()=>{e()})}function U0(n){throw n}var j0={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},B0={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Bv=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=U(rc),this.stateManager=U(jv),this.options=U(dd,{optional:!0})||{},this.pendingTasks=U(Ha),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=U(x0),this.urlSerializer=U(ud),this.location=U(ac),this.urlHandlingStrategy=U(md),this._events=new ln,this.errorHandler=this.options.errorHandler||U0,this.navigated=!1,this.routeReuseStrategy=U(M0),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=U(pd,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!U(xc,{optional:!0}),this.eventsSubscription=new ry,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof fn&&i.code!==pt.Redirect&&i.code!==pt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof mi)this.navigated=!0;else if(i instanceof Ir){let o=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l=L({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||O0(r.source)},o);this.scheduleNavigation(c,oo,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}z0(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),oo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=L({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(t);this.scheduleNavigation(c,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(fd),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:o,f=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":f=L(L({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let p;try{let g=r?r.snapshot:this.routerState.snapshot.root;p=Tv(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return bv(p,t,f,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=lo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,oo,null,i)}navigate(t,i={skipLocationChange:!1}){return $0(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=L({},j0):i===!1?r=L({},B0):r=i,lo(t))return rv(this.currentUrlTree,t,r);let s=this.parseUrl(t);return rv(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(s!=null&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let c,l,u;o?(c=o.resolve,l=o.reject,u=o.promise):u=new Promise((p,g)=>{c=p,l=g});let f=this.pendingTasks.add();return V0(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function $0(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Ee(4008,!1)}function z0(n){return!(n instanceof po)&&!(n instanceof Ir)}var q0=new J("");function $v(n,...e){return nt([{provide:pd,multi:!0,useValue:n},[],{provide:wr,useFactory:W0,deps:[Bv]},{provide:ph,multi:!0,useFactory:H0},e.map(t=>t.\u0275providers)])}function W0(n){return n.routerState.root}function G0(n,e){return{\u0275kind:n,\u0275providers:e}}function H0(){let n=U(Mt);return e=>{let t=n.get(sc);if(e!==t.components[0])return;let i=n.get(Bv),r=n.get(K0);n.get(Q0)===1&&i.initialNavigation(),n.get(Y0,null,nh.Optional)?.setUpPreloading(),n.get(q0,null,nh.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var K0=new J("",{factory:()=>new ln}),Q0=new J("",{providedIn:"root",factory:()=>1});var Y0=new J("");function zv(){return G0(8,[cv,{provide:xc,useExisting:cv}])}var qv=[];var gd=new J("basePath");var _d={apiRoot:"http://localhost:5000",firebaseConfig:{apiKey:"AIzaSyBj7JNt2Mv68ItGqnQXgK5I0RFvcklzteI",authDomain:"fir-demo-9327e.firebaseapp.com",projectId:"fir-demo-9327e",storageBucket:"fir-demo-9327e.firebasestorage.app",messagingSenderId:"560572989170",appId:"1:560572989170:web:476a7e61b14503a1c61a6b",measurementId:"G-MP9JS8CWPG"}};var X0=(()=>{class n extends dc{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(i){return new(i||n)(B(Te),B(Hs),B(hc))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();function Z0(){return new Oy}function eR(n,e,t){return new Ly(n,e,t)}var Gv=[{provide:hc,useFactory:Z0},{provide:dc,useClass:X0},{provide:ar,useFactory:eR,deps:[fr,dc,he]}],tR=[{provide:Hs,useFactory:()=>new My},{provide:or,useValue:"BrowserAnimations"},...Gv],ZF=[{provide:Hs,useClass:xy},{provide:or,useValue:"NoopAnimations"},...Gv];function Hv(){return qs("NgEagerAnimations"),[...tR]}var Kv="18.5.5",Qv="2024-11-16";var nR="@",iR=(()=>{class n{constructor(t,i,r,s,o){this.doc=t,this.delegate=i,this.zone=r,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=U(vy,{optional:!0}),this.loadingSchedulerFn=U(rR,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-BJ3ZVADW.js").then(r=>r),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(t):i=t(),i.catch(r=>{throw new Ee(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(t,i){let r=this.delegate.createRenderer(t,i);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let s=new yd(r);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(t,i);s.use(c),this.scheduler?.notify(10)}).catch(o=>{s.use(r)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(i){sh()}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),yd=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,i,r){this.delegate.insertBefore(e,t,i,r)}removeChild(e,t,i){this.delegate.removeChild(e,t,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){this.shouldReplay(t)&&this.replay.push(r=>r.setProperty(e,t,i)),this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.shouldReplay(t)&&this.replay.push(r=>r.listen(e,t,i)),this.delegate.listen(e,t,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(nR)}},rR=new J("");function Yv(n="animations"){return qs("NgAsyncAnimations"),nt([{provide:ar,useFactory:(e,t,i)=>new iR(e,t,i,n),deps:[Te,fr,he]},{provide:or,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var zd={};hC(zd,{FirebaseError:()=>st,SDK_VERSION:()=>_t,_DEFAULT_ENTRY_NAME:()=>Kt,_addComponent:()=>Pr,_addOrOverwriteComponent:()=>$d,_apps:()=>Kn,_clearComponents:()=>rP,_components:()=>Rr,_getProvider:()=>gn,_isFirebaseApp:()=>AI,_isFirebaseServerApp:()=>Qt,_registerComponent:()=>gt,_removeServiceInstance:()=>bI,_serverApps:()=>Sr,deleteApp:()=>Do,getApp:()=>_n,getApps:()=>Po,initializeApp:()=>Dr,initializeServerApp:()=>CI,onLog:()=>Gc,registerVersion:()=>ue,setLogLevel:()=>Hc});var Id={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var O=function(n,e){if(!n)throw yi(e)},yi=function(n){return new Error("Firebase Database ("+Id.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var Xv=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},sR=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],c=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Lc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,c=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,f=s>>2,p=(s&3)<<4|c>>4,g=(c&15)<<2|u>>6,w=u&63;l||(w=64,o||(g=64)),i.push(t[f],t[p],t[g],t[w])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xv(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):sR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;let u=r<n.length?t[n.charAt(r)]:64;++r;let p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||c==null||u==null||p==null)throw new wd;let g=s<<2|c>>4;if(i.push(g),u!==64){let w=c<<4&240|u>>2;if(i.push(w),p!==64){let S=u<<6&192|p;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},wd=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Td=function(n){let e=Xv(n);return Lc.encodeByteArray(e,!0)},Eo=function(n){return Td(n).replace(/\./g,"")},To=function(n){try{return Lc.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Zv(n){return Ar(void 0,n)}function Ar(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!oR(t)||(n[t]=Ar(n[t],e[t]));return n}function oR(n){return n!=="__proto__"}function bd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var aR=()=>bd().__FIREBASE_DEFAULTS__,cR=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&To(n[1]);return e&&JSON.parse(e)},Fc=()=>{try{return aR()||cR()||lR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ad=n=>{var e,t;return(t=(e=Fc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Vc=n=>{let e=Ad(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Cd=()=>{var n;return(n=Fc())===null||n===void 0?void 0:n.config},Sd=n=>{var e;return(e=Fc())===null||e===void 0?void 0:e[`_${n}`]};var _i=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};function Uc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Eo(JSON.stringify(t)),Eo(JSON.stringify(o)),""].join(".")}function Me(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bo(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Me())}function uR(){var n;let e=(n=Fc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eI(){return typeof window<"u"||Rd()}function Rd(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function tI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nI(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function jc(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iI(){let n=Me();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Gt(){return Id.NODE_CLIENT===!0||Id.NODE_ADMIN===!0}function rI(){return!uR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pd(){try{return typeof indexedDB=="object"}catch{return!1}}function sI(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var hR="FirebaseError",st=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=hR,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tt.prototype.create)}},Tt=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?dR(s,i):"Error",c=`${this.serviceName}: ${o} (${r}).`;return new st(r,c,i)}};function dR(n,e){return n.replace(fR,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var fR=/\{\$([^}]+)}/g;function br(n){return JSON.parse(n)}function Le(n){return JSON.stringify(n)}var oI=function(n){let e={},t={},i={},r="";try{let s=n.split(".");e=br(To(s[0])||""),t=br(To(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};var aI=function(n){let e=oI(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},cI=function(n){let e=oI(n).claims;return typeof e=="object"&&e.admin===!0};function mt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function vi(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Ao(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Co(n,e,t){let i={};for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function Ii(n,e){if(n===e)return!0;let t=Object.keys(n),i=Object.keys(e);for(let r of t){if(!i.includes(r))return!1;let s=n[r],o=e[r];if(Jv(s)&&Jv(o)){if(!Ii(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!t.includes(r))return!1;return!0}function Jv(n){return n!==null&&typeof n=="object"}function wi(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}var Mc=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let i=this.W_;if(typeof e=="string")for(let p=0;p<16;p++)i[p]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let p=0;p<16;p++)i[p]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let p=16;p<80;p++){let g=i[p-3]^i[p-8]^i[p-14]^i[p-16];i[p]=(g<<1|g>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],c=this.chain_[3],l=this.chain_[4],u,f;for(let p=0;p<80;p++){p<40?p<20?(u=c^s&(o^c),f=1518500249):(u=s^o^c,f=1859775393):p<60?(u=s&o|c&(s|o),f=2400959708):(u=s^o^c,f=3395469782);let g=(r<<5|r>>>27)+u+l+f+i[p]&4294967295;l=c,c=o,o=(s<<30|s>>>2)&4294967295,s=r,r=g}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let i=t-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function Bc(n,e){let t=new Ed(n,e);return t.subscribe.bind(t)}var Ed=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");pR(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=vd),r.error===void 0&&(r.error=vd),r.complete===void 0&&(r.complete=vd);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function pR(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vd(){}function lI(n,e){return`${n} failed: ${e} argument `}var uI=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,O(i<n.length,"Surrogate pair missing trail surrogate.");let o=n.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},So=function(n){let e=0;for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};var aV=4*60*60*1e3;function ke(n){return n&&n._delegate?n._delegate:n}var He=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ei="[DEFAULT]";var $c=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let i=new _i;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gR(e))try{this.getOrInitializeService({instanceIdentifier:Ei})}catch{}for(let[t,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ei){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return I(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ei){return this.instances.has(e)}getOptions(e=Ei){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);i===c&&o.resolve(r)}return r}onInit(e,t){var i;let r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let i=this.onInitCallbacks.get(t);if(i)for(let r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:mR(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ei){return this.component?this.component.multipleInstances?e:Ei:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function mR(n){return n===Ei?void 0:n}function gR(n){return n.instantiationMode==="EAGER"}var Cr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new $c(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Dd=[],X=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(X||{}),hI={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},_R=X.INFO,yR={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},vR=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=yR[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},bt=class{constructor(e){this.name=e,this._logLevel=_R,this._logHandler=vR,this._userLogHandler=null,Dd.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}};function dI(n){Dd.forEach(e=>{e.setLogLevel(n)})}function fI(n,e){for(let t of Dd){let i=null;e&&e.level&&(i=hI[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(r,s,...o)=>{let c=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(i??r.logLevel)&&n({level:X[s].toLowerCase(),message:c,args:o,type:r.name})}}}var IR=(n,e)=>e.some(t=>n instanceof t),pI,mI;function wR(){return pI||(pI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ER(){return mI||(mI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var gI=new WeakMap,kd=new WeakMap,_I=new WeakMap,Nd=new WeakMap,Od=new WeakMap;function TR(n){let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ht(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&gI.set(t,n)}).catch(()=>{}),Od.set(e,n),e}function bR(n){if(kd.has(n))return;let e=new Promise((t,i)=>{let r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});kd.set(n,e)}var xd={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return kd.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_I.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ht(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function yI(n){xd=n(xd)}function AR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let i=n.call(zc(this),e,...t);return _I.set(i,e.sort?e.sort():[e]),Ht(i)}:ER().includes(n)?function(...e){return n.apply(zc(this),e),Ht(gI.get(this))}:function(...e){return Ht(n.apply(zc(this),e))}}function CR(n){return typeof n=="function"?AR(n):(n instanceof IDBTransaction&&bR(n),IR(n,wR())?new Proxy(n,xd):n)}function Ht(n){if(n instanceof IDBRequest)return TR(n);if(Nd.has(n))return Nd.get(n);let e=CR(n);return e!==n&&(Nd.set(n,e),Od.set(e,n)),e}var zc=n=>Od.get(n);function II(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(n,e),c=Ht(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Ht(o.result),l.oldVersion,l.newVersion,Ht(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}var SR=["get","getKey","getAll","getAllKeys","count"],RR=["put","add","delete","clear"],Md=new Map;function vI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Md.get(e))return Md.get(e);let t=e.replace(/FromIndex$/,""),i=e!==t,r=RR.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||SR.includes(t)))return;let s=function(o,...c){return I(this,null,function*(){let l=this.transaction(o,r?"readwrite":"readonly"),u=l.store;return i&&(u=u.index(c.shift())),(yield Promise.all([u[t](...c),r&&l.done]))[0]})};return Md.set(e,s),s}yI(n=>Oe(L({},n),{get:(e,t,i)=>vI(e,t)||n.get(e,t,i),has:(e,t)=>!!vI(e,t)||n.has(e,t)}));var Fd=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(PR(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function PR(n){let e=n.getComponent();return e?.type==="VERSION"}var qc="@firebase/app",Vd="0.10.13";var mn=new bt("@firebase/app"),DR="@firebase/app-compat",NR="@firebase/analytics-compat",kR="@firebase/analytics",xR="@firebase/app-check-compat",OR="@firebase/app-check",MR="@firebase/auth",LR="@firebase/auth-compat",FR="@firebase/database",VR="@firebase/data-connect",UR="@firebase/database-compat",jR="@firebase/functions",BR="@firebase/functions-compat",$R="@firebase/installations",zR="@firebase/installations-compat",qR="@firebase/messaging",WR="@firebase/messaging-compat",GR="@firebase/performance",HR="@firebase/performance-compat",KR="@firebase/remote-config",QR="@firebase/remote-config-compat",YR="@firebase/storage",JR="@firebase/storage-compat",XR="@firebase/firestore",ZR="@firebase/vertexai-preview",eP="@firebase/firestore-compat",tP="firebase",nP="10.14.1";var Kt="[DEFAULT]",iP={[qc]:"fire-core",[DR]:"fire-core-compat",[kR]:"fire-analytics",[NR]:"fire-analytics-compat",[OR]:"fire-app-check",[xR]:"fire-app-check-compat",[MR]:"fire-auth",[LR]:"fire-auth-compat",[FR]:"fire-rtdb",[VR]:"fire-data-connect",[UR]:"fire-rtdb-compat",[jR]:"fire-fn",[BR]:"fire-fn-compat",[$R]:"fire-iid",[zR]:"fire-iid-compat",[qR]:"fire-fcm",[WR]:"fire-fcm-compat",[GR]:"fire-perf",[HR]:"fire-perf-compat",[KR]:"fire-rc",[QR]:"fire-rc-compat",[YR]:"fire-gcs",[JR]:"fire-gcs-compat",[XR]:"fire-fst",[eP]:"fire-fst-compat",[ZR]:"fire-vertex","fire-js":"fire-js",[tP]:"fire-js-all"};var Kn=new Map,Sr=new Map,Rr=new Map;function Pr(n,e){try{n.container.addComponent(e)}catch(t){mn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $d(n,e){n.container.addOrOverwriteComponent(e)}function gt(n){let e=n.name;if(Rr.has(e))return mn.debug(`There were multiple attempts to register component ${e}.`),!1;Rr.set(e,n);for(let t of Kn.values())Pr(t,n);for(let t of Sr.values())Pr(t,n);return!0}function gn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bI(n,e,t=Kt){gn(n,e).clearInstance(t)}function AI(n){return n.options!==void 0}function Qt(n){return n.settings!==void 0}function rP(){Rr.clear()}var sP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},At=new Tt("app","Firebase",sP);var Wc=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new He("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw At.create("app-deleted",{appName:this._name})}};var Ud=class extends Wc{constructor(e,t,i,r){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:i,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,r);else{let c=e;super(c.options,o,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ue(qc,Vd,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Do(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw At.create("server-app-deleted")}};var _t=nP;function Dr(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let i=Object.assign({name:Kt,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw At.create("bad-app-name",{appName:String(r)});if(t||(t=Cd()),!t)throw At.create("no-options");let s=Kn.get(r);if(s){if(Ii(t,s.options)&&Ii(i,s.config))return s;throw At.create("duplicate-app",{appName:r})}let o=new Cr(r);for(let l of Rr.values())o.addComponent(l);let c=new Wc(t,i,o);return Kn.set(r,c),c}function CI(n,e){if(eI()&&!Rd())throw At.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;AI(n)?t=n.options:t=n;let i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;let r=u=>[...u].reduce((f,p)=>Math.imul(31,f)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw At.create("finalization-registry-not-supported",{});let s=""+r(JSON.stringify(i)),o=Sr.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let c=new Cr(s);for(let u of Rr.values())c.addComponent(u);let l=new Ud(t,e,s,c);return Sr.set(s,l),l}function _n(n=Kt){let e=Kn.get(n);if(!e&&n===Kt&&Cd())return Dr();if(!e)throw At.create("no-app",{appName:n});return e}function Po(){return Array.from(Kn.values())}function Do(n){return I(this,null,function*(){let e=!1,t=n.name;Kn.has(t)?(e=!0,Kn.delete(t)):Sr.has(t)&&n.decRefCount()<=0&&(Sr.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)})}function ue(n,e,t){var i;let r=(i=iP[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${r}" with version "${e}":`];s&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mn.warn(c.join(" "));return}gt(new He(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function Gc(n,e){if(n!==null&&typeof n!="function")throw At.create("invalid-log-argument");fI(n,e)}function Hc(n){dI(n)}var oP="firebase-heartbeat-database",aP=1,Ro="firebase-heartbeat-store",Ld=null;function SI(){return Ld||(Ld=II(oP,aP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ro)}catch(t){console.warn(t)}}}}).catch(n=>{throw At.create("idb-open",{originalErrorMessage:n.message})})),Ld}function cP(n){return I(this,null,function*(){try{let t=(yield SI()).transaction(Ro),i=yield t.objectStore(Ro).get(RI(n));return yield t.done,i}catch(e){if(e instanceof st)mn.warn(e.message);else{let t=At.create("idb-get",{originalErrorMessage:e?.message});mn.warn(t.message)}}})}function wI(n,e){return I(this,null,function*(){try{let i=(yield SI()).transaction(Ro,"readwrite");yield i.objectStore(Ro).put(e,RI(n)),yield i.done}catch(t){if(t instanceof st)mn.warn(t.message);else{let i=At.create("idb-set",{originalErrorMessage:t?.message});mn.warn(i.message)}}})}function RI(n){return`${n.name}!${n.options.appId}`}var lP=1024,uP=30*24*60*60*1e3,jd=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Bd(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return I(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=EI();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let c=new Date(o.date).valueOf();return Date.now()-c<=uP}),this._storage.overwrite(this._heartbeatsCache))}catch(i){mn.warn(i)}})}getHeartbeatsHeader(){return I(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=EI(),{heartbeatsToSend:i,unsentEntries:r}=hP(this._heartbeatsCache.heartbeats),s=Eo(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return mn.warn(t),""}})}};function EI(){return new Date().toISOString().substring(0,10)}function hP(n,e=lP){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),TI(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),TI(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var Bd=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return I(this,null,function*(){return Pd()?sI().then(()=>!0).catch(()=>!1):!1})}read(){return I(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield cP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return I(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return wI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return I(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return wI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function TI(n){return Eo(JSON.stringify({version:2,heartbeats:n})).length}function dP(n){gt(new He("platform-logger",e=>new Fd(e),"PRIVATE")),gt(new He("heartbeat",e=>new jd(e),"PRIVATE")),ue(qc,Vd,n),ue(qc,Vd,"esm2017"),ue("fire-js","")}dP("");var fP="firebase",pP="10.14.1";ue(fP,pP,"app");var Ct=new Gs("ANGULARFIRE2_VERSION");function kr(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var bi=(n,e)=>{let t=e?[e]:Po(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},Qn=class{constructor(){return bi(mP)}},mP="app-check";function Nr(){}var Kc=class{zone;delegate;constructor(e,t=ay){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},qd=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nr,{},Nr,Nr)),t.pipe(Pe({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Yn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Kc(Zone.current)),this.insideAngular=t.run(()=>new Kc(Zone.current,oy)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(B(he))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Qc(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function gP(n){return Qc().ngZone.runOutsideAngular(()=>n())}function Ti(n){return Qc().ngZone.run(()=>n())}function _P(n){return yP(Qc())(n)}function yP(n){return function(t){return t=t.lift(new qd(n.ngZone)),t.pipe(Xu(n.outsideAngular),Ju(n.insideAngular))}}var vP=(n,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ti(()=>n.apply(void 0,i))},Yt=(n,e)=>function(){let t,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(t||=Ti(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nr,{},Nr,Nr))),i[s]=vP(i[s],t));let r=gP(()=>n.apply(this,i));if(!e)if(r instanceof Ln){let s=Qc();return r.pipe(Xu(s.outsideAngular),Ju(s.insideAngular))}else return Ti(()=>r);return r instanceof Ln?r.pipe(_P):r instanceof Promise?Ti(()=>new Promise((s,o)=>r.then(c=>Ti(()=>s(c)),c=>Ti(()=>o(c))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:Ti(()=>r)};var Ut=class{constructor(e){return e}},yn=class{constructor(){return Po()}};function IP(n){return n&&n.length===1?n[0]:new Ut(_n())}var Wd=new J("angularfire2._apps"),wP={provide:Ut,useFactory:IP,deps:[[new Ae,Wd]]},EP={provide:yn,deps:[[new Ae,Wd]]};function TP(n){return(e,t)=>{let i=t.get(ut);ue("angularfire",Ct.full,"core"),ue("angularfire",Ct.full,"app"),ue("angular",ic.full,i.toString());let r=e.runOutsideAngular(()=>n(t));return new Ut(r)}}function PI(n,...e){return nt([wP,EP,{provide:Wd,useFactory:TP(n),multi:!0,deps:[he,Mt,Yn,...e]}])}var DI=Yt(Dr,!0);function WI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var GI=WI,HI=new Tt("auth","Firebase",WI());var tl=new bt("@firebase/auth");function bP(n,...e){tl.logLevel<=X.WARN&&tl.warn(`Auth (${_t}): ${n}`,...e)}function Jc(n,...e){tl.logLevel<=X.ERROR&&tl.error(`Auth (${_t}): ${n}`,...e)}function Xn(n,...e){throw df(n,...e)}function Ci(n,...e){return df(n,...e)}function KI(n,e,t){let i=Object.assign(Object.assign({},GI()),{[e]:t});return new Tt("auth","Firebase",i).create(e,{appName:n.name})}function Ai(n){return KI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function df(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return HI.create(n,...e)}function H(n,e,...t){if(!n)throw df(e,...t)}function vn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Jc(e),new Error(e)}function Zn(n,e){n||vn(e)}function Qd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function AP(){return NI()==="http:"||NI()==="https:"}function NI(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function CP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AP()||nI()||"connection"in navigator)?navigator.onLine:!0}function SP(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Si=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zn(t>e,"Short delay should be less than long delay!"),this.isMobile=bo()||jc()}get(){return CP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function ff(n,e){Zn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var nl=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var RP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var PP=new Si(3e4,6e4);function pf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Or(s,o,c,l){return I(this,arguments,function*(n,e,t,i,r={}){return QI(n,r,()=>I(this,null,function*(){let u={},f={};i&&(e==="GET"?f=i:u={body:JSON.stringify(i)});let p=wi(Object.assign({key:n.config.apiKey},f)).slice(1),g=yield n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);let w=Object.assign({method:e,headers:g},u);return tI()||(w.referrerPolicy="no-referrer"),nl.fetch()(YI(n,n.config.apiHost,t,p),w)}))})}function QI(n,e,t){return I(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},RP),e);try{let r=new Yd(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Yc(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[l,u]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yc(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Yc(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Yc(n,"user-disabled",o);let f=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw KI(n,f,u);Xn(n,f)}}catch(r){if(r instanceof st)throw r;Xn(n,"network-request-failed",{message:String(r)})}})}function DP(s,o,c,l){return I(this,arguments,function*(n,e,t,i,r={}){let u=yield Or(n,e,t,i,r);return"mfaPendingCredential"in u&&Xn(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function YI(n,e,t,i){let r=`${e}${t}?${i}`;return n.config.emulator?ff(n.config,r):`${n.config.apiScheme}://${r}`}var Yd=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ci(this.auth,"network-request-failed")),PP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Yc(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=Ci(n,e,i);return r.customData._tokenResponse=t,r}function NP(n,e){return I(this,null,function*(){return Or(n,"POST","/v1/accounts:delete",e)})}function JI(n,e){return I(this,null,function*(){return Or(n,"POST","/v1/accounts:lookup",e)})}function No(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function mf(n,e=!1){return I(this,null,function*(){let t=ke(n),i=yield t.getIdToken(e),r=gf(i);H(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:No(Gd(r.auth_time)),issuedAtTime:No(Gd(r.iat)),expirationTime:No(Gd(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Gd(n){return Number(n)*1e3}function gf(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Jc("JWT malformed, contained fewer than 3 sections"),null;try{let r=To(t);return r?JSON.parse(r):(Jc("Failed to decode base64 JWT payload"),null)}catch(r){return Jc("Caught error parsing JWT payload as JSON",r?.toString()),null}}function kI(n){let e=gf(n);return H(e,"internal-error"),H(typeof e.exp<"u","internal-error"),H(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function xo(n,e,t=!1){return I(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof st&&kP(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function kP({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Jd=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>I(this,null,function*(){yield this.iteration()}),t)}iteration(){return I(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Oo=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=No(this.lastLoginAt),this.creationTime=No(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function il(n){return I(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield xo(n,JI(t,{idToken:i}));H(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?XI(s.providerUserInfo):[],c=xP(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!c?.length,f=l?u:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Oo(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,p)})}function _f(n){return I(this,null,function*(){let e=ke(n);yield il(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function xP(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function XI(n){return n.map(e=>{var{providerId:t}=e,i=Yu(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function OP(n,e){return I(this,null,function*(){let t=yield QI(n,{},()=>I(this,null,function*(){let i=wi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=YI(n,r,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",nl.fetch()(o,{method:"POST",headers:c,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function MP(n,e){return I(this,null,function*(){return Or(n,"POST","/v2/accounts:revokeToken",pf(n,e))})}var ko=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){H(e.idToken,"internal-error"),H(typeof e.idToken<"u","internal-error"),H(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):kI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){H(e.length!==0,"internal-error");let t=kI(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return I(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(H(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return I(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield OP(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new n;return i&&(H(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(H(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(H(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return vn("not implemented")}};function Jn(n,e){H(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var xr=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=Yu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Jd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Oo(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return I(this,null,function*(){let t=yield xo(this,this.stsTokenManager.getToken(this.auth,e));return H(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return mf(this,e)}reload(){return _f(this)}_assign(e){this!==e&&(H(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){H(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return I(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield il(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return I(this,null,function*(){if(Qt(this.auth.app))return Promise.reject(Ai(this.auth));let e=yield this.getIdToken();return yield xo(this,NP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,c,l,u,f;let p=(i=t.displayName)!==null&&i!==void 0?i:void 0,g=(r=t.email)!==null&&r!==void 0?r:void 0,w=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,S=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(c=t.tenantId)!==null&&c!==void 0?c:void 0,P=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,V=(u=t.createdAt)!==null&&u!==void 0?u:void 0,j=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:M,emailVerified:oe,isAnonymous:ve,providerData:ee,stsTokenManager:T}=t;H(M&&T,e,"internal-error");let _=ko.fromJSON(this.name,T);H(typeof M=="string",e,"internal-error"),Jn(p,e.name),Jn(g,e.name),H(typeof oe=="boolean",e,"internal-error"),H(typeof ve=="boolean",e,"internal-error"),Jn(w,e.name),Jn(S,e.name),Jn(D,e.name),Jn(P,e.name),Jn(V,e.name),Jn(j,e.name);let v=new n({uid:M,auth:e,email:g,emailVerified:oe,displayName:p,isAnonymous:ve,photoURL:S,phoneNumber:w,tenantId:D,stsTokenManager:_,createdAt:V,lastLoginAt:j});return ee&&Array.isArray(ee)&&(v.providerData=ee.map(E=>Object.assign({},E))),P&&(v._redirectEventId=P),v}static _fromIdTokenResponse(e,t,i=!1){return I(this,null,function*(){let r=new ko;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield il(s),s})}static _fromGetAccountInfoResponse(e,t,i){return I(this,null,function*(){let r=t.users[0];H(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?XI(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,c=new ko;c.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Oo(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,u),l})}};var xI=new Map;function In(n){Zn(n instanceof Function,"Expected a class definition");let e=xI.get(n);return e?(Zn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xI.set(n,e),e)}var LP=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return I(this,null,function*(){return!0})}_set(t,i){return I(this,null,function*(){this.storage[t]=i})}_get(t){return I(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return I(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),Xd=LP;function Xc(n,e,t){return`firebase:${n}:${e}:${t}`}var rl=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=Xc(this.userKey,r.apiKey,s),this.fullPersistenceKey=Xc("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return I(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?xr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return I(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return I(this,null,function*(){if(!t.length)return new n(In(Xd),e,i);let r=(yield Promise.all(t.map(u=>I(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=r[0]||In(Xd),o=Xc(i,e.config.apiKey,e.name),c=null;for(let u of t)try{let f=yield u._get(o);if(f){let p=xr._fromJSON(e,f);u!==s&&(c=p),s=u;break}}catch{}let l=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,i):(s=l[0],c&&(yield s._set(o,c.toJSON())),yield Promise.all(t.map(u=>I(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,i))})}};function OI(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rw(e))return"Blackberry";if(sw(e))return"Webos";if(ew(e))return"Safari";if((e.includes("chrome/")||tw(e))&&!e.includes("edge/"))return"Chrome";if(iw(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function ZI(n=Me()){return/firefox\//i.test(n)}function ew(n=Me()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tw(n=Me()){return/crios\//i.test(n)}function nw(n=Me()){return/iemobile/i.test(n)}function iw(n=Me()){return/android/i.test(n)}function rw(n=Me()){return/blackberry/i.test(n)}function sw(n=Me()){return/webos/i.test(n)}function yf(n=Me()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function FP(n=Me()){var e;return yf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VP(){return iI()&&document.documentMode===10}function ow(n=Me()){return yf(n)||iw(n)||sw(n)||rw(n)||/windows phone/i.test(n)||nw(n)}function aw(n,e=[]){let t;switch(n){case"Browser":t=OI(Me());break;case"Worker":t=`${OI(Me())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_t}/${i}`}var Zd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((o,c)=>{try{let l=e(s);o(l)}catch(l){c(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return I(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function UP(t){return I(this,arguments,function*(n,e={}){return Or(n,"GET","/v2/passwordPolicy",pf(n,e))})}var jP=6,ef=class{constructor(e){var t,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:jP,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var tf=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sl(this),this.idTokenSubscription=new sl(this),this.beforeStateQueue=new Zd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=HI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=In(t)),this._initializationPromise=this.queue(()=>I(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield rl.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return I(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return I(this,null,function*(){try{let t=yield JI(this,{idToken:e}),i=yield xr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return I(this,null,function*(){var t;if(Qt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=r?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===c)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return H(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return I(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return I(this,null,function*(){try{yield il(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=SP()}_delete(){return I(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return I(this,null,function*(){if(Qt(this.app))return Promise.reject(Ai(this));let t=e?ke(e):null;return t&&H(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return I(this,null,function*(){if(!this._deleted)return e&&H(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>I(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return I(this,null,function*(){return Qt(this.app)?Promise.reject(Ai(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Qt(this.app)?Promise.reject(Ai(this)):this.queue(()=>I(this,null,function*(){yield this.assertedPersistence.setPersistence(In(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return I(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return I(this,null,function*(){let e=yield UP(this),t=new ef(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Tt("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return I(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield MP(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return I(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return I(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&In(e)||this._popupRedirectResolver;H(t,this,"argument-error"),this.redirectPersistenceManager=yield rl.create(this,[In(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return I(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>I(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return I(this,null,function*(){if(e===this.currentUser)return this.queue(()=>I(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(H(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{let l=e.addObserver(t);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return I(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return H(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return I(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return I(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&bP(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function vf(n){return ke(n)}var sl=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Bc(t=>this.observer=t)}get next(){return H(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var If={loadJS(){return I(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BP(n){If=n}function $P(n){return If.loadJS(n)}function zP(){return If.gapiScript}function cw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function wf(n,e){let t=gn(n,"auth");if(t.isInitialized()){let r=t.getImmediate(),s=t.getOptions();if(Ii(s,e??{}))return r;Xn(r,"already-initialized")}return t.initialize({options:e})}function qP(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(In);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function Ef(n,e,t){let i=vf(n);H(i._canInitEmulator,i,"emulator-config-failed"),H(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!t?.disableWarnings,s=lw(e),{host:o,port:c}=WP(e),l=c===null?"":`:${c}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||GP()}function lw(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function WP(n){let e=lw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:MI(i.substr(s.length+1))}}else{let[s,o]=i.split(":");return{host:s,port:MI(o)}}}function MI(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function GP(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ol=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return vn("not implemented")}_getIdTokenResponse(e){return vn("not implemented")}_linkToIdToken(e,t){return vn("not implemented")}_getReauthenticationResolver(e){return vn("not implemented")}};function Hd(n,e){return I(this,null,function*(){return DP(n,"POST","/v1/accounts:signInWithIdp",pf(n,e))})}var al=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var nf=class extends al{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Mo=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return I(this,null,function*(){let s=yield xr._fromIdTokenResponse(e,i,r),o=LI(i);return new n({user:s,providerId:o,_tokenResponse:i,operationType:t})})}static _forOperation(e,t,i){return I(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=LI(i);return new n({user:e,providerId:r,_tokenResponse:i,operationType:t})})}};function LI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var rf=class n extends st{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new n(e,t,i,r)}};function uw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?rf._fromErrorAndOperation(n,s,e,i):s})}function HP(n,e,t=!1){return I(this,null,function*(){let i=yield xo(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Mo._forOperation(n,"link",i)})}function KP(n,e,t=!1){return I(this,null,function*(){let{auth:i}=n;if(Qt(i.app))return Promise.reject(Ai(i));let r="reauthenticate";try{let s=yield xo(n,uw(i,r,e,n),t);H(s.idToken,i,"internal-error");let o=gf(s.idToken);H(o,i,"internal-error");let{sub:c}=o;return H(n.uid===c,i,"user-mismatch"),Mo._forOperation(n,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&Xn(i,"user-mismatch"),s}})}function QP(n,e,t=!1){return I(this,null,function*(){if(Qt(n.app))return Promise.reject(Ai(n));let i="signIn",r=yield uw(n,i,e),s=yield Mo._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})}function Tf(n,e,t,i){return ke(n).onIdTokenChanged(e,t,i)}function bf(n,e,t){return ke(n).beforeAuthStateChanged(e,t)}var cl="__sak";var ll=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cl,"1"),this.storage.removeItem(cl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var YP=1e3,JP=10,XP=(()=>{class n extends ll{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ow(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key){this.forAllChangedKeys((c,l,u)=>{this.notifyListeners(c,u)});return}let r=t.key;i?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(r);!i&&this.localCache[r]===c||this.notifyListeners(r,c)},o=this.storage.getItem(r);VP()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,JP):s()}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},YP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,i){return I(this,null,function*(){yield Mn(n.prototype,this,"_set").call(this,t,i),this.localCache[t]=JSON.stringify(i)})}_get(t){return I(this,null,function*(){let i=yield Mn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(i),i})}_remove(t){return I(this,null,function*(){yield Mn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),hw=XP;var ZP=(()=>{class n extends ll{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})(),Af=ZP;function eD(n){return Promise.all(n.map(e=>I(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var tD=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;let r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){return I(this,null,function*(){let i=t,{eventId:r,eventType:s,data:o}=i.data,c=this.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let l=Array.from(c).map(f=>I(this,null,function*(){return f(i.origin,o)})),u=yield eD(l);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})})}_subscribe(t,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function dw(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}var sf=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){return I(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((c,l)=>{let u=dw("",20);r.port1.start();let f=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(p){let g=p;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(g.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Jt(){return window}function nD(n){Jt().location.href=n}function fw(){return typeof Jt().WorkerGlobalScope<"u"&&typeof Jt().importScripts=="function"}function iD(){return I(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function rD(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function sD(){return fw()?self:null}var pw="firebaseLocalStorageDb",oD=1,ul="firebaseLocalStorage",mw="fbase_key",Ri=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function dl(n,e){return n.transaction([ul],e?"readwrite":"readonly").objectStore(ul)}function aD(){let n=indexedDB.deleteDatabase(pw);return new Ri(n).toPromise()}function of(){let n=indexedDB.open(pw,oD);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let i=n.result;try{i.createObjectStore(ul,{keyPath:mw})}catch(r){t(r)}}),n.addEventListener("success",()=>I(this,null,function*(){let i=n.result;i.objectStoreNames.contains(ul)?e(i):(i.close(),yield aD(),e(yield of()))}))})}function FI(n,e,t){return I(this,null,function*(){let i=dl(n,!0).put({[mw]:e,value:t});return new Ri(i).toPromise()})}function cD(n,e){return I(this,null,function*(){let t=dl(n,!1).get(e),i=yield new Ri(t).toPromise();return i===void 0?null:i.value})}function VI(n,e){let t=dl(n,!0).delete(e);return new Ri(t).toPromise()}var lD=800,uD=3,hD=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return I(this,null,function*(){return this.db?this.db:(this.db=yield of(),this.db)})}_withRetries(t){return I(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield t(r)}catch(r){if(i++>uD)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return I(this,null,function*(){return fw()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return I(this,null,function*(){this.receiver=tD._getInstance(sD()),this.receiver._subscribe("keyChanged",(t,i)=>I(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(t,i)=>I(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return I(this,null,function*(){var t,i;if(this.activeServiceWorker=yield iD(),!this.activeServiceWorker)return;this.sender=new sf(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((t=r[0])===null||t===void 0)&&t.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return I(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||rD()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return I(this,null,function*(){try{if(!indexedDB)return!1;let t=yield of();return yield FI(t,cl,"1"),yield VI(t,cl),!0}catch{}return!1})}_withPendingWrite(t){return I(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,i){return I(this,null,function*(){return this._withPendingWrite(()=>I(this,null,function*(){return yield this._withRetries(r=>FI(r,t,i)),this.localCache[t]=i,this.notifyServiceWorker(t)}))})}_get(t){return I(this,null,function*(){let i=yield this._withRetries(r=>cD(r,t));return this.localCache[t]=i,i})}_remove(t){return I(this,null,function*(){return this._withPendingWrite(()=>I(this,null,function*(){return yield this._withRetries(i=>VI(i,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return I(this,null,function*(){let t=yield this._withRetries(s=>{let o=dl(s,!1).getAll();return new Ri(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(t,i){this.localCache[t]=i;let r=this.listeners[t];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>I(this,null,function*(){return this._poll()}),lD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),gw=hD;var HV=cw("rcb"),KV=new Si(3e4,6e4);function dD(n,e){return e?In(e):(H(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Lo=class extends ol{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hd(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function fD(n){return QP(n.auth,new Lo(n),n.bypassAuthState)}function pD(n){let{auth:e,user:t}=n;return H(t,e,"internal-error"),KP(t,new Lo(n),n.bypassAuthState)}function mD(n){return I(this,null,function*(){let{auth:e,user:t}=n;return H(t,e,"internal-error"),HP(t,new Lo(n),n.bypassAuthState)})}var af=class{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>I(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return I(this,null,function*(){let{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fD;case"linkViaPopup":case"linkViaRedirect":return mD;case"reauthViaPopup":case"reauthViaRedirect":return pD;default:Xn(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var QV=new Si(2e3,1e4);var gD="pendingRedirect",Zc=new Map,cf=class n extends af{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){return I(this,null,function*(){let e=Zc.get(this.auth._key());if(!e){try{let i=(yield _D(this.resolver,this.auth))?yield Mn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Zc.set(this.auth._key(),e)}return this.bypassAuthState||Zc.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return I(this,null,function*(){if(e.type==="signInViaRedirect")return Mn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Mn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return I(this,null,function*(){})}cleanUp(){}};function _D(n,e){return I(this,null,function*(){let t=ID(e),i=vD(n);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(t))==="true";return yield i._remove(t),r})}function yD(n,e){Zc.set(n._key(),e)}function vD(n){return In(n._redirectPersistence)}function ID(n){return Xc(gD,n.config.apiKey,n.name)}function wD(n,e,t=!1){return I(this,null,function*(){if(Qt(n.app))return Promise.reject(Ai(n));let i=vf(n),r=dD(i,e),o=yield new cf(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield i._persistUserIfCurrent(o.user),yield i._setRedirectUser(null,e)),o})}var ED=10*60*1e3,lf=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!_w(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Ci(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ED&&this.cachedEventUids.clear(),this.cachedEventUids.has(UI(e))}saveEventToCache(e){this.cachedEventUids.add(UI(e)),this.lastProcessedEventTime=Date.now()}};function UI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _w({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function TD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _w(n);default:return!1}}function bD(t){return I(this,arguments,function*(n,e={}){return Or(n,"GET","/v1/projects",e)})}var AD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CD=/^https?/;function SD(n){return I(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield bD(n);for(let t of e)try{if(RD(t))return}catch{}Xn(n,"unauthorized-domain")})}function RD(n){let e=Qd(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!CD.test(t))return!1;if(AD.test(n))return i===n;let r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var PD=new Si(3e4,6e4);function jI(){let n=Jt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function DD(n){return new Promise((e,t)=>{var i,r,s;function o(){jI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jI(),t(Ci(n,"network-request-failed"))},timeout:PD.get()})}if(!((r=(i=Jt().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Jt().gapi)===null||s===void 0)&&s.load)o();else{let c=cw("iframefcb");return Jt()[c]=()=>{gapi.load?o():t(Ci(n,"network-request-failed"))},$P(`${zP()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw el=null,e})}var el=null;function ND(n){return el=el||DD(n),el}var kD=new Si(5e3,15e3),xD="__/auth/iframe",OD="emulator/auth/iframe",MD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function FD(n){let e=n.config;H(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?ff(e,OD):`https://${n.config.authDomain}/${xD}`,i={apiKey:e.apiKey,appName:n.name,v:_t},r=LD.get(n.config.apiHost);r&&(i.eid=r);let s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${wi(i).slice(1)}`}function VD(n){return I(this,null,function*(){let e=yield ND(n),t=Jt().gapi;return H(t,n,"internal-error"),e.open({where:document.body,url:FD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MD,dontclear:!0},i=>new Promise((r,s)=>I(this,null,function*(){yield i.restyle({setHideOnLeave:!1});let o=Ci(n,"network-request-failed"),c=Jt().setTimeout(()=>{s(o)},kD.get());function l(){Jt().clearTimeout(c),r(i)}i.ping(l).then(l,()=>{s(o)})})))})}var UD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jD=500,BD=600,$D="_blank",zD="http://localhost",hl=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function qD(n,e,t,i=jD,r=BD){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString(),c="",l=Object.assign(Object.assign({},UD),{width:i.toString(),height:r.toString(),top:s,left:o}),u=Me().toLowerCase();t&&(c=tw(u)?$D:t),ZI(u)&&(e=e||zD,l.scrollbars="yes");let f=Object.entries(l).reduce((g,[w,S])=>`${g}${w}=${S},`,"");if(FP(u)&&c!=="_self")return WD(e||"",c),new hl(null);let p=window.open(e||"",c,f);H(p,n,"popup-blocked");try{p.focus()}catch{}return new hl(p)}function WD(n,e){let t=document.createElement("a");t.href=n,t.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}var GD="__/auth/handler",HD="emulator/auth/handler",KD=encodeURIComponent("fac");function BI(n,e,t,i,r,s){return I(this,null,function*(){H(n.config.authDomain,n,"auth-domain-config-required"),H(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:_t,eventId:r};if(e instanceof al){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Ao(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,p]of Object.entries(s||{}))o[f]=p}if(e instanceof nf){let f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let l=yield n._getAppCheckToken(),u=l?`#${KD}=${encodeURIComponent(l)}`:"";return`${QD(n)}?${wi(c).slice(1)}${u}`})}function QD({config:n}){return n.emulator?ff(n,HD):`https://${n.authDomain}/${GD}`}var Kd="webStorageSupport",uf=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Af,this._completeRedirectFn=wD,this._overrideRedirectResult=yD}_openPopup(e,t,i,r){return I(this,null,function*(){var s;Zn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield BI(e,t,i,Qd(),r);return qD(e,o,dw())})}_openRedirect(e,t,i,r){return I(this,null,function*(){yield this._originValidation(e);let s=yield BI(e,t,i,Qd(),r);return nD(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Zn(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){return I(this,null,function*(){let t=yield VD(e),i=new lf(e);return t.register("authEvent",r=>(H(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kd,{type:Kd},r=>{var s;let o=(s=r?.[0])===null||s===void 0?void 0:s[Kd];o!==void 0&&t(!!o),Xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=SD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ow()||ew()||yf()}},yw=uf;var $I="@firebase/auth",zI="1.7.9";var hf=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return I(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){H(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function YD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JD(n){gt(new He("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=i.options;H(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aw(n)},u=new tf(i,r,s,l);return qP(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),gt(new He("auth-internal",e=>{let t=vf(e.getProvider("auth").getImmediate());return(i=>new hf(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ue($I,zI,YD(n)),ue($I,zI,"esm2017")}var XD=5*60,ZD=Sd("authIdTokenMaxAge")||XD,qI=null,eN=n=>e=>I(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>ZD)return;let r=t?.token;qI!==r&&(qI=r,yield fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function Cf(n=_n()){let e=gn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=wf(n,{popupRedirectResolver:yw,persistence:[gw,hw,Af]}),i=Sd("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(i,location.origin);if(location.origin===s.origin){let o=eN(s.toString());bf(t,o,()=>o(t.currentUser)),Tf(t,c=>o(c))}}let r=Ad("auth");return r&&Ef(t,`http://${r}`),t}function tN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}BP({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=Ci("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",tN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JD("Browser");var vw="auth",Fo=class{constructor(e){return e}},Pi=class{constructor(){return bi(vw)}};var Sf=new J("angularfire2.auth-instances");function QN(n,e){let t=kr(vw,n,e);return t&&new Fo(t)}function YN(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Fo(i)}}var JN={provide:Pi,deps:[[new Ae,Sf]]},XN={provide:Fo,useFactory:QN,deps:[[new Ae,Sf],Ut]};function Iw(n,...e){return ue("angularfire",Ct.full,"auth"),nt([XN,JN,{provide:Sf,useFactory:YN(n),multi:!0,deps:[he,Mt,Yn,yn,[new Ae,Qn],...e]}])}var ww=Yt(Cf,!0);var Ew=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Tw={};var ei,Rf;(function(){var n;function e(T,_){function v(){}v.prototype=_.prototype,T.D=_.prototype,T.prototype=new v,T.prototype.constructor=T,T.C=function(E,b,C){for(var y=Array(arguments.length-2),on=2;on<arguments.length;on++)y[on-2]=arguments[on];return _.prototype[b].apply(E,y)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(T,_,v){v||(v=0);var E=Array(16);if(typeof _=="string")for(var b=0;16>b;++b)E[b]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(b=0;16>b;++b)E[b]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=T.g[0],v=T.g[1],b=T.g[2];var C=T.g[3],y=_+(C^v&(b^C))+E[0]+3614090360&4294967295;_=v+(y<<7&4294967295|y>>>25),y=C+(b^_&(v^b))+E[1]+3905402710&4294967295,C=_+(y<<12&4294967295|y>>>20),y=b+(v^C&(_^v))+E[2]+606105819&4294967295,b=C+(y<<17&4294967295|y>>>15),y=v+(_^b&(C^_))+E[3]+3250441966&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(C^v&(b^C))+E[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(b^_&(v^b))+E[5]+1200080426&4294967295,C=_+(y<<12&4294967295|y>>>20),y=b+(v^C&(_^v))+E[6]+2821735955&4294967295,b=C+(y<<17&4294967295|y>>>15),y=v+(_^b&(C^_))+E[7]+4249261313&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(C^v&(b^C))+E[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(b^_&(v^b))+E[9]+2336552879&4294967295,C=_+(y<<12&4294967295|y>>>20),y=b+(v^C&(_^v))+E[10]+4294925233&4294967295,b=C+(y<<17&4294967295|y>>>15),y=v+(_^b&(C^_))+E[11]+2304563134&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(C^v&(b^C))+E[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=C+(b^_&(v^b))+E[13]+4254626195&4294967295,C=_+(y<<12&4294967295|y>>>20),y=b+(v^C&(_^v))+E[14]+2792965006&4294967295,b=C+(y<<17&4294967295|y>>>15),y=v+(_^b&(C^_))+E[15]+1236535329&4294967295,v=b+(y<<22&4294967295|y>>>10),y=_+(b^C&(v^b))+E[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^b&(_^v))+E[6]+3225465664&4294967295,C=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(C^_))+E[11]+643717713&4294967295,b=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(b^C))+E[0]+3921069994&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^C&(v^b))+E[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^b&(_^v))+E[10]+38016083&4294967295,C=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(C^_))+E[15]+3634488961&4294967295,b=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(b^C))+E[4]+3889429448&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^C&(v^b))+E[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^b&(_^v))+E[14]+3275163606&4294967295,C=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(C^_))+E[3]+4107603335&4294967295,b=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(b^C))+E[8]+1163531501&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(b^C&(v^b))+E[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=C+(v^b&(_^v))+E[2]+4243563512&4294967295,C=_+(y<<9&4294967295|y>>>23),y=b+(_^v&(C^_))+E[7]+1735328473&4294967295,b=C+(y<<14&4294967295|y>>>18),y=v+(C^_&(b^C))+E[12]+2368359562&4294967295,v=b+(y<<20&4294967295|y>>>12),y=_+(v^b^C)+E[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^b)+E[8]+2272392833&4294967295,C=_+(y<<11&4294967295|y>>>21),y=b+(C^_^v)+E[11]+1839030562&4294967295,b=C+(y<<16&4294967295|y>>>16),y=v+(b^C^_)+E[14]+4259657740&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^C)+E[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^b)+E[4]+1272893353&4294967295,C=_+(y<<11&4294967295|y>>>21),y=b+(C^_^v)+E[7]+4139469664&4294967295,b=C+(y<<16&4294967295|y>>>16),y=v+(b^C^_)+E[10]+3200236656&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^C)+E[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^b)+E[0]+3936430074&4294967295,C=_+(y<<11&4294967295|y>>>21),y=b+(C^_^v)+E[3]+3572445317&4294967295,b=C+(y<<16&4294967295|y>>>16),y=v+(b^C^_)+E[6]+76029189&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(v^b^C)+E[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=C+(_^v^b)+E[12]+3873151461&4294967295,C=_+(y<<11&4294967295|y>>>21),y=b+(C^_^v)+E[15]+530742520&4294967295,b=C+(y<<16&4294967295|y>>>16),y=v+(b^C^_)+E[2]+3299628645&4294967295,v=b+(y<<23&4294967295|y>>>9),y=_+(b^(v|~C))+E[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~b))+E[7]+1126891415&4294967295,C=_+(y<<10&4294967295|y>>>22),y=b+(_^(C|~v))+E[14]+2878612391&4294967295,b=C+(y<<15&4294967295|y>>>17),y=v+(C^(b|~_))+E[5]+4237533241&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~C))+E[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~b))+E[3]+2399980690&4294967295,C=_+(y<<10&4294967295|y>>>22),y=b+(_^(C|~v))+E[10]+4293915773&4294967295,b=C+(y<<15&4294967295|y>>>17),y=v+(C^(b|~_))+E[1]+2240044497&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~C))+E[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~b))+E[15]+4264355552&4294967295,C=_+(y<<10&4294967295|y>>>22),y=b+(_^(C|~v))+E[6]+2734768916&4294967295,b=C+(y<<15&4294967295|y>>>17),y=v+(C^(b|~_))+E[13]+1309151649&4294967295,v=b+(y<<21&4294967295|y>>>11),y=_+(b^(v|~C))+E[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=C+(v^(_|~b))+E[11]+3174756917&4294967295,C=_+(y<<10&4294967295|y>>>22),y=b+(_^(C|~v))+E[2]+718787259&4294967295,b=C+(y<<15&4294967295|y>>>17),y=v+(C^(b|~_))+E[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(b+(y<<21&4294967295|y>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+C&4294967295}i.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var v=_-this.blockSize,E=this.B,b=this.h,C=0;C<_;){if(b==0)for(;C<=v;)r(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<_;)if(E[b++]=T.charCodeAt(C++),b==this.blockSize){r(this,E),b=0;break}}else for(;C<_;)if(E[b++]=T[C++],b==this.blockSize){r(this,E),b=0;break}}this.h=b,this.o+=_},i.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var v=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=v&255,v/=256;for(this.u(T),T=Array(16),_=v=0;4>_;++_)for(var E=0;32>E;E+=8)T[v++]=this.g[_]>>>E&255;return T};function s(T,_){var v=c;return Object.prototype.hasOwnProperty.call(v,T)?v[T]:v[T]=_(T)}function o(T,_){this.h=_;for(var v=[],E=!0,b=T.length-1;0<=b;b--){var C=T[b]|0;E&&C==_||(v[b]=C,E=!1)}this.g=v}var c={};function l(T){return-128<=T&&128>T?s(T,function(_){return new o([_|0],0>_?-1:0)}):new o([T|0],0>T?-1:0)}function u(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return P(u(-T));for(var _=[],v=1,E=0;T>=v;E++)_[E]=T/v|0,v*=4294967296;return new o(_,0)}function f(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(f(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=u(Math.pow(_,8)),E=p,b=0;b<T.length;b+=8){var C=Math.min(8,T.length-b),y=parseInt(T.substring(b,b+C),_);8>C?(C=u(Math.pow(_,C)),E=E.j(C).add(u(y))):(E=E.j(v),E=E.add(u(y)))}return E}var p=l(0),g=l(1),w=l(16777216);n=o.prototype,n.m=function(){if(D(this))return-P(this).m();for(var T=0,_=1,v=0;v<this.g.length;v++){var E=this.i(v);T+=(0<=E?E:4294967296+E)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(D(this))return"-"+P(this).toString(T);for(var _=u(Math.pow(T,6)),v=this,E="";;){var b=oe(v,_).g;v=V(v,b.j(_));var C=((0<v.g.length?v.g[0]:v.h)>>>0).toString(T);if(v=b,S(v))return C+E;for(;6>C.length;)C="0"+C;E=C+E}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function D(T){return T.h==-1}n.l=function(T){return T=V(this,T),D(T)?-1:S(T)?0:1};function P(T){for(var _=T.g.length,v=[],E=0;E<_;E++)v[E]=~T.g[E];return new o(v,~T.h).add(g)}n.abs=function(){return D(this)?P(this):this},n.add=function(T){for(var _=Math.max(this.g.length,T.g.length),v=[],E=0,b=0;b<=_;b++){var C=E+(this.i(b)&65535)+(T.i(b)&65535),y=(C>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);E=y>>>16,C&=65535,y&=65535,v[b]=y<<16|C}return new o(v,v[v.length-1]&-2147483648?-1:0)};function V(T,_){return T.add(P(_))}n.j=function(T){if(S(this)||S(T))return p;if(D(this))return D(T)?P(this).j(P(T)):P(P(this).j(T));if(D(T))return P(this.j(P(T)));if(0>this.l(w)&&0>T.l(w))return u(this.m()*T.m());for(var _=this.g.length+T.g.length,v=[],E=0;E<2*_;E++)v[E]=0;for(E=0;E<this.g.length;E++)for(var b=0;b<T.g.length;b++){var C=this.i(E)>>>16,y=this.i(E)&65535,on=T.i(b)>>>16,Is=T.i(b)&65535;v[2*E+2*b]+=y*Is,j(v,2*E+2*b),v[2*E+2*b+1]+=C*Is,j(v,2*E+2*b+1),v[2*E+2*b+1]+=y*on,j(v,2*E+2*b+1),v[2*E+2*b+2]+=C*on,j(v,2*E+2*b+2)}for(E=0;E<_;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=_;E<2*_;E++)v[E]=0;return new o(v,0)};function j(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function M(T,_){this.g=T,this.h=_}function oe(T,_){if(S(_))throw Error("division by zero");if(S(T))return new M(p,p);if(D(T))return _=oe(P(T),_),new M(P(_.g),P(_.h));if(D(_))return _=oe(T,P(_)),new M(P(_.g),_.h);if(30<T.g.length){if(D(T)||D(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,E=_;0>=E.l(T);)v=ve(v),E=ve(E);var b=ee(v,1),C=ee(E,1);for(E=ee(E,2),v=ee(v,2);!S(E);){var y=C.add(E);0>=y.l(T)&&(b=b.add(v),C=y),E=ee(E,1),v=ee(v,1)}return _=V(T,b.j(_)),new M(b,_)}for(b=p;0<=T.l(_);){for(v=Math.max(1,Math.floor(T.m()/_.m())),E=Math.ceil(Math.log(v)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),C=u(v),y=C.j(_);D(y)||0<y.l(T);)v-=E,C=u(v),y=C.j(_);S(C)&&(C=g),b=b.add(C),T=V(T,y)}return new M(b,T)}n.A=function(T){return oe(this,T).h},n.and=function(T){for(var _=Math.max(this.g.length,T.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)&T.i(E);return new o(v,this.h&T.h)},n.or=function(T){for(var _=Math.max(this.g.length,T.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)|T.i(E);return new o(v,this.h|T.h)},n.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),v=[],E=0;E<_;E++)v[E]=this.i(E)^T.i(E);return new o(v,this.h^T.h)};function ve(T){for(var _=T.g.length+1,v=[],E=0;E<_;E++)v[E]=T.i(E)<<1|T.i(E-1)>>>31;return new o(v,T.h)}function ee(T,_){var v=_>>5;_%=32;for(var E=T.g.length-v,b=[],C=0;C<E;C++)b[C]=0<_?T.i(C+v)>>>_|T.i(C+v+1)<<32-_:T.i(C+v);return new o(b,T.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Rf=Tw.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=f,ei=Tw.Integer=o}).apply(typeof Ew<"u"?Ew:typeof self<"u"?self:typeof window<"u"?window:{});var fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wn={};var Pf,ZN,Mr,Df,Vo,pl,Nf,kf,xf;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof fl=="object"&&fl];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var i=t(this);function r(a,h){if(h)e:{var d=i;a=a.split(".");for(var m=0;m<a.length-1;m++){var A=a[m];if(!(A in d))break e;d=d[A]}a=a[a.length-1],m=d[a],h=h(m),h!=m&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,m=!1,A={next:function(){if(!m&&d<a.length){var R=d++;return{value:h(R,a[R]),done:!1}}return m=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}r("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},c=this||self;function l(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,m),a.apply(h,A)}}return function(){return a.apply(h,arguments)}}function g(a,h,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,g.apply(null,arguments)}function w(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function S(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(m,A,R){for(var x=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)x[pe-2]=arguments[pe];return h.prototype[A].apply(m,x)}}function D(a){let h=a.length;if(0<h){let d=Array(h);for(let m=0;m<h;m++)d[m]=a[m];return d}return[]}function P(a,h){for(let d=1;d<arguments.length;d++){let m=arguments[d];if(l(m)){let A=a.length||0,R=m.length||0;a.length=A+R;for(let x=0;x<R;x++)a[A+x]=m[x]}else a.push(m)}}class V{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function j(a){return/^[\s\xa0]*$/.test(a)}function M(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function oe(a){return oe[" "](a),a}oe[" "]=function(){};var ve=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function ee(a,h,d){for(let m in a)h.call(d,a[m],m,a)}function T(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function _(a){let h={};for(let d in a)h[d]=a[d];return h}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(a,h){let d,m;for(let A=1;A<arguments.length;A++){m=arguments[A];for(d in m)a[d]=m[d];for(let R=0;R<v.length;R++)d=v[R],Object.prototype.hasOwnProperty.call(m,d)&&(a[d]=m[d])}}function b(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function C(a){c.setTimeout(()=>{throw a},0)}function y(){var a=Tu;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class on{constructor(){this.h=this.g=null}add(h,d){let m=Is.get();m.set(h,d),this.h?this.h.next=m:this.g=m,this.h=m}}var Is=new V(()=>new NA,a=>a.reset());class NA{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let ws,Es=!1,Tu=new on,i_=()=>{let a=c.Promise.resolve(void 0);ws=()=>{a.then(kA)}};var kA=()=>{for(var a;a=y();){try{a.h.call(a.g)}catch(d){C(d)}var h=Is;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}Es=!1};function Nn(){this.s=this.s,this.C=this.C}Nn.prototype.s=!1,Nn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Nn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ze(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}ze.prototype.h=function(){this.defaultPrevented=!0};var xA=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};c.addEventListener("test",d,h),c.removeEventListener("test",d,h)}catch{}return a}();function Ts(a,h){if(ze.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(ve){e:{try{oe(h.nodeName);var A=!0;break e}catch{}A=!1}A||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:OA[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Ts.aa.h.call(this)}}S(Ts,ze);var OA={2:"touch",3:"pen",4:"mouse"};Ts.prototype.h=function(){Ts.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var bs="closure_listenable_"+(1e6*Math.random()|0),MA=0;function LA(a,h,d,m,A){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!m,this.ha=A,this.key=++MA,this.da=this.fa=!1}function Sa(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Ra(a){this.src=a,this.g={},this.h=0}Ra.prototype.add=function(a,h,d,m,A){var R=a.toString();a=this.g[R],a||(a=this.g[R]=[],this.h++);var x=Au(a,h,m,A);return-1<x?(h=a[x],d||(h.fa=!1)):(h=new LA(h,this.src,R,!!m,A),h.fa=d,a.push(h)),h};function bu(a,h){var d=h.type;if(d in a.g){var m=a.g[d],A=Array.prototype.indexOf.call(m,h,void 0),R;(R=0<=A)&&Array.prototype.splice.call(m,A,1),R&&(Sa(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Au(a,h,d,m){for(var A=0;A<a.length;++A){var R=a[A];if(!R.da&&R.listener==h&&R.capture==!!d&&R.ha==m)return A}return-1}var Cu="closure_lm_"+(1e6*Math.random()|0),Su={};function r_(a,h,d,m,A){if(m&&m.once)return o_(a,h,d,m,A);if(Array.isArray(h)){for(var R=0;R<h.length;R++)r_(a,h[R],d,m,A);return null}return d=Nu(d),a&&a[bs]?a.K(h,d,u(m)?!!m.capture:!!m,A):s_(a,h,d,!1,m,A)}function s_(a,h,d,m,A,R){if(!h)throw Error("Invalid event type");var x=u(A)?!!A.capture:!!A,pe=Pu(a);if(pe||(a[Cu]=pe=new Ra(a)),d=pe.add(h,d,m,x,R),d.proxy)return d;if(m=FA(),d.proxy=m,m.src=a,m.listener=d,a.addEventListener)xA||(A=x),A===void 0&&(A=!1),a.addEventListener(h.toString(),m,A);else if(a.attachEvent)a.attachEvent(c_(h.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function FA(){function a(d){return h.call(a.src,a.listener,d)}let h=VA;return a}function o_(a,h,d,m,A){if(Array.isArray(h)){for(var R=0;R<h.length;R++)o_(a,h[R],d,m,A);return null}return d=Nu(d),a&&a[bs]?a.L(h,d,u(m)?!!m.capture:!!m,A):s_(a,h,d,!0,m,A)}function a_(a,h,d,m,A){if(Array.isArray(h))for(var R=0;R<h.length;R++)a_(a,h[R],d,m,A);else m=u(m)?!!m.capture:!!m,d=Nu(d),a&&a[bs]?(a=a.i,h=String(h).toString(),h in a.g&&(R=a.g[h],d=Au(R,d,m,A),-1<d&&(Sa(R[d]),Array.prototype.splice.call(R,d,1),R.length==0&&(delete a.g[h],a.h--)))):a&&(a=Pu(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Au(h,d,m,A)),(d=-1<a?h[a]:null)&&Ru(d))}function Ru(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[bs])bu(h.i,a);else{var d=a.type,m=a.proxy;h.removeEventListener?h.removeEventListener(d,m,a.capture):h.detachEvent?h.detachEvent(c_(d),m):h.addListener&&h.removeListener&&h.removeListener(m),(d=Pu(h))?(bu(d,a),d.h==0&&(d.src=null,h[Cu]=null)):Sa(a)}}}function c_(a){return a in Su?Su[a]:Su[a]="on"+a}function VA(a,h){if(a.da)a=!0;else{h=new Ts(h,this);var d=a.listener,m=a.ha||a.src;a.fa&&Ru(a),a=d.call(m,h)}return a}function Pu(a){return a=a[Cu],a instanceof Ra?a:null}var Du="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nu(a){return typeof a=="function"?a:(a[Du]||(a[Du]=function(h){return a.handleEvent(h)}),a[Du])}function qe(){Nn.call(this),this.i=new Ra(this),this.M=this,this.F=null}S(qe,Nn),qe.prototype[bs]=!0,qe.prototype.removeEventListener=function(a,h,d,m){a_(this,a,h,d,m)};function et(a,h){var d,m=a.F;if(m)for(d=[];m;m=m.F)d.push(m);if(a=a.M,m=h.type||h,typeof h=="string")h=new ze(h,a);else if(h instanceof ze)h.target=h.target||a;else{var A=h;h=new ze(m,a),E(h,A)}if(A=!0,d)for(var R=d.length-1;0<=R;R--){var x=h.g=d[R];A=Pa(x,m,!0,h)&&A}if(x=h.g=a,A=Pa(x,m,!0,h)&&A,A=Pa(x,m,!1,h)&&A,d)for(R=0;R<d.length;R++)x=h.g=d[R],A=Pa(x,m,!1,h)&&A}qe.prototype.N=function(){if(qe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],m=0;m<d.length;m++)Sa(d[m]);delete a.g[h],a.h--}}this.F=null},qe.prototype.K=function(a,h,d,m){return this.i.add(String(a),h,!1,d,m)},qe.prototype.L=function(a,h,d,m){return this.i.add(String(a),h,!0,d,m)};function Pa(a,h,d,m){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var A=!0,R=0;R<h.length;++R){var x=h[R];if(x&&!x.da&&x.capture==d){var pe=x.listener,Ue=x.ha||x.src;x.fa&&bu(a.i,x),A=pe.call(Ue,m)!==!1&&A}}return A&&!m.defaultPrevented}function l_(a,h,d){if(typeof a=="function")d&&(a=g(a,d));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(a,h||0)}function u_(a){a.g=l_(()=>{a.g=null,a.i&&(a.i=!1,u_(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class UA extends Nn{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:u_(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function As(a){Nn.call(this),this.h=a,this.g={}}S(As,Nn);var h_=[];function d_(a){ee(a.g,function(h,d){this.g.hasOwnProperty(d)&&Ru(h)},a),a.g={}}As.prototype.N=function(){As.aa.N.call(this),d_(this)},As.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ku=c.JSON.stringify,jA=c.JSON.parse,BA=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function xu(){}xu.prototype.h=null;function f_(a){return a.h||(a.h=a.i())}function p_(){}var Cs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ou(){ze.call(this,"d")}S(Ou,ze);function Mu(){ze.call(this,"c")}S(Mu,ze);var oi={},m_=null;function Da(){return m_=m_||new qe}oi.La="serverreachability";function g_(a){ze.call(this,oi.La,a)}S(g_,ze);function Ss(a){let h=Da();et(h,new g_(h))}oi.STAT_EVENT="statevent";function __(a,h){ze.call(this,oi.STAT_EVENT,a),this.stat=h}S(__,ze);function tt(a){let h=Da();et(h,new __(h,a))}oi.Ma="timingevent";function y_(a,h){ze.call(this,oi.Ma,a),this.size=h}S(y_,ze);function Rs(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},h)}function Ps(){this.g=!0}Ps.prototype.xa=function(){this.g=!1};function $A(a,h,d,m,A,R){a.info(function(){if(a.g)if(R)for(var x="",pe=R.split("&"),Ue=0;Ue<pe.length;Ue++){var ae=pe[Ue].split("=");if(1<ae.length){var We=ae[0];ae=ae[1];var Ge=We.split("_");x=2<=Ge.length&&Ge[1]=="type"?x+(We+"="+ae+"&"):x+(We+"=redacted&")}}else x=null;else x=R;return"XMLHTTP REQ ("+m+") [attempt "+A+"]: "+h+`
`+d+`
`+x})}function zA(a,h,d,m,A,R,x){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+A+"]: "+h+`
`+d+`
`+R+" "+x})}function Xi(a,h,d,m){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+WA(a,d)+(m?" "+m:"")})}function qA(a,h){a.info(function(){return"TIMEOUT: "+h})}Ps.prototype.info=function(){};function WA(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var m=d[a];if(!(2>m.length)){var A=m[1];if(Array.isArray(A)&&!(1>A.length)){var R=A[0];if(R!="noop"&&R!="stop"&&R!="close")for(var x=1;x<A.length;x++)A[x]=""}}}}return ku(d)}catch{return h}}var Na={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},v_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lu;function ka(){}S(ka,xu),ka.prototype.g=function(){return new XMLHttpRequest},ka.prototype.i=function(){return{}},Lu=new ka;function kn(a,h,d,m){this.j=a,this.i=h,this.l=d,this.R=m||1,this.U=new As(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new I_}function I_(){this.i=null,this.g="",this.h=!1}var w_={},Fu={};function Vu(a,h,d){a.L=1,a.v=La(an(h)),a.m=d,a.P=!0,E_(a,null)}function E_(a,h){a.F=Date.now(),xa(a),a.A=an(a.v);var d=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),L_(d.i,"t",m),a.C=0,d=a.j.J,a.h=new I_,a.g=ey(a.j,d?h:null,!a.m),0<a.O&&(a.M=new UA(g(a.Y,a,a.g),a.O)),h=a.U,d=a.g,m=a.ca;var A="readystatechange";Array.isArray(A)||(A&&(h_[0]=A.toString()),A=h_);for(var R=0;R<A.length;R++){var x=r_(d,A[R],m||h.handleEvent,!1,h.h||h);if(!x)break;h.g[x.key]=x}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),Ss(),$A(a.i,a.u,a.A,a.l,a.R,a.m)}kn.prototype.ca=function(a){a=a.target;let h=this.M;h&&cn(a)==3?h.j():this.Y(a)},kn.prototype.Y=function(a){try{if(a==this.g)e:{let Ge=cn(this.g);var h=this.g.Ba();let tr=this.g.Z();if(!(3>Ge)&&(Ge!=3||this.g&&(this.h.h||this.g.oa()||z_(this.g)))){this.J||Ge!=4||h==7||(h==8||0>=tr?Ss(3):Ss(2)),Uu(this);var d=this.g.Z();this.X=d;t:if(T_(this)){var m=z_(this.g);a="";var A=m.length,R=cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ai(this),Ds(this);var x="";break t}this.h.i=new c.TextDecoder}for(h=0;h<A;h++)this.h.h=!0,a+=this.h.i.decode(m[h],{stream:!(R&&h==A-1)});m.length=0,this.h.g+=a,this.C=0,x=this.h.g}else x=this.g.oa();if(this.o=d==200,zA(this.i,this.u,this.A,this.l,this.R,Ge,d),this.o){if(this.T&&!this.K){t:{if(this.g){var pe,Ue=this.g;if((pe=Ue.g?Ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(pe)){var ae=pe;break t}}ae=null}if(d=ae)Xi(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ju(this,d);else{this.o=!1,this.s=3,tt(12),ai(this),Ds(this);break e}}if(this.P){d=!0;let xt;for(;!this.J&&this.C<x.length;)if(xt=GA(this,x),xt==Fu){Ge==4&&(this.s=4,tt(14),d=!1),Xi(this.i,this.l,null,"[Incomplete Response]");break}else if(xt==w_){this.s=4,tt(15),Xi(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Xi(this.i,this.l,xt,null),ju(this,xt);if(T_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ge!=4||x.length!=0||this.h.h||(this.s=1,tt(16),d=!1),this.o=this.o&&d,!d)Xi(this.i,this.l,x,"[Invalid Chunked Response]"),ai(this),Ds(this);else if(0<x.length&&!this.W){this.W=!0;var We=this.j;We.g==this&&We.ba&&!We.M&&(We.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Gu(We),We.M=!0,tt(11))}}else Xi(this.i,this.l,x,null),ju(this,x);Ge==4&&ai(this),this.o&&!this.J&&(Ge==4?Y_(this.j,this):(this.o=!1,xa(this)))}else lC(this.g),d==400&&0<x.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),ai(this),Ds(this)}}}catch{}finally{}};function T_(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function GA(a,h){var d=a.C,m=h.indexOf(`
`,d);return m==-1?Fu:(d=Number(h.substring(d,m)),isNaN(d)?w_:(m+=1,m+d>h.length?Fu:(h=h.slice(m,m+d),a.C=m+d,h)))}kn.prototype.cancel=function(){this.J=!0,ai(this)};function xa(a){a.S=Date.now()+a.I,b_(a,a.I)}function b_(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Rs(g(a.ba,a),h)}function Uu(a){a.B&&(c.clearTimeout(a.B),a.B=null)}kn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(qA(this.i,this.A),this.L!=2&&(Ss(),tt(17)),ai(this),this.s=2,Ds(this)):b_(this,this.S-a)};function Ds(a){a.j.G==0||a.J||Y_(a.j,a)}function ai(a){Uu(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,d_(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function ju(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Bu(d.h,a))){if(!a.K&&Bu(d.h,a)&&d.G==3){try{var m=d.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var A=m;if(A[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Ba(d),Ua(d);else break e;Wu(d),tt(18)}}else d.za=A[1],0<d.za-d.T&&37500>A[2]&&d.F&&d.v==0&&!d.C&&(d.C=Rs(g(d.Za,d),6e3));if(1>=S_(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else li(d,11)}else if((a.K||d.g==a)&&Ba(d),!j(h))for(A=d.Da.g.parse(h),h=0;h<A.length;h++){let ae=A[h];if(d.T=ae[0],ae=ae[1],d.G==2)if(ae[0]=="c"){d.K=ae[1],d.ia=ae[2];let We=ae[3];We!=null&&(d.la=We,d.j.info("VER="+d.la));let Ge=ae[4];Ge!=null&&(d.Aa=Ge,d.j.info("SVER="+d.Aa));let tr=ae[5];tr!=null&&typeof tr=="number"&&0<tr&&(m=1.5*tr,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;let xt=a.g;if(xt){let za=xt.g?xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(za){var R=m.h;R.g||za.indexOf("spdy")==-1&&za.indexOf("quic")==-1&&za.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&($u(R,R.h),R.h=null))}if(m.D){let Hu=xt.g?xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Hu&&(m.ya=Hu,ge(m.I,m.D,Hu))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var x=a;if(m.qa=Z_(m,m.J?m.ia:null,m.W),x.K){R_(m.h,x);var pe=x,Ue=m.L;Ue&&(pe.I=Ue),pe.B&&(Uu(pe),xa(pe)),m.g=x}else K_(m);0<d.i.length&&ja(d)}else ae[0]!="stop"&&ae[0]!="close"||li(d,7);else d.G==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?li(d,7):qu(d):ae[0]!="noop"&&d.l&&d.l.ta(ae),d.v=0)}}Ss(4)}catch{}}var HA=class{constructor(a,h){this.g=a,this.map=h}};function A_(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function C_(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function S_(a){return a.h?1:a.g?a.g.size:0}function Bu(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function $u(a,h){a.g?a.g.add(h):a.h=h}function R_(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}A_.prototype.cancel=function(){if(this.i=P_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function P_(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return D(a.i)}function KA(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var h=[],d=a.length,m=0;m<d;m++)h.push(a[m]);return h}h=[],d=0;for(m in a)h[d++]=a[m];return h}function QA(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let m in a)h[d++]=m;return h}}}function D_(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=QA(a),m=KA(a),A=m.length,R=0;R<A;R++)h.call(void 0,m[R],d&&d[R],a)}var N_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function YA(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var m=a[d].indexOf("="),A=null;if(0<=m){var R=a[d].substring(0,m);A=a[d].substring(m+1)}else R=a[d];h(R,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function ci(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof ci){this.h=a.h,Oa(this,a.j),this.o=a.o,this.g=a.g,Ma(this,a.s),this.l=a.l;var h=a.i,d=new xs;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),k_(this,d),this.m=a.m}else a&&(h=String(a).match(N_))?(this.h=!1,Oa(this,h[1]||"",!0),this.o=Ns(h[2]||""),this.g=Ns(h[3]||"",!0),Ma(this,h[4]),this.l=Ns(h[5]||"",!0),k_(this,h[6]||"",!0),this.m=Ns(h[7]||"")):(this.h=!1,this.i=new xs(null,this.h))}ci.prototype.toString=function(){var a=[],h=this.j;h&&a.push(ks(h,x_,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(ks(h,x_,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(ks(d,d.charAt(0)=="/"?ZA:XA,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",ks(d,tC)),a.join("")};function an(a){return new ci(a)}function Oa(a,h,d){a.j=d?Ns(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Ma(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function k_(a,h,d){h instanceof xs?(a.i=h,nC(a.i,a.h)):(d||(h=ks(h,eC)),a.i=new xs(h,a.h))}function ge(a,h,d){a.i.set(h,d)}function La(a){return ge(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ns(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ks(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,JA),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function JA(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var x_=/[#\/\?@]/g,XA=/[#\?:]/g,ZA=/[#\?]/g,eC=/[#\?@]/g,tC=/#/g;function xs(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function xn(a){a.g||(a.g=new Map,a.h=0,a.i&&YA(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}n=xs.prototype,n.add=function(a,h){xn(this),this.i=null,a=Zi(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function O_(a,h){xn(a),h=Zi(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function M_(a,h){return xn(a),h=Zi(a,h),a.g.has(h)}n.forEach=function(a,h){xn(this),this.g.forEach(function(d,m){d.forEach(function(A){a.call(h,A,m,this)},this)},this)},n.na=function(){xn(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let m=0;m<h.length;m++){let A=a[m];for(let R=0;R<A.length;R++)d.push(h[m])}return d},n.V=function(a){xn(this);let h=[];if(typeof a=="string")M_(this,a)&&(h=h.concat(this.g.get(Zi(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},n.set=function(a,h){return xn(this),this.i=null,a=Zi(this,a),M_(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function L_(a,h,d){O_(a,h),0<d.length&&(a.i=null,a.g.set(Zi(a,h),D(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var m=h[d];let R=encodeURIComponent(String(m)),x=this.V(m);for(m=0;m<x.length;m++){var A=R;x[m]!==""&&(A+="="+encodeURIComponent(String(x[m]))),a.push(A)}}return this.i=a.join("&")};function Zi(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function nC(a,h){h&&!a.j&&(xn(a),a.i=null,a.g.forEach(function(d,m){var A=m.toLowerCase();m!=A&&(O_(this,m),L_(this,A,d))},a)),a.j=h}function iC(a,h){let d=new Ps;if(c.Image){let m=new Image;m.onload=w(On,d,"TestLoadImage: loaded",!0,h,m),m.onerror=w(On,d,"TestLoadImage: error",!1,h,m),m.onabort=w(On,d,"TestLoadImage: abort",!1,h,m),m.ontimeout=w(On,d,"TestLoadImage: timeout",!1,h,m),c.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else h(!1)}function rC(a,h){let d=new Ps,m=new AbortController,A=setTimeout(()=>{m.abort(),On(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:m.signal}).then(R=>{clearTimeout(A),R.ok?On(d,"TestPingServer: ok",!0,h):On(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(A),On(d,"TestPingServer: error",!1,h)})}function On(a,h,d,m,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),m(d)}catch{}}function sC(){this.g=new BA}function oC(a,h,d){let m=d||"";try{D_(a,function(A,R){let x=A;u(A)&&(x=ku(A)),h.push(m+R+"="+encodeURIComponent(x))})}catch(A){throw h.push(m+"type="+encodeURIComponent("_badmap")),A}}function Os(a){this.l=a.Ub||null,this.j=a.eb||!1}S(Os,xu),Os.prototype.g=function(){return new Fa(this.l,this.j)},Os.prototype.i=function(a){return function(){return a}}({});function Fa(a,h){qe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Fa,qe),n=Fa.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Ls(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ms(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ls(this)),this.g&&(this.readyState=3,Ls(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;F_(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function F_(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Ms(this):Ls(this),this.readyState==3&&F_(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Ms(this))},n.Qa=function(a){this.g&&(this.response=a,Ms(this))},n.ga=function(){this.g&&Ms(this)};function Ms(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ls(a)}n.setRequestHeader=function(a,h){this.u.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function Ls(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Fa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function V_(a){let h="";return ee(a,function(d,m){h+=m,h+=":",h+=d,h+=`\r
`}),h}function zu(a,h,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=V_(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):ge(a,h,d))}function we(a){qe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(we,qe);var aC=/^https?$/i,cC=["POST","PUT"];n=we.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,h,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lu.g(),this.v=this.o?f_(this.o):f_(Lu),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(R){U_(this,R);return}if(a=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var A in m)d.set(A,m[A]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let R of m.keys())d.set(R,m.get(R));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(R=>R.toLowerCase()=="content-type"),A=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(cC,h,void 0))||m||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[R,x]of d)this.g.setRequestHeader(R,x);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$_(this),this.u=!0,this.g.send(a),this.u=!1}catch(R){U_(this,R)}};function U_(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,j_(a),Va(a)}function j_(a){a.A||(a.A=!0,et(a,"complete"),et(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,et(this,"complete"),et(this,"abort"),Va(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Va(this,!0)),we.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?B_(this):this.bb())},n.bb=function(){B_(this)};function B_(a){if(a.h&&typeof o<"u"&&(!a.v[1]||cn(a)!=4||a.Z()!=2)){if(a.u&&cn(a)==4)l_(a.Ea,0,a);else if(et(a,"readystatechange"),cn(a)==4){a.h=!1;try{let x=a.Z();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var m;if(m=x===0){var A=String(a.D).match(N_)[1]||null;!A&&c.self&&c.self.location&&(A=c.self.location.protocol.slice(0,-1)),m=!aC.test(A?A.toLowerCase():"")}d=m}if(d)et(a,"complete"),et(a,"success");else{a.m=6;try{var R=2<cn(a)?a.g.statusText:""}catch{R=""}a.l=R+" ["+a.Z()+"]",j_(a)}}finally{Va(a)}}}}function Va(a,h){if(a.g){$_(a);let d=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||et(a,"ready");try{d.onreadystatechange=m}catch{}}}function $_(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function cn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<cn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),jA(h)}};function z_(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function lC(a){let h={};a=(a.g&&2<=cn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(j(a[m]))continue;var d=b(a[m]);let A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let R=h[A]||[];h[A]=R,R.push(d)}T(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fs(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function q_(a){this.Aa=0,this.i=[],this.j=new Ps,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fs("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fs("baseRetryDelayMs",5e3,a),this.cb=Fs("retryDelaySeedMs",1e4,a),this.Wa=Fs("forwardChannelMaxRetries",2,a),this.wa=Fs("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new A_(a&&a.concurrentRequestLimit),this.Da=new sC,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=q_.prototype,n.la=8,n.G=1,n.connect=function(a,h,d,m){tt(0),this.W=a,this.H=h||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=Z_(this,null,this.W),ja(this)};function qu(a){if(W_(a),a.G==3){var h=a.U++,d=an(a.I);if(ge(d,"SID",a.K),ge(d,"RID",h),ge(d,"TYPE","terminate"),Vs(a,d),h=new kn(a,a.j,h),h.L=2,h.v=La(an(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=h.v,d=!0),d||(h.g=ey(h.j,null),h.g.ea(h.v)),h.F=Date.now(),xa(h)}X_(a)}function Ua(a){a.g&&(Gu(a),a.g.cancel(),a.g=null)}function W_(a){Ua(a),a.u&&(c.clearTimeout(a.u),a.u=null),Ba(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function ja(a){if(!C_(a.h)&&!a.s){a.s=!0;var h=a.Ga;ws||i_(),Es||(ws(),Es=!0),Tu.add(h,a),a.B=0}}function uC(a,h){return S_(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Rs(g(a.Ga,a,h),J_(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let A=new kn(this,this.j,a),R=this.o;if(this.S&&(R?(R=_(R),E(R,this.S)):R=this.S),this.m!==null||this.O||(A.H=R,R=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=H_(this,A,h),d=an(this.I),ge(d,"RID",a),ge(d,"CVER",22),this.D&&ge(d,"X-HTTP-Session-Id",this.D),Vs(this,d),R&&(this.O?h="headers="+encodeURIComponent(String(V_(R)))+"&"+h:this.m&&zu(d,this.m,R)),$u(this.h,A),this.Ua&&ge(d,"TYPE","init"),this.P?(ge(d,"$req",h),ge(d,"SID","null"),A.T=!0,Vu(A,d,null)):Vu(A,d,h),this.G=2}}else this.G==3&&(a?G_(this,a):this.i.length==0||C_(this.h)||G_(this))};function G_(a,h){var d;h?d=h.l:d=a.U++;let m=an(a.I);ge(m,"SID",a.K),ge(m,"RID",d),ge(m,"AID",a.T),Vs(a,m),a.m&&a.o&&zu(m,a.m,a.o),d=new kn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=H_(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),$u(a.h,d),Vu(d,m,h)}function Vs(a,h){a.H&&ee(a.H,function(d,m){ge(h,m,d)}),a.l&&D_({},function(d,m){ge(h,m,d)})}function H_(a,h,d){d=Math.min(a.i.length,d);var m=a.l?g(a.l.Na,a.l,a):null;e:{var A=a.i;let R=-1;for(;;){let x=["count="+d];R==-1?0<d?(R=A[0].g,x.push("ofs="+R)):R=0:x.push("ofs="+R);let pe=!0;for(let Ue=0;Ue<d;Ue++){let ae=A[Ue].g,We=A[Ue].map;if(ae-=R,0>ae)R=Math.max(0,A[Ue].g-100),pe=!1;else try{oC(We,x,"req"+ae+"_")}catch{m&&m(We)}}if(pe){m=x.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,m}function K_(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;ws||i_(),Es||(ws(),Es=!0),Tu.add(h,a),a.v=0}}function Wu(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Rs(g(a.Fa,a),J_(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Q_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Rs(g(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),Ua(this),Q_(this))};function Gu(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Q_(a){a.g=new kn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=an(a.qa);ge(h,"RID","rpc"),ge(h,"SID",a.K),ge(h,"AID",a.T),ge(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&ge(h,"TO",a.ja),ge(h,"TYPE","xmlhttp"),Vs(a,h),a.m&&a.o&&zu(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=La(an(h)),d.m=null,d.P=!0,E_(d,a)}n.Za=function(){this.C!=null&&(this.C=null,Ua(this),Wu(this),tt(19))};function Ba(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Y_(a,h){var d=null;if(a.g==h){Ba(a),Gu(a),a.g=null;var m=2}else if(Bu(a.h,h))d=h.D,R_(a.h,h),m=1;else return;if(a.G!=0){if(h.o)if(m==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var A=a.B;m=Da(),et(m,new y_(m,d)),ja(a)}else K_(a);else if(A=h.s,A==3||A==0&&0<h.X||!(m==1&&uC(a,h)||m==2&&Wu(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),A){case 1:li(a,5);break;case 4:li(a,10);break;case 3:li(a,6);break;default:li(a,2)}}}function J_(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function li(a,h){if(a.j.info("Error code "+h),h==2){var d=g(a.fb,a),m=a.Xa;let A=!m;m=new ci(m||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Oa(m,"https"),La(m),A?iC(m.toString(),d):rC(m.toString(),d)}else tt(2);a.G=0,a.l&&a.l.sa(h),X_(a),W_(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function X_(a){if(a.G=0,a.ka=[],a.l){let h=P_(a.h);(h.length!=0||a.i.length!=0)&&(P(a.ka,h),P(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function Z_(a,h,d){var m=d instanceof ci?an(d):new ci(d);if(m.g!="")h&&(m.g=h+"."+m.g),Ma(m,m.s);else{var A=c.location;m=A.protocol,h=h?h+"."+A.hostname:A.hostname,A=+A.port;var R=new ci(null);m&&Oa(R,m),h&&(R.g=h),A&&Ma(R,A),d&&(R.l=d),m=R}return d=a.D,h=a.ya,d&&h&&ge(m,d,h),ge(m,"VER",a.la),Vs(a,m),m}function ey(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new we(new Os({eb:d})):new we(a.pa),h.Ha(a.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ty(){}n=ty.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function $a(){}$a.prototype.g=function(a,h){return new at(a,h)};function at(a,h){qe.call(this),this.g=new q_(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!j(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!j(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new er(this)}S(at,qe),at.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},at.prototype.close=function(){qu(this.g)},at.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=ku(a),a=d);h.i.push(new HA(h.Ya++,a)),h.G==3&&ja(h)},at.prototype.N=function(){this.g.l=null,delete this.j,qu(this.g),delete this.g,at.aa.N.call(this)};function ny(a){Ou.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}S(ny,Ou);function iy(){Mu.call(this),this.status=1}S(iy,Mu);function er(a){this.g=a}S(er,ty),er.prototype.ua=function(){et(this.g,"a")},er.prototype.ta=function(a){et(this.g,new ny(a))},er.prototype.sa=function(a){et(this.g,new iy)},er.prototype.ra=function(){et(this.g,"b")},$a.prototype.createWebChannel=$a.prototype.g,at.prototype.send=at.prototype.o,at.prototype.open=at.prototype.m,at.prototype.close=at.prototype.close,xf=wn.createWebChannelTransport=function(){return new $a},kf=wn.getStatEventTarget=function(){return Da()},Nf=wn.Event=oi,pl=wn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Na.NO_ERROR=0,Na.TIMEOUT=8,Na.HTTP_ERROR=6,Vo=wn.ErrorCode=Na,v_.COMPLETE="complete",Df=wn.EventType=v_,p_.EventType=Cs,Cs.OPEN="a",Cs.CLOSE="b",Cs.ERROR="c",Cs.MESSAGE="d",qe.prototype.listen=qe.prototype.K,Mr=wn.WebChannel=p_,ZN=wn.FetchXmlHttpFactory=Os,we.prototype.listenOnce=we.prototype.L,we.prototype.getLastError=we.prototype.Ka,we.prototype.getLastErrorCode=we.prototype.Ba,we.prototype.getStatus=we.prototype.Z,we.prototype.getResponseJson=we.prototype.Oa,we.prototype.getResponseText=we.prototype.oa,we.prototype.send=we.prototype.ea,we.prototype.setWithCredentials=we.prototype.Ha,Pf=wn.XhrIo=we}).apply(typeof fl<"u"?fl:typeof self<"u"?self:typeof window<"u"?window:{});var bw="@firebase/firestore";var Fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");var rs="10.14.0";var Oi=new bt("@firebase/firestore");function Uo(){return Oi.logLevel}function F(n,...e){if(Oi.logLevel<=X.DEBUG){let t=e.map(fm);Oi.debug(`Firestore (${rs}): ${n}`,...t)}}function Tn(n,...e){if(Oi.logLevel<=X.ERROR){let t=e.map(fm);Oi.error(`Firestore (${rs}): ${n}`,...t)}}function zr(n,...e){if(Oi.logLevel<=X.WARN){let t=e.map(fm);Oi.warn(`Firestore (${rs}): ${n}`,...t)}}function fm(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function q(n="Unexpected state"){let e=`FIRESTORE (${rs}) INTERNAL ASSERTION FAILED: `+n;throw Tn(e),new Error(e)}function de(n,e){n||q()}function K(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$=class extends st{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var En=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var vl=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Vf=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fe.UNAUTHENTICATED))}shutdown(){}},Uf=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},jf=class{constructor(e){this.t=e,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){de(this.o===void 0);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),s=new En;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new En,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>I(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},c=l=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new En)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(de(typeof i.accessToken=="string"),new vl(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return de(e===null||typeof e=="string"),new Fe(e)}},Bf=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Fe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},$f=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Bf(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},zf=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},qf=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){de(this.o===void 0);let i=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,F("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(de(typeof t.token=="string"),this.R=t.token,new zf(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function ek(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var Il=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=ek(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function ce(n,e){return n<e?-1:n>e?1:0}function qr(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}var $e=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Q=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new $e(0,0))}static max(){return new n(new $e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var wl=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&q(),i===void 0?i=e.length-t:i>e.length-t&&q(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Re=class n extends wl{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new $(N.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},tk=/^[_a-zA-Z][_a-zA-Z0-9]*$/,yt=class n extends wl{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return tk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new $(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let c=e[r];if(c==="\\"){if(r+1===e.length)throw new $(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else c==="`"?(o=!o,r++):c!=="."||o?(i+=c,r++):(s(),r++)}if(s(),o)throw new $(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var z=class n{constructor(e){this.path=e}static fromPath(e){return new n(Re.fromString(e))}static fromName(e){return new n(Re.fromString(e).popFirst(5))}static empty(){return new n(Re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Re(e.slice()))}};var Wf=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};Wf.UNKNOWN_ID=-1;function nk(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Q.fromTimestamp(i===1e9?new $e(t+1,0):new $e(t,i));return new Mi(r,z.empty(),e)}function ik(n){return new Mi(n.readTime,n.key,-1)}var Mi=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(Q.min(),z.empty(),-1)}static max(){return new n(Q.max(),z.empty(),-1)}};function rk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=z.comparator(n.documentKey,e.documentKey),t!==0?t:ce(n.largestBatchId,e.largestBatchId))}var sk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Gf=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ra(n){return I(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==sk)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),c=0;for(let l=0;l<s;l++){let u=l;t(e[u]).next(f=>{o[u]=f,++c,c===s&&i(o)},f=>r(f))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};function ok(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sa(n){return n.name==="IndexedDbTransactionError"}var iE=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Jl(n){return n==null}function Wo(n){return n===0&&1/n==-1/0}function ak(n){return typeof n=="number"&&Number.isInteger(n)&&!Wo(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var ck=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],HU=[...ck,"documentOverlays"],lk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],uk=lk,hk=[...uk,"indexConfiguration","indexState","indexEntries"];var KU=[...hk,"globals"];function Aw(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ui(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var be=class n{constructor(e,t){this.comparator=e,this.root=t||en.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,en.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,en.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ur(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ur(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ur(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ur(this.root,e,this.comparator,!0)}},Ur=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},en=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};en.EMPTY=null,en.RED=!0,en.BLACK=!1;en.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,i,r,s){return this}insert(e,t,i){return new en(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Qe=class n{constructor(e){this.comparator=e,this.data=new be(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new El(this.data.getIterator())}getIteratorFrom(e){return new El(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},El=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Zt=class n{constructor(e){this.fields=e,e.sort(yt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Qe(yt.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qr(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var Tl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ye=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Tl("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ye.EMPTY_BYTE_STRING=new Ye("");var dk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bn(n){if(de(!!n),typeof n=="string"){let e=0,t=dk.exec(n);if(de(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ye(n.seconds),nanos:ye(n.nanos)}}function ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ti(n){return typeof n=="string"?Ye.fromBase64String(n):Ye.fromUint8Array(n)}function pm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function mm(n){let e=n.mapValue.fields.__previous_value__;return pm(e)?mm(e):e}function Go(n){let e=bn(n.mapValue.fields.__local_write_time__.timestampValue);return new $e(e.seconds,e.nanos)}var Hf=class{constructor(e,t,i,r,s,o,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=u}},bl=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ml={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Li(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?pm(n)?4:oE(n)?9007199254740991:sE(n)?10:11:q()}function rn(n,e){if(n===e)return!0;let t=Li(n);if(t!==Li(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Go(n).isEqual(Go(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=bn(r.timestampValue),c=bn(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return ti(r.bytesValue).isEqual(ti(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ye(r.geoPointValue.latitude)===ye(s.geoPointValue.latitude)&&ye(r.geoPointValue.longitude)===ye(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ye(r.integerValue)===ye(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=ye(r.doubleValue),c=ye(s.doubleValue);return o===c?Wo(o)===Wo(c):isNaN(o)&&isNaN(c)}return!1}(n,e);case 9:return qr(n.arrayValue.values||[],e.arrayValue.values||[],rn);case 10:case 11:return function(r,s){let o=r.mapValue.fields||{},c=s.mapValue.fields||{};if(Aw(o)!==Aw(c))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!rn(o[l],c[l])))return!1;return!0}(n,e);default:return q()}}function Ho(n,e){return(n.values||[]).find(t=>rn(t,e))!==void 0}function Wr(n,e){if(n===e)return 0;let t=Li(n),i=Li(e);if(t!==i)return ce(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ce(n.booleanValue,e.booleanValue);case 2:return function(s,o){let c=ye(s.integerValue||s.doubleValue),l=ye(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return Cw(n.timestampValue,e.timestampValue);case 4:return Cw(Go(n),Go(e));case 5:return ce(n.stringValue,e.stringValue);case 6:return function(s,o){let c=ti(s),l=ti(o);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let c=s.split("/"),l=o.split("/");for(let u=0;u<c.length&&u<l.length;u++){let f=ce(c[u],l[u]);if(f!==0)return f}return ce(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let c=ce(ye(s.latitude),ye(o.latitude));return c!==0?c:ce(ye(s.longitude),ye(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Sw(n.arrayValue,e.arrayValue);case 10:return function(s,o){var c,l,u,f;let p=s.fields||{},g=o.fields||{},w=(c=p.value)===null||c===void 0?void 0:c.arrayValue,S=(l=g.value)===null||l===void 0?void 0:l.arrayValue,D=ce(((u=w?.values)===null||u===void 0?void 0:u.length)||0,((f=S?.values)===null||f===void 0?void 0:f.length)||0);return D!==0?D:Sw(w,S)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===ml.mapValue&&o===ml.mapValue)return 0;if(s===ml.mapValue)return 1;if(o===ml.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),u=o.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let p=0;p<l.length&&p<f.length;++p){let g=ce(l[p],f[p]);if(g!==0)return g;let w=Wr(c[l[p]],u[f[p]]);if(w!==0)return w}return ce(l.length,f.length)}(n.mapValue,e.mapValue);default:throw q()}}function Cw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ce(n,e);let t=bn(n),i=bn(e),r=ce(t.seconds,i.seconds);return r!==0?r:ce(t.nanos,i.nanos)}function Sw(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=Wr(t[r],i[r]);if(s)return s}return ce(t.length,i.length)}function Gr(n){return Kf(n)}function Kf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=bn(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ti(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=Kf(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let o of i)s?s=!1:r+=",",r+=`${o}:${Kf(t.fields[o])}`;return r+"}"}(n.mapValue):q()}function Qf(n){return!!n&&"integerValue"in n}function gm(n){return!!n&&"arrayValue"in n}function Rw(n){return!!n&&"nullValue"in n}function Pw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _l(n){return!!n&&"mapValue"in n}function sE(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Bo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ui(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Bo(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var St=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!_l(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bo(t)}setAll(e){let t=yt.emptyPath(),i={},r=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=c.popLast()}o?i[c.lastSegment()]=Bo(o):r.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());_l(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];_l(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ui(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n(Bo(this.value))}};function aE(n){let e=[];return Ui(n.fields,(t,i)=>{let r=new yt([t]);if(_l(i)){let s=aE(i.mapValue).fields;if(s.length===0)e.push(r);else for(let o of s)e.push(r.child(o))}else e.push(r)}),new Zt(e)}var jt=class n{constructor(e,t,i,r,s,o,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,Q.min(),Q.min(),Q.min(),St.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,Q.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,Q.min(),Q.min(),St.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Q.min(),Q.min(),St.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Hr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Dw(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField()?i=z.comparator(z.fromName(o.referenceValue),t.key):i=Wr(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Nw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!rn(n.position[t],e.position[t]))return!1;return!0}var Kr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function fk(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Al=class{},xe=class n extends Al{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Jf(e,t,i):t==="array-contains"?new ep(e,i):t==="in"?new tp(e,i):t==="not-in"?new np(e,i):t==="array-contains-any"?new ip(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Xf(e,i):new Zf(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Wr(t,this.value)):t!==null&&Li(this.value)===Li(t)&&this.matchesComparison(Wr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},sn=class n extends Al{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return cE(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function cE(n){return n.op==="and"}function lE(n){return pk(n)&&cE(n)}function pk(n){for(let e of n.filters)if(e instanceof sn)return!1;return!0}function Yf(n){if(n instanceof xe)return n.field.canonicalString()+n.op.toString()+Gr(n.value);if(lE(n))return n.filters.map(e=>Yf(e)).join(",");{let e=n.filters.map(t=>Yf(t)).join(",");return`${n.op}(${e})`}}function uE(n,e){return n instanceof xe?function(i,r){return r instanceof xe&&i.op===r.op&&i.field.isEqual(r.field)&&rn(i.value,r.value)}(n,e):n instanceof sn?function(i,r){return r instanceof sn&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,c)=>s&&uE(o,r.filters[c]),!0):!1}(n,e):void q()}function hE(n){return n instanceof xe?function(t){return`${t.field.canonicalString()} ${t.op} ${Gr(t.value)}`}(n):n instanceof sn?function(t){return t.op.toString()+" {"+t.getFilters().map(hE).join(" ,")+"}"}(n):"Filter"}var Jf=class extends xe{constructor(e,t,i){super(e,t,i),this.key=z.fromName(i.referenceValue)}matches(e){let t=z.comparator(e.key,this.key);return this.matchesComparison(t)}},Xf=class extends xe{constructor(e,t){super(e,"in",t),this.keys=dE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Zf=class extends xe{constructor(e,t){super(e,"not-in",t),this.keys=dE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function dE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>z.fromName(i.referenceValue))}var ep=class extends xe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return gm(t)&&Ho(t.arrayValue,this.value)}},tp=class extends xe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ho(this.value.arrayValue,t)}},np=class extends xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ho(this.value.arrayValue,t)}},ip=class extends xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!gm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Ho(this.value.arrayValue,i))}};var rp=class{constructor(e,t=null,i=[],r=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=c,this.ue=null}};function kw(n,e=null,t=[],i=[],r=null,s=null,o=null){return new rp(n,e,t,i,r,s,o)}function _m(n){let e=K(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Yf(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Jl(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Gr(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Gr(i)).join(",")),e.ue=t}return e.ue}function ym(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!fk(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!uE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Nw(n.startAt,e.startAt)&&Nw(n.endAt,e.endAt)}function sp(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Qr=class{constructor(e,t=null,i=[],r=[],s=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function mk(n,e,t,i,r,s,o,c){return new Qr(n,e,t,i,r,s,o,c)}function vm(n){return new Qr(n)}function xw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gk(n){return n.collectionGroup!==null}function $o(n){let e=K(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Qe(yt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Kr(s,i))}),t.has(yt.keyField().canonicalString())||e.ce.push(new Kr(yt.keyField(),i))}return e.ce}function tn(n){let e=K(n);return e.le||(e.le=_k(e,$o(n))),e.le}function _k(n,e){if(n.limitType==="F")return kw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Kr(r.field,s)});let t=n.endAt?new Hr(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Hr(n.startAt.position,n.startAt.inclusive):null;return kw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function op(n,e,t){return new Qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xl(n,e){return ym(tn(n),tn(e))&&n.limitType===e.limitType}function fE(n){return`${_m(tn(n))}|lt:${n.limitType}`}function Lr(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>hE(r)).join(", ")}]`),Jl(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Gr(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Gr(r)).join(",")),`Target(${i})`}(tn(n))}; limitType=${n.limitType})`}function Zl(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):z.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of $o(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,c,l){let u=Dw(o,c,l);return o.inclusive?u<=0:u<0}(i.startAt,$o(i),r)||i.endAt&&!function(o,c,l){let u=Dw(o,c,l);return o.inclusive?u>=0:u>0}(i.endAt,$o(i),r))}(n,e)}function yk(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pE(n){return(e,t)=>{let i=!1;for(let r of $o(n)){let s=vk(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function vk(n,e,t){let i=n.field.isKeyField()?z.comparator(e.key,t.key):function(s,o,c){let l=o.data.field(s),u=c.data.field(s);return l!==null&&u!==null?Wr(l,u):q()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return q()}}var ni=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ui(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return rE(this.inner)}size(){return this.innerSize}};var Ik=new be(z.comparator);function An(){return Ik}var mE=new be(z.comparator);function jo(...n){let e=mE;for(let t of n)e=e.insert(t.key,t);return e}function gE(n){let e=mE;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Di(){return zo()}function _E(){return zo()}function zo(){return new ni(n=>n.toString(),(n,e)=>n.isEqual(e))}var wk=new be(z.comparator),Ek=new Qe(z.comparator);function Z(...n){let e=Ek;for(let t of n)e=e.add(t);return e}var Tk=new Qe(ce);function bk(){return Tk}function Im(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wo(e)?"-0":e}}function yE(n){return{integerValue:""+n}}function Ak(n,e){return ak(e)?yE(e):Im(n,e)}var Yr=class{constructor(){this._=void 0}};function Ck(n,e,t){return n instanceof Jr?function(r,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&pm(s)&&(s=mm(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Fi?IE(n,e):n instanceof Vi?wE(n,e):function(r,s){let o=vE(r,s),c=Ow(o)+Ow(r.Pe);return Qf(o)&&Qf(r.Pe)?yE(c):Im(r.serializer,c)}(n,e)}function Sk(n,e,t){return n instanceof Fi?IE(n,e):n instanceof Vi?wE(n,e):t}function vE(n,e){return n instanceof Xr?function(i){return Qf(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var Jr=class extends Yr{},Fi=class extends Yr{constructor(e){super(),this.elements=e}};function IE(n,e){let t=EE(e);for(let i of n.elements)t.some(r=>rn(r,i))||t.push(i);return{arrayValue:{values:t}}}var Vi=class extends Yr{constructor(e){super(),this.elements=e}};function wE(n,e){let t=EE(e);for(let i of n.elements)t=t.filter(r=>!rn(r,i));return{arrayValue:{values:t}}}var Xr=class extends Yr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Ow(n){return ye(n.integerValue||n.doubleValue)}function EE(n){return gm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Rk(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof Fi&&r instanceof Fi||i instanceof Vi&&r instanceof Vi?qr(i.elements,r.elements,rn):i instanceof Xr&&r instanceof Xr?rn(i.Pe,r.Pe):i instanceof Jr&&r instanceof Jr}(n.transform,e.transform)}var ap=class{constructor(e,t){this.version=e,this.transformResults=t}},xi=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function yl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Zr=class{};function TE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Cl(n.key,xi.none()):new es(n.key,n.data,xi.none());{let t=n.data,i=St.empty(),r=new Qe(yt.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Cn(n.key,i,new Zt(r.toArray()),xi.none())}}function Pk(n,e,t){n instanceof es?function(r,s,o){let c=r.value.clone(),l=Lw(r.fieldTransforms,s,o.transformResults);c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):n instanceof Cn?function(r,s,o){if(!yl(r.precondition,s))return void s.convertToUnknownDocument(o.version);let c=Lw(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(bE(r)),l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function qo(n,e,t,i){return n instanceof es?function(s,o,c,l){if(!yl(s.precondition,o))return c;let u=s.value.clone(),f=Fw(s.fieldTransforms,l,o);return u.setAll(f),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof Cn?function(s,o,c,l){if(!yl(s.precondition,o))return c;let u=Fw(s.fieldTransforms,l,o),f=o.data;return f.setAll(bE(s)),f.setAll(u),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,i):function(s,o,c){return yl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,e,t)}function Dk(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=vE(i.transform,r||null);s!=null&&(t===null&&(t=St.empty()),t.set(i.field,s))}return t||null}function Mw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&qr(i,r,(s,o)=>Rk(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var es=class extends Zr{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Cn=class extends Zr{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function bE(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function Lw(n,e,t){let i=new Map;de(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,c=e.data.field(s.field);i.set(s.field,Sk(o,c,t[r]))}return i}function Fw(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,Ck(s,o,e))}return i}var Cl=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},cp=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var lp=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&Pk(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=qo(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=qo(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=_E();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(r.key)?null:c;let l=TE(o,c);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(Q.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Z())}isEqual(e){return this.batchId===e.batchId&&qr(this.mutations,e.mutations,(t,i)=>Mw(t,i))&&qr(this.baseMutations,e.baseMutations,(t,i)=>Mw(t,i))}},up=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){de(e.mutations.length===i.length);let r=function(){return wk}(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var hp=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var dp=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ce,ie;function Nk(n){switch(n){default:return q();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function AE(n){if(n===void 0)return Tn("GRPC error has no .code"),N.UNKNOWN;switch(n){case Ce.OK:return N.OK;case Ce.CANCELLED:return N.CANCELLED;case Ce.UNKNOWN:return N.UNKNOWN;case Ce.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Ce.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Ce.INTERNAL:return N.INTERNAL;case Ce.UNAVAILABLE:return N.UNAVAILABLE;case Ce.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Ce.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Ce.NOT_FOUND:return N.NOT_FOUND;case Ce.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Ce.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Ce.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Ce.ABORTED:return N.ABORTED;case Ce.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Ce.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Ce.DATA_LOSS:return N.DATA_LOSS;default:return q()}}(ie=Ce||(Ce={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";var Vw=null;function kk(){return new TextEncoder}var xk=new ei([4294967295,4294967295],0);function Uw(n){let e=kk().encode(n),t=new Rf;return t.update(e),new Uint8Array(t.digest())}function jw(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ei([t,i],0),new ei([r,s],0)]}var fp=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ni(`Invalid padding: ${t}`);if(i<0)throw new Ni(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ni(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ni(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ei.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(ei.fromNumber(i)));return r.compare(xk)===1&&(r=new ei([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Uw(e),[i,r]=jw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;let t=Uw(e),[i,r]=jw(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Ni=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Sl=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,Ko.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(Q.min(),r,new be(ce),An(),Z())}},Ko=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,Z(),Z(),Z())}};var jr=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},Rl=class{constructor(e,t){this.targetId=e,this.me=t}},Pl=class{constructor(e,t,i=Ye.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Dl=class{constructor(){this.fe=0,this.ge=$w(),this.pe=Ye.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Z(),t=Z(),i=Z();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:q()}}),new Ko(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=$w()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,de(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},pp=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=An(),this.qe=Bw(),this.Qe=new be(ce)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(sp(s))if(i===0){let o=new z(s.path);this.Ue(t,o,jt.newNoDocument(o,Q.min()))}else de(i===1);else{let o=this.Ye(t);if(o!==i){let c=this.Ze(e),l=c?this.Xe(c,e,o):1;if(l!==0){this.je(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}Vw?.et(function(f,p,g,w,S){var D,P,V,j,M,oe;let ve={localCacheCount:f,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},ee=p.unchangedNames;return ee&&(ve.bloomFilter={applied:S===0,hashCount:(D=ee?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(j=(V=(P=ee?.bits)===null||P===void 0?void 0:P.bitmap)===null||V===void 0?void 0:V.length)!==null&&j!==void 0?j:0,padding:(oe=(M=ee?.bits)===null||M===void 0?void 0:M.padding)!==null&&oe!==void 0?oe:0,mightContain:T=>{var _;return(_=w?.mightContain(T))!==null&&_!==void 0&&_}}),ve}(o,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o,c;try{o=ti(i).toUint8Array()}catch(l){if(l instanceof Tl)return zr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new fp(o,r,s)}catch(l){return zr(l instanceof Ni?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let c=this.Je(o);if(c){if(s.current&&sp(c.target)){let l=new z(c.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,jt.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let i=Z();this.qe.forEach((s,o)=>{let c=!0;o.forEachWhile(l=>{let u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let r=new Sl(e,t,this.Qe,this.ke,i);return this.ke=An(),this.qe=Bw(),this.Qe=new be(ce),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Dl,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Qe(ce),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Dl),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Bw(){return new be(z.comparator)}function $w(){return new be(z.comparator)}var Ok={asc:"ASCENDING",desc:"DESCENDING"},Mk={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lk={and:"AND",or:"OR"},mp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function gp(n,e){return n.useProto3Json||Jl(e)?e:{value:e}}function Nl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Fk(n,e){return Nl(n,e.toTimestamp())}function nn(n){return de(!!n),Q.fromTimestamp(function(t){let i=bn(t);return new $e(i.seconds,i.nanos)}(n))}function wm(n,e){return _p(n,e).canonicalString()}function _p(n,e){let t=function(r){return new Re(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function SE(n){let e=Re.fromString(n);return de(kE(e)),e}function yp(n,e){return wm(n.databaseId,e.path)}function Of(n,e){let t=SE(e);if(t.get(1)!==n.databaseId.projectId)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new z(PE(t))}function RE(n,e){return wm(n.databaseId,e)}function Vk(n){let e=SE(n);return e.length===4?Re.emptyPath():PE(e)}function vp(n){return new Re(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PE(n){return de(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function zw(n,e,t){return{name:yp(n,e),fields:t.value.mapValue.fields}}function Uk(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(de(f===void 0||typeof f=="string"),Ye.fromBase64String(f||"")):(de(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ye.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(u){let f=u.code===void 0?N.UNKNOWN:AE(u.code);return new $(f,u.message||"")}(o);t=new Pl(i,r,s,c||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Of(n,i.document.name),s=nn(i.document.updateTime),o=i.document.createTime?nn(i.document.createTime):Q.min(),c=new St({mapValue:{fields:i.document.fields}}),l=jt.newFoundDocument(r,s,o,c),u=i.targetIds||[],f=i.removedTargetIds||[];t=new jr(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Of(n,i.document),s=i.readTime?nn(i.readTime):Q.min(),o=jt.newNoDocument(r,s),c=i.removedTargetIds||[];t=new jr([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Of(n,i.document),s=i.removedTargetIds||[];t=new jr([],s,r,null)}else{if(!("filter"in e))return q();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new dp(r,s),c=i.targetId;t=new Rl(c,o)}}return t}function jk(n,e){let t;if(e instanceof es)t={update:zw(n,e.key,e.value)};else if(e instanceof Cl)t={delete:yp(n,e.key)};else if(e instanceof Cn)t={update:zw(n,e.key,e.data),updateMask:Qk(e.fieldMask)};else{if(!(e instanceof cp))return q();t={verify:yp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){let c=o.transform;if(c instanceof Jr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Fi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Vi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Xr)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw q()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Fk(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(n,e.precondition)),t}function Bk(n,e){return n&&n.length>0?(de(e!==void 0),n.map(t=>function(r,s){let o=r.updateTime?nn(r.updateTime):nn(s);return o.isEqual(Q.min())&&(o=nn(s)),new ap(o,r.transformResults||[])}(t,e))):[]}function $k(n,e){return{documents:[RE(n,e.path)]}}function zk(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=RE(n,r);let s=function(u){if(u.length!==0)return NE(sn.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(f=>function(g){return{field:Fr(g.field),direction:Gk(g.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=gp(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:r}}function qk(n){let e=Vk(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){de(i===1);let f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let g=DE(p);return g instanceof sn&&lE(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(g=>function(S){return new Kr(Vr(S.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(t.orderBy));let c=null;t.limit&&(c=function(p){let g;return g=typeof p=="object"?p.value:p,Jl(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(p){let g=!!p.before,w=p.values||[];return new Hr(w,g)}(t.startAt));let u=null;return t.endAt&&(u=function(p){let g=!p.before,w=p.values||[];return new Hr(w,g)}(t.endAt)),mk(e,r,o,s,c,"F",l,u)}function Wk(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function DE(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Vr(t.unaryFilter.field);return xe.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Vr(t.unaryFilter.field);return xe.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Vr(t.unaryFilter.field);return xe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Vr(t.unaryFilter.field);return xe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(n):n.fieldFilter!==void 0?function(t){return xe.create(Vr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return sn.create(t.compositeFilter.filters.map(i=>DE(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(n):q()}function Gk(n){return Ok[n]}function Hk(n){return Mk[n]}function Kk(n){return Lk[n]}function Fr(n){return{fieldPath:n.canonicalString()}}function Vr(n){return yt.fromServerFormat(n.fieldPath)}function NE(n){return n instanceof xe?function(t){if(t.op==="=="){if(Pw(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NAN"}};if(Rw(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Pw(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NAN"}};if(Rw(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fr(t.field),op:Hk(t.op),value:t.value}}}(n):n instanceof sn?function(t){let i=t.getFilters().map(r=>NE(r));return i.length===1?i[0]:{compositeFilter:{op:Kk(t.op),filters:i}}}(n):q()}function Qk(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function kE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Qo=class n{constructor(e,t,i,r,s=Q.min(),o=Q.min(),c=Ye.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ip=class{constructor(e){this.ct=e}};function Yk(n){let e=qk({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?op(e,e.limit,"L"):e}var kl=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ye(e.integerValue));else if("doubleValue"in e){let i=ye(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),Wo(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=bn(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ti(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?oE(e)?this.dt(t,Number.MAX_SAFE_INTEGER):sE(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):q()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;let s=e.fields||{};this.dt(t,53);let o="value",c=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(ye(c)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),z.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};kl.vt=new kl;var wp=class{constructor(){this.un=new Ep}addToCollectionParentIndex(e,t){return this.un.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(Mi.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(Mi.min())}updateCollectionGroup(e,t,i){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},Ep=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Qe(Re.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Qe(Re.comparator)).toArray()}};var YU=new Uint8Array(0);var Xt=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Xt.DEFAULT_COLLECTION_PERCENTILE=10,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xt.DEFAULT=new Xt(41943040,Xt.DEFAULT_COLLECTION_PERCENTILE,Xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xt.DISABLED=new Xt(-1,0,0);var Yo=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Tp=class{constructor(){this.changes=new ni(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,jt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?k.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var bp=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ap=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&qo(i.mutation,r,Zt.empty(),$e.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Z()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Z()){let r=Di();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=jo();return s.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=Di();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Z()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,i,r){let s=An(),o=zo(),c=function(){return zo()}();return t.forEach((l,u)=>{let f=i.get(u.key);r.has(u.key)&&(f===void 0||f.mutation instanceof Cn)?s=s.insert(u.key,u):f!==void 0?(o.set(u.key,f.mutation.getFieldMask()),qo(f.mutation,u,f.mutation.getFieldMask(),$e.now())):o.set(u.key,Zt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>o.set(u,f)),t.forEach((u,f)=>{var p;return c.set(u,new bp(f,(p=o.get(u))!==null&&p!==void 0?p:null))}),c))}recalculateAndSaveOverlays(e,t){let i=zo(),r=new be((o,c)=>o-c),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let f=i.get(l)||Zt.empty();f=c.applyToLocalView(u,f),i.set(l,f);let p=(r.get(c.batchId)||Z()).add(l);r=r.insert(c.batchId,p)})}).next(()=>{let o=[],c=r.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),u=l.key,f=l.value,p=_E();f.forEach(g=>{if(!s.has(g)){let w=TE(t.get(g),i.get(g));w!==null&&p.set(g,w),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return k.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):k.resolve(Di()),c=-1,l=s;return o.next(u=>k.forEach(u,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),s.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{l=l.insert(f,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Z())).next(f=>({batchId:c,changes:gE(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new z(t)).next(i=>{let r=jo();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=jo();return this.indexManager.getCollectionParents(e,s).next(c=>k.forEach(c,l=>{let u=function(p,g){return new Qr(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(f=>{f.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,u)=>{let f=u.getKey();o.get(f)===null&&(o=o.insert(f,jt.newInvalidDocument(f)))});let c=jo();return o.forEach((l,u)=>{let f=s.get(l);f!==void 0&&qo(f.mutation,u,Zt.empty(),$e.now()),Zl(t,u)&&(c=c.insert(l,u))}),c})}};var Cp=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return k.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:nn(r.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:Yk(r.bundledQuery),readTime:nn(r.readTime)}}(t)),k.resolve()}};var Sp=class{constructor(){this.overlays=new be(z.comparator),this.Ir=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Di();return k.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),k.resolve()}getOverlaysForCollection(e,t,i){let r=Di(),s=t.length+1,o=new z(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let l=c.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return k.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new be((u,f)=>u-f),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let f=s.get(u.largestBatchId);f===null&&(f=Di(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}let c=Di(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>c.set(u,f)),!(c.size()>=r)););return k.resolve(c)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new hp(t,i));let s=this.Ir.get(t);s===void 0&&(s=Z(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var Rp=class{constructor(){this.sessionToken=Ye.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var Jo=class{constructor(){this.Tr=new Qe(Se.Er),this.dr=new Qe(Se.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new Se(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new Se(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new z(new Re([])),i=new Se(t,e),r=new Se(t,e+1),s=[];return this.dr.forEachInRange([i,r],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new z(new Re([])),i=new Se(t,e),r=new Se(t,e+1),s=Z();return this.dr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Se(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},Se=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return z.comparator(e.key,t.key)||ce(e.wr,t.wr)}static Ar(e,t){return ce(e.wr,t.wr)||z.comparator(e.key,t.key)}};var Pp=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Qe(Se.Er)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new lp(s,t,i,r);this.mutationQueue.push(o);for(let c of r)this.br=this.br.add(new Se(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.vr(i),s=r<0?0:r;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new Se(t,0),r=new Se(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],o=>{let c=this.Dr(o.wr);s.push(c)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Qe(ce);return t.forEach(r=>{let s=new Se(r,0),o=new Se(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],c=>{i=i.add(c.wr)})}),k.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;z.isDocumentKey(s)||(s=s.child(""));let o=new Se(new z(s),0),c=new Qe(ce);return this.br.forEachWhile(l=>{let u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(c=c.add(l.wr)),!0)},o),k.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(i=>{let r=this.Dr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){de(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return k.forEach(t.mutations,r=>{let s=new Se(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new Se(t,0),r=this.br.firstAfterOrEqual(i);return k.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Dp=class{constructor(e){this.Mr=e,this.docs=function(){return new be(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return k.resolve(i?i.document.mutableCopy():jt.newInvalidDocument(t))}getEntries(e,t){let i=An();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():jt.newInvalidDocument(r))}),k.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=An(),o=t.path,c=new z(o.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:u,value:{document:f}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||rk(ik(f),i)<=0||(r.has(f.key)||Zl(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,i,r){q()}Or(e,t){return k.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Np(this)}getSize(e){return k.resolve(this.size)}},Np=class extends Tp{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),k.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var kp=class{constructor(e){this.persistence=e,this.Nr=new ni(t=>_m(t),ym),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Jo,this.targetCount=0,this.kr=Yo.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,r)=>t(r)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),k.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Yo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Kn(t),k.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),k.waitFor(s).next(()=>r)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return k.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),k.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return k.resolve(i)}containsKey(e,t){return k.resolve(this.Br.containsKey(t))}};var xp=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new iE(0),this.Kr=!1,this.Kr=!0,this.$r=new Rp,this.referenceDelegate=e(this),this.Ur=new kp(this),this.indexManager=new wp,this.remoteDocumentCache=function(r){return new Dp(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new Ip(t),this.Gr=new Cp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Sp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new Pp(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){F("MemoryPersistence","Starting transaction:",e);let r=new Op(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(e,t){return k.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},Op=class extends Gf{constructor(e){super(),this.currentSequenceNumber=e}},Mp=class n{constructor(e){this.persistence=e,this.Jr=new Jo,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw q()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),k.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),k.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Xr,i=>{let r=z.fromPath(i);return this.ei(e,r).next(s=>{s||t.removeEntry(r,Q.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return k.or([()=>k.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Lp=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=Z(),r=Z();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var Fp=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Vp=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rI()?8:ok(Me())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Fp;return this.Xi(e,t,o).next(c=>{if(s.result=c,this.zi)return this.es(e,t,o,c.size)})}).next(()=>s.result)}es(e,t,i,r){return i.documentReadCount<this.ji?(Uo()<=X.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Lr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),k.resolve()):(Uo()<=X.DEBUG&&F("QueryEngine","Query:",Lr(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(Uo()<=X.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Lr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,tn(t))):k.resolve())}Yi(e,t){if(xw(t))return k.resolve(null);let i=tn(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=op(t,null,"F"),i=tn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=Z(...s);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,i).next(l=>{let u=this.ts(t,c);return this.ns(t,u,o,l.readTime)?this.Yi(e,op(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,i,r){return xw(t)||r.isEqual(Q.min())?k.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let o=this.ts(t,s);return this.ns(t,o,i,r)?k.resolve(null):(Uo()<=X.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Lr(t)),this.rs(e,o,t,nk(r,-1)).next(c=>c))})}ts(e,t){let i=new Qe(pE(e));return t.forEach((r,s)=>{Zl(e,s)&&(i=i.add(s))}),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,i){return Uo()<=X.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Lr(t)),this.Ji.getDocumentsMatchingQuery(e,t,Mi.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Up=class{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new be(ce),this._s=new ni(s=>_m(s),ym),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ap(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Jk(n,e,t,i){return new Up(n,e,t,i)}function xE(n,e){return I(this,null,function*(){let t=K(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let o=[],c=[],l=Z();for(let u of r){o.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}for(let u of s){c.push(u.batchId);for(let f of u.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(i,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:c}))})})})}function Xk(n,e){let t=K(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,u,f){let p=u.batch,g=p.keys(),w=k.resolve();return g.forEach(S=>{w=w.next(()=>f.getEntry(l,S)).next(D=>{let P=u.docVersions.get(S);de(P!==null),D.version.compareTo(P)<0&&(p.applyToRemoteDocument(D,u),D.isValidDocument()&&(D.setReadTime(u.commitVersion),f.addEntry(D)))})}),w.next(()=>c.mutationQueue.removeMutationBatch(l,p))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let l=Z();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(l=l.add(c.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function OE(n){let e=K(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Zk(n,e){let t=K(n),i=e.snapshotVersion,r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;let c=[];e.targetChanges.forEach((f,p)=>{let g=r.get(p);if(!g)return;c.push(t.Ur.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,f.addedDocuments,p)));let w=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Ye.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,i)),r=r.insert(p,w),function(D,P,V){return D.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(g,w,f)&&c.push(t.Ur.updateTargetData(s,w))});let l=An(),u=Z();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),c.push(ex(s,o,e.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!i.isEqual(Q.min())){let f=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(f)}return k.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=r,s))}function ex(n,e,t){let i=Z(),r=Z();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=An();return t.forEach((c,l)=>{let u=s.get(c);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),l.isNoDocument()&&l.version.isEqual(Q.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):F("LocalStore","Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:r}})}function tx(n,e){let t=K(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function nx(n,e){let t=K(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ur.getTargetData(i,e).next(s=>s?(r=s,k.resolve(r)):t.Ur.allocateTargetId(i).next(o=>(r=new Qo(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function jp(n,e,t){return I(this,null,function*(){let i=K(n),r=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!sa(o))throw o;F("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.os=i.os.remove(e),i._s.delete(r.target)})}function qw(n,e,t){let i=K(n),r=Q.min(),s=Z();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,f){let p=K(l),g=p._s.get(f);return g!==void 0?k.resolve(p.os.get(g)):p.Ur.getTargetData(u,f)}(i,o,tn(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(o,c.targetId).next(l=>{s=l})}).next(()=>i.ss.getDocumentsMatchingQuery(o,e,t?r:Q.min(),t?s:Z())).next(c=>(ix(i,yk(e),c),{documents:c,Ts:s})))}function ix(n,e,t){let i=n.us.get(e)||Q.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}var xl=class{constructor(){this.activeTargetIds=bk()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Bp=class{constructor(){this.so=new xl,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new xl,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var $p=class{_o(e){}shutdown(){}};var Ol=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){F("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){F("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var gl=null;function Mf(){return gl===null?gl=function(){return 268435456+Math.round(2147483648*Math.random())}():gl++,"0x"+gl.toString(16)}var rx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var zp=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ke="WebChannelConnection",qp=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(t,i,r,s,o){let c=Mf(),l=this.xo(t,i.toUriEncodedString());F("RestConnection",`Sending RPC '${t}' ${c}:`,l,r);let u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,r).then(f=>(F("RestConnection",`Received RPC '${t}' ${c}: `,f),f),f=>{throw zr("RestConnection",`RPC '${t}' ${c} failed with error: `,f,"url: ",l,"request:",r),f})}Lo(t,i,r,s,o,c){return this.Mo(t,i,r,s,o)}Oo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rs}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}xo(t,i){let r=rx[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){let s=Mf();return new Promise((o,c)=>{let l=new Pf;l.setWithCredentials(!0),l.listenOnce(Df.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Vo.NO_ERROR:let f=l.getResponseJson();F(Ke,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Vo.TIMEOUT:F(Ke,`RPC '${e}' ${s} timed out`),c(new $(N.DEADLINE_EXCEEDED,"Request time out"));break;case Vo.HTTP_ERROR:let p=l.getStatus();if(F(Ke,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);let w=g?.error;if(w&&w.status&&w.message){let S=function(P){let V=P.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(V)>=0?V:N.UNKNOWN}(w.status);c(new $(S,w.message))}else c(new $(N.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new $(N.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{F(Ke,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(r);F(Ke,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",u,i,15)})}Bo(e,t,i){let r=Mf(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=xf(),c=kf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;let f=s.join("");F(Ke,`Creating RPC '${e}' stream ${r}: ${f}`,l);let p=o.createWebChannel(f,l),g=!1,w=!1,S=new zp({Io:P=>{w?F(Ke,`Not sending because RPC '${e}' stream ${r} is closed:`,P):(g||(F(Ke,`Opening RPC '${e}' stream ${r} transport.`),p.open(),g=!0),F(Ke,`RPC '${e}' stream ${r} sending:`,P),p.send(P))},To:()=>p.close()}),D=(P,V,j)=>{P.listen(V,M=>{try{j(M)}catch(oe){setTimeout(()=>{throw oe},0)}})};return D(p,Mr.EventType.OPEN,()=>{w||(F(Ke,`RPC '${e}' stream ${r} transport opened.`),S.yo())}),D(p,Mr.EventType.CLOSE,()=>{w||(w=!0,F(Ke,`RPC '${e}' stream ${r} transport closed`),S.So())}),D(p,Mr.EventType.ERROR,P=>{w||(w=!0,zr(Ke,`RPC '${e}' stream ${r} transport errored:`,P),S.So(new $(N.UNAVAILABLE,"The operation could not be completed")))}),D(p,Mr.EventType.MESSAGE,P=>{var V;if(!w){let j=P.data[0];de(!!j);let M=j,oe=M.error||((V=M[0])===null||V===void 0?void 0:V.error);if(oe){F(Ke,`RPC '${e}' stream ${r} received error:`,oe);let ve=oe.status,ee=function(v){let E=Ce[v];if(E!==void 0)return AE(E)}(ve),T=oe.message;ee===void 0&&(ee=N.INTERNAL,T="Unknown error status: "+ve+" with message "+oe.message),w=!0,S.So(new $(ee,T)),p.close()}else F(Ke,`RPC '${e}' stream ${r} received:`,j),S.bo(j)}}),D(c,Nf.STAT_EVENT,P=>{P.stat===pl.PROXY?F(Ke,`RPC '${e}' stream ${r} detected buffering proxy`):P.stat===pl.NOPROXY&&F(Ke,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}};function Lf(){return typeof document<"u"?document:null}function eu(n){return new mp(n,!0)}var Ml=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&F("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Ll=class{constructor(e,t,i,r,s,o,c,l){this.ui=e,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ml(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return I(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return I(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return I(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Tn(t.toString()),Tn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===t&&this.P_(i,r)},i=>{e(()=>{let r=new $(N.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>I(this,null,function*(){this.state=0,this.start()}))}I_(e){return F("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(F("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Wp=class extends Ll{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Uk(this.serializer,e),i=function(s){if(!("targetChange"in s))return Q.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Q.min():o.readTime?nn(o.readTime):Q.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=vp(this.serializer),t.addTarget=function(s,o){let c,l=o.target;if(c=sp(l)?{documents:$k(s,l)}:{query:zk(s,l)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=CE(s,o.resumeToken);let u=gp(s,o.expectedCount);u!==null&&(c.expectedCount=u)}else if(o.snapshotVersion.compareTo(Q.min())>0){c.readTime=Nl(s,o.snapshotVersion.toTimestamp());let u=gp(s,o.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);let i=Wk(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=vp(this.serializer),t.removeTarget=e,this.a_(t)}},Gp=class extends Ll{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return de(!!e.streamToken),this.lastStreamToken=e.streamToken,de(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){de(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=Bk(e.writeResults,e.commitTime),i=nn(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=vp(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>jk(this.serializer,i))};this.a_(t)}};var Hp=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,_p(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(N.UNKNOWN,s.toString())})}Lo(e,t,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,_p(t,i),r,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(N.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Kp=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Tn(t),this.D_=!1):F("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Qp=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{i.enqueueAndForget(()=>I(this,null,function*(){ji(this)&&(F("RemoteStore","Restarting streams for network reachability change."),yield function(l){return I(this,null,function*(){let u=K(l);u.L_.add(4),yield oa(u),u.q_.set("Unknown"),u.L_.delete(4),yield tu(u)})}(this))}))}),this.q_=new Kp(i,r)}};function tu(n){return I(this,null,function*(){if(ji(n))for(let e of n.B_)yield e(!0)})}function oa(n){return I(this,null,function*(){for(let e of n.B_)yield e(!1)})}function ME(n,e){let t=K(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Am(t)?bm(t):ss(t).r_()&&Tm(t,e))}function Em(n,e){let t=K(n),i=ss(t);t.N_.delete(e),i.r_()&&LE(t,e),t.N_.size===0&&(i.r_()?i.o_():ji(t)&&t.q_.set("Unknown"))}function Tm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ss(n).A_(e)}function LE(n,e){n.Q_.xe(e),ss(n).R_(e)}function bm(n){n.Q_=new pp({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ss(n).start(),n.q_.v_()}function Am(n){return ji(n)&&!ss(n).n_()&&n.N_.size>0}function ji(n){return K(n).L_.size===0}function FE(n){n.Q_=void 0}function sx(n){return I(this,null,function*(){n.q_.set("Online")})}function ox(n){return I(this,null,function*(){n.N_.forEach((e,t)=>{Tm(n,e)})})}function ax(n,e){return I(this,null,function*(){FE(n),Am(n)?(n.q_.M_(e),bm(n)):n.q_.set("Unknown")})}function cx(n,e,t){return I(this,null,function*(){if(n.q_.set("Online"),e instanceof Pl&&e.state===2&&e.cause)try{yield function(r,s){return I(this,null,function*(){let o=s.cause;for(let c of s.targetIds)r.N_.has(c)&&(yield r.remoteSyncer.rejectListen(c,o),r.N_.delete(c),r.Q_.removeTarget(c))})}(n,e)}catch(i){F("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Fl(n,i)}else if(e instanceof jr?n.Q_.Ke(e):e instanceof Rl?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Q.min()))try{let i=yield OE(n.localStore);t.compareTo(i)>=0&&(yield function(s,o){let c=s.Q_.rt(o);return c.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let f=s.N_.get(u);f&&s.N_.set(u,f.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,u)=>{let f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(Ye.EMPTY_BYTE_STRING,f.snapshotVersion)),LE(s,l);let p=new Qo(f.target,l,u,f.sequenceNumber);Tm(s,p)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(i){F("RemoteStore","Failed to raise snapshot:",i),yield Fl(n,i)}})}function Fl(n,e,t){return I(this,null,function*(){if(!sa(e))throw e;n.L_.add(1),yield oa(n),n.q_.set("Offline"),t||(t=()=>OE(n.localStore)),n.asyncQueue.enqueueRetryable(()=>I(this,null,function*(){F("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield tu(n)}))})}function VE(n,e){return e().catch(t=>Fl(n,t,e))}function nu(n){return I(this,null,function*(){let e=K(n),t=ii(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;lx(e);)try{let r=yield tx(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,ux(e,r)}catch(r){yield Fl(e,r)}UE(e)&&jE(e)})}function lx(n){return ji(n)&&n.O_.length<10}function ux(n,e){n.O_.push(e);let t=ii(n);t.r_()&&t.V_&&t.m_(e.mutations)}function UE(n){return ji(n)&&!ii(n).n_()&&n.O_.length>0}function jE(n){ii(n).start()}function hx(n){return I(this,null,function*(){ii(n).p_()})}function dx(n){return I(this,null,function*(){let e=ii(n);for(let t of n.O_)e.m_(t.mutations)})}function fx(n,e,t){return I(this,null,function*(){let i=n.O_.shift(),r=up.from(i,e,t);yield VE(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield nu(n)})}function px(n,e){return I(this,null,function*(){e&&ii(n).V_&&(yield function(i,r){return I(this,null,function*(){if(function(o){return Nk(o)&&o!==N.ABORTED}(r.code)){let s=i.O_.shift();ii(i).s_(),yield VE(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield nu(i)}})}(n,e)),UE(n)&&jE(n)})}function Ww(n,e){return I(this,null,function*(){let t=K(n);t.asyncQueue.verifyOperationInProgress(),F("RemoteStore","RemoteStore received new credentials");let i=ji(t);t.L_.add(3),yield oa(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield tu(t)})}function mx(n,e){return I(this,null,function*(){let t=K(n);e?(t.L_.delete(2),yield tu(t)):e||(t.L_.add(2),yield oa(t),t.q_.set("Unknown"))})}function ss(n){return n.K_||(n.K_=function(t,i,r){let s=K(t);return s.w_(),new Wp(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:sx.bind(null,n),Ro:ox.bind(null,n),mo:ax.bind(null,n),d_:cx.bind(null,n)}),n.B_.push(e=>I(this,null,function*(){e?(n.K_.s_(),Am(n)?bm(n):n.q_.set("Unknown")):(yield n.K_.stop(),FE(n))}))),n.K_}function ii(n){return n.U_||(n.U_=function(t,i,r){let s=K(t);return s.w_(),new Gp(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hx.bind(null,n),mo:px.bind(null,n),f_:dx.bind(null,n),g_:fx.bind(null,n)}),n.B_.push(e=>I(this,null,function*(){e?(n.U_.s_(),yield nu(n)):(yield n.U_.stop(),n.O_.length>0&&(F("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Yp=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new En,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,c=new n(e,t,o,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Cm(n,e){if(Tn("AsyncQueue",`${e}: ${n}`),sa(n))return new $(N.UNAVAILABLE,`${e}: ${n}`);throw n}var Vl=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||z.comparator(t.key,i.key):(t,i)=>z.comparator(t.key,i.key),this.keyedMap=jo(),this.sortedSet=new be(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Ul=class{constructor(){this.W_=new be(z.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):q():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},ts=class n{constructor(e,t,i,r,s,o,c,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,Vl.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var Jp=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Xp=class{constructor(){this.queries=Gw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let r=K(t),s=r.queries;r.queries=Gw(),s.forEach((o,c)=>{for(let l of c.j_)l.onError(i)})})(this,new $(N.ABORTED,"Firestore shutting down"))}};function Gw(){return new ni(n=>fE(n),Xl)}function gx(n,e){return I(this,null,function*(){let t=K(n),i=3,r=e.query,s=t.queries.get(r);s?!s.H_()&&e.J_()&&(i=2):(s=new Jp,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(r,!0);break;case 1:s.z_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){let c=Cm(o,`Initialization of query '${Lr(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Sm(t)})}function _x(n,e){return I(this,null,function*(){let t=K(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?r=e.J_()?0:1:!s.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function yx(n,e){let t=K(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let c of o.j_)c.X_(r)&&(i=!0);o.z_=r}}i&&Sm(t)}function vx(n,e,t){let i=K(n),r=i.queries.get(e);if(r)for(let s of r.j_)s.onError(t);i.queries.delete(e)}function Sm(n){n.Y_.forEach(e=>{e.next()})}var Zp,Hw;(Hw=Zp||(Zp={})).ea="default",Hw.Cache="cache";var em=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new ts(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ts.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Zp.Cache}};var jl=class{constructor(e){this.key=e}},Bl=class{constructor(e){this.key=e}},tm=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Z(),this.mutatedKeys=Z(),this.Aa=pE(e),this.Ra=new Vl(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new Ul,r=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=r,c=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,p)=>{let g=r.get(f),w=Zl(this.query,p)?p:null,S=!!g&&this.mutatedKeys.has(g.key),D=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),P=!1;g&&w?g.data.isEqual(w.data)?S!==D&&(i.track({type:3,doc:w}),P=!0):this.ga(g,w)||(i.track({type:2,doc:w}),P=!0,(l&&this.Aa(w,l)>0||u&&this.Aa(w,u)<0)&&(c=!0)):!g&&w?(i.track({type:0,doc:w}),P=!0):g&&!w&&(i.track({type:1,doc:g}),P=!0,(l||u)&&(c=!0)),P&&(w?(o=o.add(w),s=D?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),i.track({type:1,doc:f})}return{Ra:o,fa:i,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((f,p)=>function(w,S){let D=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return D(w)-D(S)}(f.type,p.type)||this.Aa(f.doc,p.doc)),this.pa(i),r=r!=null&&r;let c=t&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new ts(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ul,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Z(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new Bl(i))}),this.da.forEach(i=>{e.has(i)||t.push(new jl(i))}),t}ba(e){this.Ta=e.Ts,this.da=Z();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ts.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},nm=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},im=class{constructor(e){this.key=e,this.va=!1}},rm=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ni(c=>fE(c),Xl),this.Ma=new Map,this.xa=new Set,this.Oa=new be(z.comparator),this.Na=new Map,this.La=new Jo,this.Ba={},this.ka=new Map,this.qa=Yo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Ix(n,e,t=!0){return I(this,null,function*(){let i=GE(n),r,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield BE(i,e,t,!0),r})}function wx(n,e){return I(this,null,function*(){let t=GE(n);yield BE(t,e,!0,!1)})}function BE(n,e,t,i){return I(this,null,function*(){let r=yield nx(n.localStore,tn(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return i&&(c=yield Ex(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&ME(n.remoteStore,r),c})}function Ex(n,e,t,i,r){return I(this,null,function*(){n.Ka=(p,g,w)=>function(D,P,V,j){return I(this,null,function*(){let M=P.view.ma(V);M.ns&&(M=yield qw(D.localStore,P.query,!1).then(({documents:T})=>P.view.ma(T,M)));let oe=j&&j.targetChanges.get(P.targetId),ve=j&&j.targetMismatches.get(P.targetId)!=null,ee=P.view.applyChanges(M,D.isPrimaryClient,oe,ve);return Qw(D,P.targetId,ee.wa),ee.snapshot})}(n,p,g,w);let s=yield qw(n.localStore,e,!0),o=new tm(e,s.Ts),c=o.ma(s.documents),l=Ko.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=o.applyChanges(c,n.isPrimaryClient,l);Qw(n,t,u.wa);let f=new nm(e,t,o);return n.Fa.set(e,f),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot})}function Tx(n,e,t){return I(this,null,function*(){let i=K(n),r=i.Fa.get(e),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(o=>!Xl(o,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield jp(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Em(i.remoteStore,r.targetId),sm(i,r.targetId)}).catch(ra))):(sm(i,r.targetId),yield jp(i.localStore,r.targetId,!0))})}function bx(n,e){return I(this,null,function*(){let t=K(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Em(t.remoteStore,i.targetId))})}function Ax(n,e,t){return I(this,null,function*(){let i=kx(n);try{let r=yield function(o,c){let l=K(o),u=$e.now(),f=c.reduce((w,S)=>w.add(S.key),Z()),p,g;return l.persistence.runTransaction("Locally write mutations","readwrite",w=>{let S=An(),D=Z();return l.cs.getEntries(w,f).next(P=>{S=P,S.forEach((V,j)=>{j.isValidDocument()||(D=D.add(V))})}).next(()=>l.localDocuments.getOverlayedDocuments(w,S)).next(P=>{p=P;let V=[];for(let j of c){let M=Dk(j,p.get(j.key).overlayedDocument);M!=null&&V.push(new Cn(j.key,M,aE(M.value.mapValue),xi.exists(!0)))}return l.mutationQueue.addMutationBatch(w,u,V,c)}).next(P=>{g=P;let V=P.applyToLocalDocumentSet(p,D);return l.documentOverlayCache.saveOverlays(w,P.batchId,V)})}).then(()=>({batchId:g.batchId,changes:gE(p)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,c,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new be(ce)),u=u.insert(c,l),o.Ba[o.currentUser.toKey()]=u}(i,r.batchId,t),yield aa(i,r.changes),yield nu(i.remoteStore)}catch(r){let s=Cm(r,"Failed to persist write");t.reject(s)}})}function $E(n,e){return I(this,null,function*(){let t=K(n);try{let i=yield Zk(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.Na.get(s);o&&(de(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?de(o.va):r.removedDocuments.size>0&&(de(o.va),o.va=!1))}),yield aa(t,i,e)}catch(i){yield ra(i)}})}function Kw(n,e,t){let i=K(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Fa.forEach((s,o)=>{let c=o.view.Z_(e);c.snapshot&&r.push(c.snapshot)}),function(o,c){let l=K(o);l.onlineState=c;let u=!1;l.queries.forEach((f,p)=>{for(let g of p.j_)g.Z_(c)&&(u=!0)}),u&&Sm(l)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function Cx(n,e,t){return I(this,null,function*(){let i=K(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Na.get(e),s=r&&r.key;if(s){let o=new be(z.comparator);o=o.insert(s,jt.newNoDocument(s,Q.min()));let c=Z().add(s),l=new Sl(Q.min(),new Map,new be(ce),o,c);yield $E(i,l),i.Oa=i.Oa.remove(s),i.Na.delete(e),Rm(i)}else yield jp(i.localStore,e,!1).then(()=>sm(i,e,t)).catch(ra)})}function Sx(n,e){return I(this,null,function*(){let t=K(n),i=e.batch.batchId;try{let r=yield Xk(t.localStore,e);qE(t,i,null),zE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield aa(t,r)}catch(r){yield ra(r)}})}function Rx(n,e,t){return I(this,null,function*(){let i=K(n);try{let r=yield function(o,c){let l=K(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,c).next(p=>(de(p!==null),f=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(i.localStore,e);qE(i,e,t),zE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield aa(i,r)}catch(r){yield ra(r)}})}function zE(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function qE(n,e,t){let i=K(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function sm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||WE(n,i)})}function WE(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Em(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Rm(n))}function Qw(n,e,t){for(let i of t)i instanceof jl?(n.La.addReference(i.key,e),Px(n,i)):i instanceof Bl?(F("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||WE(n,i.key)):q()}function Px(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(F("SyncEngine","New document in limbo: "+t),n.xa.add(i),Rm(n))}function Rm(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new z(Re.fromString(e)),i=n.qa.next();n.Na.set(i,new im(t)),n.Oa=n.Oa.insert(t,i),ME(n.remoteStore,new Qo(tn(vm(t.path)),i,"TargetPurposeLimboResolution",iE.oe))}}function aa(n,e,t){return I(this,null,function*(){let i=K(n),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((c,l)=>{o.push(i.Ka(l,e,t).then(u=>{var f;if((u||t)&&i.isPrimaryClient){let p=u?!u.fromCache:(f=t?.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;i.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){r.push(u);let p=Lp.Wi(l.targetId,u);s.push(p)}}))}),yield Promise.all(o),i.Ca.d_(r),yield function(l,u){return I(this,null,function*(){let f=K(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>k.forEach(u,g=>k.forEach(g.$i,w=>f.persistence.referenceDelegate.addReference(p,g.targetId,w)).next(()=>k.forEach(g.Ui,w=>f.persistence.referenceDelegate.removeReference(p,g.targetId,w)))))}catch(p){if(!sa(p))throw p;F("LocalStore","Failed to update sequence numbers: "+p)}for(let p of u){let g=p.targetId;if(!p.fromCache){let w=f.os.get(g),S=w.snapshotVersion,D=w.withLastLimboFreeSnapshotVersion(S);f.os=f.os.insert(g,D)}}})}(i.localStore,s))})}function Dx(n,e){return I(this,null,function*(){let t=K(n);if(!t.currentUser.isEqual(e)){F("SyncEngine","User change. New user:",e.toKey());let i=yield xE(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new $(N.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield aa(t,i.hs)}})}function Nx(n,e){let t=K(n),i=t.Na.get(e);if(i&&i.va)return Z().add(i.key);{let r=Z(),s=t.Ma.get(e);if(!s)return r;for(let o of s){let c=t.Fa.get(o);r=r.unionWith(c.view.Va)}return r}}function GE(n){let e=K(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=$E.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Nx.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Cx.bind(null,e),e.Ca.d_=yx.bind(null,e.eventManager),e.Ca.$a=vx.bind(null,e.eventManager),e}function kx(n){let e=K(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Sx.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Rx.bind(null,e),e}var Yw=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return I(this,null,function*(){this.serializer=eu(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return Jk(this.persistence,new Vp,t.initialUser,this.serializer)}Ga(t){return new xp(Mp.Zr,this.serializer)}Wa(t){return new Bp}terminate(){return I(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var xx=(()=>{class n{initialize(t,i){return I(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Kw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dx.bind(null,this.syncEngine),yield mx(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Xp}()}createDatastore(t){let i=eu(t.databaseInfo.databaseId),r=function(o){return new qp(o)}(t.databaseInfo);return function(o,c,l,u){return new Hp(o,c,l,u)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,s,o,c,l){return new Qp(r,s,o,c,l)}(this.localStore,this.datastore,t.asyncQueue,i=>Kw(this.syncEngine,i,0),function(){return Ol.D()?new Ol:new $p}())}createSyncEngine(t,i){return function(s,o,c,l,u,f,p){let g=new rm(s,o,c,l,u,f);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return I(this,null,function*(){var t,i;yield function(s){return I(this,null,function*(){let o=K(s);F("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield oa(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();var om=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Tn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var am=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Fe.UNAUTHENTICATED,this.clientId=Il.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>I(this,null,function*(){F("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(F("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new En;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>I(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=Cm(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function Ff(n,e){return I(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>I(this,null,function*(){i.isEqual(r)||(yield xE(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Jw(n,e){return I(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield Ox(n);F("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Ww(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>Ww(e.remoteStore,r)),n._onlineComponents=e})}function Ox(n){return I(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ff(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===N.FAILED_PRECONDITION||r.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;zr("Error using user provided cache. Falling back to memory cache: "+t),yield Ff(n,new Yw)}}else F("FirestoreClient","Using default OfflineComponentProvider"),yield Ff(n,new Yw);return n._offlineComponents})}function HE(n){return I(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F("FirestoreClient","Using user provided OnlineComponentProvider"),yield Jw(n,n._uninitializedComponentsProvider._online)):(F("FirestoreClient","Using default OnlineComponentProvider"),yield Jw(n,new xx))),n._onlineComponents})}function Mx(n){return HE(n).then(e=>e.syncEngine)}function Xw(n){return I(this,null,function*(){let e=yield HE(n),t=e.eventManager;return t.onListen=Ix.bind(null,e.syncEngine),t.onUnlisten=Tx.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wx.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bx.bind(null,e.syncEngine),t})}function KE(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Zw=new Map;function Lx(n,e,t){if(!t)throw new $(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Fx(n,e,t,i){if(e===!0&&i===!0)throw new $(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function eE(n){if(!z.isDocumentKey(n))throw new $(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Pm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q()}function Br(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new $(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Pm(n);throw new $(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var $l=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new $(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KE((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new $(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Xo=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $l({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $l(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Vf;switch(i.type){case"firstParty":return new $f(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new $(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return I(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=Zw.get(t);i&&(F("ComponentProvider","Removing Datastore"),Zw.delete(t),i.terminate())}(this),Promise.resolve()}};function QE(n,e,t,i={}){var r;let s=(n=Br(n,Xo))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&zr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let c,l;if(typeof i.mockUserToken=="string")c=i.mockUserToken,l=Fe.MOCK_USER;else{c=Uc(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new $(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Fe(u)}n._authCredentials=new Uf(new vl(c,l))}}var zl=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Rt=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Zo=class n extends zl{constructor(e,t,i){super(e,t,vm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Rt(this.firestore,null,new z(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function YE(n,e,...t){if(n=ke(n),arguments.length===1&&(e=Il.newId()),Lx("doc","path",e),n instanceof Xo){let i=Re.fromString(e,...t);return eE(i),new Rt(n,null,new z(i))}{if(!(n instanceof Rt||n instanceof Zo))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Re.fromString(e,...t));return eE(i),new Rt(n.firestore,n instanceof Zo?n.converter:null,new z(i))}}var ql=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ml(this,"async_queue_retry"),this.Vu=()=>{let i=Lf();i&&F("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=Lf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Lf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new En;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return I(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!sa(e))throw e;F("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let r=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(i);throw Tn("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let r=Yp.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&q()}verifyOperationInProgress(){}wu(){return I(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function tE(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}var ns=class extends Xo{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new ql,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return I(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new ql(e),this._firestoreClient=void 0,yield e}})}};function JE(n,e){let t=typeof n=="object"?n:_n(),i=typeof n=="string"?n:e||"(default)",r=gn(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=Vc("firestore");s&&QE(r,...s)}return r}function XE(n){if(n._terminated)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Vx(n),n._firestoreClient}function Vx(n){var e,t,i;let r=n._freezeSettings(),s=function(c,l,u,f){return new Hf(c,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,KE(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new am(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var ea=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ye.fromBase64String(e))}catch(t){throw new $(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var is=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new $(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ta=class{constructor(e){this._methodName=e}};var na=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new $(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new $(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}};var ia=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}};var Ux=/^__.*__$/;var Wl=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Cn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function ZE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var cm=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ZE(this.Cu)&&Ux.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},lm=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||eu(e)}Qu(e,t,i,r=!1){return new cm({Cu:e,methodName:t,qu:i,path:yt.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function jx(n){let e=n._freezeSettings(),t=eu(n._databaseId);return new lm(n._databaseId,!!e.ignoreUndefinedProperties,t)}var Gl=class n extends ta{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function Bx(n,e,t,i){let r=n.Qu(1,e,t);tT("Data must be an object, but it was:",r,i);let s=[],o=St.empty();Ui(i,(l,u)=>{let f=Dm(e,l,t);u=ke(u);let p=r.Nu(f);if(u instanceof Gl)s.push(f);else{let g=iu(u,p);g!=null&&(s.push(f),o.set(f,g))}});let c=new Zt(s);return new Wl(o,c,r.fieldTransforms)}function $x(n,e,t,i,r,s){let o=n.Qu(1,e,t),c=[nE(e,i,t)],l=[r];if(s.length%2!=0)throw new $(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)c.push(nE(e,s[g])),l.push(s[g+1]);let u=[],f=St.empty();for(let g=c.length-1;g>=0;--g)if(!Wx(u,c[g])){let w=c[g],S=l[g];S=ke(S);let D=o.Nu(w);if(S instanceof Gl)u.push(w);else{let P=iu(S,D);P!=null&&(u.push(w),f.set(w,P))}}let p=new Zt(u);return new Wl(f,p,o.fieldTransforms)}function iu(n,e){if(eT(n=ke(n)))return tT("Unsupported field value:",e,n),zx(n,e);if(n instanceof ta)return function(i,r){if(!ZE(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){let s=[],o=0;for(let c of i){let l=iu(c,r.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=ke(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Ak(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=$e.fromDate(i);return{timestampValue:Nl(r.serializer,s)}}if(i instanceof $e){let s=new $e(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Nl(r.serializer,s)}}if(i instanceof na)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ea)return{bytesValue:CE(r.serializer,i._byteString)};if(i instanceof Rt){let s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:wm(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof ia)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw c.Bu("VectorValues must only contain numeric values.");return Im(c.serializer,l)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${Pm(i)}`)}(n,e)}function zx(n,e){let t={};return rE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ui(n,(i,r)=>{let s=iu(r,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function eT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $e||n instanceof na||n instanceof ea||n instanceof Rt||n instanceof ta||n instanceof ia)}function tT(n,e,t){if(!eT(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=Pm(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function nE(n,e,t){if((e=ke(e))instanceof is)return e._internalPath;if(typeof e=="string")return Dm(n,e);throw Hl("Field path arguments must be of type string or ",n,!1,void 0,t)}var qx=new RegExp("[~\\*/\\[\\]]");function Dm(n,e,t){if(e.search(qx)>=0)throw Hl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new is(...e.split("."))._internalPath}catch{throw Hl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Hl(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new $(N.INVALID_ARGUMENT,c+n+l)}function Wx(n,e){return n.some(t=>t.isEqual(e))}var Kl=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new um(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(nT("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},um=class extends Kl{data(){return super.data()}};function nT(n,e){return typeof e=="string"?Dm(n,e):e instanceof is?e._internalPath:e._delegate._internalPath}function Gx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new $(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var hm=class{convertValue(e,t="none"){switch(Li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Ui(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>ye(o.doubleValue));return new ia(s)}convertGeoPoint(e){return new na(ye(e.latitude),ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=mm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Go(e));default:return null}}convertTimestamp(e){let t=bn(e);return new $e(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Re.fromString(e);de(kE(i));let r=new bl(i.get(1),i.get(3)),s=new z(i.popFirst(5));return r.isEqual(t)||Tn(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var ki=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ql=class extends Kl{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new $r(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(nT("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},$r=class extends Ql{data(e={}){return super.data(e)}},dm=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ki(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new $r(this._firestore,this._userDataWriter,i.key,i,new ki(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(c=>{let l=new $r(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ki(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new $r(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ki(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),u=-1,f=-1;return c.type!==0&&(u=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:Hx(c.type),doc:l,oldIndex:u,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Hx(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}var Yl=class extends hm{constructor(e){super(),this.firestore=e}convertBytes(e){return new ea(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Rt(this.firestore,null,t)}};function iT(n,e,t,...i){n=Br(n,Rt);let r=Br(n.firestore,ns),s=jx(r),o;return o=typeof(e=ke(e))=="string"||e instanceof is?$x(s,"updateDoc",n._key,e,t,i):Bx(s,"updateDoc",n._key,e),Kx(r,[o.toMutation(n._key,xi.exists(!0))])}function Nm(n,...e){var t,i,r;n=ke(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||tE(e[o])||(s=e[o],o++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(tE(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(i=p.error)===null||i===void 0?void 0:i.bind(p),e[o+2]=(r=p.complete)===null||r===void 0?void 0:r.bind(p)}let l,u,f;if(n instanceof Rt)u=Br(n.firestore,ns),f=vm(n._key.path),l={next:p=>{e[o]&&e[o](Qx(u,n,p))},error:e[o+1],complete:e[o+2]};else{let p=Br(n,zl);u=Br(p.firestore,ns),f=p._query;let g=new Yl(u);l={next:w=>{e[o]&&e[o](new dm(u,g,p,w))},error:e[o+1],complete:e[o+2]},Gx(n._query)}return function(g,w,S,D){let P=new om(D),V=new em(w,P,S);return g.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return gx(yield Xw(g),V)})),()=>{P.Za(),g.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return _x(yield Xw(g),V)}))}}(XE(u),f,c,l)}function Kx(n,e){return function(i,r){let s=new En;return i.asyncQueue.enqueueAndForget(()=>I(this,null,function*(){return Ax(yield Mx(i),r,s)})),s.promise}(XE(n),e)}function Qx(n,e,t){let i=t.docs.get(e._key),r=new Yl(n);return new Ql(n,r,e._key,i,new ki(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){rs=r})(_t),gt(new He("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),c=new ns(new jf(i.getProvider("auth-internal")),new qf(i.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new $(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bl(u.options.projectId,f)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),ue(bw,"4.7.3",e),ue(bw,"4.7.3","esm2017")})();var Bi=class{constructor(e){return e}},rT="firestore",km=class{constructor(){return bi(rT)}};var xm=new J("angularfire2.firestore-instances");function Yx(n,e){let t=kr(rT,n,e);return t&&new Bi(t)}function Jx(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Bi(i)}}var Xx={provide:km,deps:[[new Ae,xm]]},Zx={provide:Bi,useFactory:Yx,deps:[[new Ae,xm],Ut]};function sT(n,...e){return ue("angularfire",Ct.full,"fst"),nt([Zx,Xx,{provide:xm,useFactory:Jx(n),multi:!0,deps:[he,Mt,Yn,yn,[new Ae,Pi],[new Ae,Qn],...e]}])}var Om=Yt(YE,!0);var oT=Yt(JE,!0);var aT=Yt(iT,!0);var cT="@firebase/database",lT="1.0.8";var kg="";function eO(n){kg=n}var $m=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Le(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:br(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var zm=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return mt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var BT=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new $m(e)}}catch{}return new zm},zi=BT("localStorage"),qm=BT("sessionStorage");var ls=new bt("@firebase/database"),tO=function(){let n=1;return function(){return n++}}(),$T=function(n){let e=uI(n),t=new Mc;t.update(e);let i=t.digest();return Lc.encodeByteArray(i)},Ia=function(...n){let e="";for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Ia.apply(null,i):typeof i=="object"?e+=Le(i):e+=i,e+=" "}return e},qi=null,uT=!0,nO=function(n,e){O(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(ls.logLevel=X.VERBOSE,qi=ls.log.bind(ls),e&&qm.set("logging_enabled",!0)):typeof n=="function"?qi=n:(qi=null,qm.remove("logging_enabled"))},Je=function(...n){if(uT===!0&&(uT=!1,qi===null&&qm.get("logging_enabled")===!0&&nO(!0)),qi){let e=Ia.apply(null,n);qi(e)}},wa=function(n){return function(...e){Je(n,...e)}},Wm=function(...n){let e="FIREBASE INTERNAL ERROR: "+Ia(...n);ls.error(e)},Rn=function(...n){let e=`FIREBASE FATAL ERROR: ${Ia(...n)}`;throw ls.error(e),new Error(e)},vt=function(...n){let e="FIREBASE WARNING: "+Ia(...n);ls.warn(e)},iO=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&vt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},zT=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},rO=function(n){if(Gt()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},hs="[MIN_NAME]",Wi="[MAX_NAME]",ys=function(n,e){if(n===e)return 0;if(n===hs||e===Wi)return-1;if(e===hs||n===Wi)return 1;{let t=hT(n),i=hT(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},sO=function(n,e){return n===e?0:n<e?-1:1},ca=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Le(e))},xg=function(n){if(typeof n!="object"||n===null)return Le(n);let e=[];for(let i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=Le(e[i]),t+=":",t+=xg(n[e[i]]);return t+="}",t},qT=function(n,e){let t=n.length;if(t<=e)return[n];let i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function Nt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var WT=function(n){O(!zT(n),"Invalid JSON number");let e=11,t=52,i=(1<<e-1)-1,r,s,o,c,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(c=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=c+i,o=Math.round(n*Math.pow(2,t-c)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));let u=[];for(l=t;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(r?1:0),u.reverse();let f=u.join(""),p="";for(l=0;l<64;l+=8){let g=parseInt(f.substr(l,8),2).toString(16);g.length===1&&(g="0"+g),p=p+g}return p.toLowerCase()},oO=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},aO=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var cO=new RegExp("^-?(0*)\\d{1,10}$"),lO=-2147483648,uO=2147483647,hT=function(n){if(cO.test(n)){let e=Number(n);if(e>=lO&&e<=uO)return e}return null},Ea=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw vt("Exception was thrown by user callback.",t),e},Math.floor(0))}},hO=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},fa=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var Gm=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){vt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Hm=class{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Je("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vt(e)}},pa=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),su="5",GT="v",HT="s",KT="r",QT="f",YT=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,JT="ls",XT="p",Km="ac",ZT="websocket",eb="long_polling";var ou=class{constructor(e,t,i,r,s=!1,o="",c=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=zi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&zi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function dO(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function tb(n,e,t){O(typeof e=="string","typeof type must == string"),O(typeof t=="object","typeof params must == object");let i;if(e===ZT)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===eb)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);dO(n)&&(t.ns=n.namespace);let r=[];return Nt(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var Qm=class{constructor(){this.counters_={}}incrementCounter(e,t=1){mt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Zv(this.counters_)}};var Mm={},Lm={};function Og(n){let e=n.toString();return Mm[e]||(Mm[e]=new Qm),Mm[e]}function fO(n,e){let t=n.toString();return Lm[t]||(Lm[t]=e()),Lm[t]}var Ym=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Ea(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var dT="start",pO="close",mO="pLPCommand",gO="pRTLPCB",nb="id",ib="pw",rb="ser",_O="cb",yO="seg",vO="ts",IO="d",wO="dframe",sb=1870,ob=30,EO=sb-ob,TO=25e3,bO=3e4,Jm=class n{constructor(e,t,i,r,s,o,c){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wa(e),this.stats_=Og(t),this.urlFn=l=>(this.appCheckToken&&(l[Km]=this.appCheckToken),tb(t,eb,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ym(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(bO)),rO(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Xm((...s)=>{let[o,c,l,u,f]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===dT)this.id=c,this.password=l;else if(o===pO)c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,c]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,c)},()=>{this.onClosed_()},this.urlFn);let i={};i[dT]="t",i[rb]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[_O]=this.scriptTagHolder.uniqueCallbackIdentifier),i[GT]=su,this.transportSessionId&&(i[HT]=this.transportSessionId),this.lastSessionId&&(i[JT]=this.lastSessionId),this.applicationId&&(i[XT]=this.applicationId),this.appCheckToken&&(i[Km]=this.appCheckToken),typeof location<"u"&&location.hostname&&YT.test(location.hostname)&&(i[KT]=QT);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Gt()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!oO()&&!aO()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Le(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=Td(t),r=qT(i,EO);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Gt())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[wO]="t",i[nb]=e,i[ib]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Le(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Xm=class n{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Gt())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=tO(),window[mO+this.uniqueCallbackIdentifier]=e,window[gO+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(c){Je("frame writing exception"),c.stack&&Je(c.stack),Je(c)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Je("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[nb]=this.myID,e[ib]=this.myPW,e[rb]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ob+i.length<=sb;){let o=this.pendingSegs.shift();i=i+"&"+yO+r+"="+o.seg+"&"+vO+r+"="+o.ts+"&"+IO+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(TO)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){Gt()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Je("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var AO=16384,CO=45e3,au=null;typeof MozWebSocket<"u"?au=MozWebSocket:typeof WebSocket<"u"&&(au=WebSocket);var la=(()=>{class n{constructor(t,i,r,s,o,c,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wa(this.connId),this.stats_=Og(i),this.connURL=n.connectionURL_(i,c,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){let c={};return c[GT]=su,!Gt()&&typeof location<"u"&&location.hostname&&YT.test(location.hostname)&&(c[KT]=QT),i&&(c[HT]=i),r&&(c[JT]=r),s&&(c[Km]=s),o&&(c[XT]=o),tb(t,ZT,c)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,zi.set("previous_websocket_failure",!0);try{let r;if(Gt()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${su}/${kg}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,c=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;c&&(r.proxy={origin:c})}this.mySock=new au(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&au!==null&&!n.forceDisallow_}static previouslyFailed(){return zi.isInMemoryStorage||zi.get("previous_websocket_failure")===!0}markConnectionHealthy(){zi.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=br(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(O(this.frames===null,"We already have a frame buffer"),t.length<=6){let i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let i=Le(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=qT(i,AO);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(CO))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),SO=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Jm,la]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let i=la&&la.isAvailable(),r=i&&!la.previouslyFailed();if(t.webSocketOnly&&(i||vt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[la];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),RO=6e4,PO=5e3,DO=10*1024,NO=100*1024,Fm="t",fT="d",kO="s",pT="r",xO="e",mT="o",gT="a",_T="n",yT="p",OO="h",Zm=class{constructor(e,t,i,r,s,o,c,l,u,f){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=c,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wa("c:"+this.id+":"),this.transportManager_=new SO(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=fa(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>NO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>DO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Fm in e){let t=e[Fm];t===gT?this.upgradeIfSecondaryHealthy_():t===pT?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===mT&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=ca("t",e),i=ca("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yT,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:gT,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:_T,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=ca("t",e),i=ca("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=ca(Fm,e);if(fT in e){let i=e[fT];if(t===OO){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===_T){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===kO?this.onConnectionShutdown_(i):t===pT?this.onReset_(i):t===xO?Wm("Server Error: "+i):t===mT?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Wm("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),su!==i&&vt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),fa(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(RO))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fa(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(PO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yT,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(zi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var cu=class{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}};var lu=class{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){O(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var uu=class n extends lu{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!bo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var vT=32,IT=768,me=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function fe(){return new me("")}function re(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function si(n){return n.pieces_.length-n.pieceNum_}function _e(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new me(n.pieces_,e)}function ab(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function MO(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function cb(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function lb(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new me(e,0)}function Ve(n,e){let t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof me)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new me(t,0)}function te(n){return n.pieceNum_>=n.pieces_.length}function Pt(n,e){let t=re(n),i=re(e);if(t===null)return e;if(t===i)return Pt(_e(n),_e(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ub(n,e){if(si(n)!==si(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function $t(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(si(n)>si(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}var eg=class{constructor(e,t){this.errorPrefix_=t,this.parts_=cb(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=So(this.parts_[i]);hb(this)}};function LO(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=So(e),hb(n)}function FO(n){let e=n.parts_.pop();n.byteLength_-=So(e),n.parts_.length>0&&(n.byteLength_-=1)}function hb(n){if(n.byteLength_>IT)throw new Error(n.errorPrefix_+"has a key path longer than "+IT+" bytes ("+n.byteLength_+").");if(n.parts_.length>vT)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+vT+") or object contains a cycle "+$i(n))}function $i(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var tg=class n extends lu{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new n}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}};var ua=1e3,VO=60*5*1e3,wT=30*1e3,UO=1.3,jO=3e4,BO="server_kill",ET=3,Mg=(()=>{class n extends cu{constructor(t,i,r,s,o,c,l,u){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=wa("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ua,this.maxReconnectDelay_=VO,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Gt())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");tg.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&uu.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){let s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_(Le(o)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();let i=new _i,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:c=>{let l=c.d;c.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();let o=t._queryIdentifier,c=t._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),O(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(c).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){let i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},c="q";t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(c,o,l=>{let u=l.d,f=l.s;n.warnOnListenWarnings_(u,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),f!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(f,u))})}static warnOnListenWarnings_(t,i){if(t&&typeof t=="object"&&mt(t,"w")){let r=vi(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();vt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||cI(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wT)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,i=aI(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,c=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let i=t.s,r=t.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){let r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),O(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);let o={p:t},c="n";s&&(o.q=r,o.t=s),this.sendRequest(c,o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();let c={p:i,d:r};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:t,request:c,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(t){let i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Le(t));let i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),t==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):t==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):t==="c"?this.onListenRevoked_(i.p,i.q):t==="ac"?this.onAuthRevoked_(i.s,i.d):t==="apc"?this.onAppCheckRevoked_(i.s,i.d):t==="sd"?this.onSecurityDebugPacket_(i):Wm("Unrecognized action received from server: "+Le(t)+`
Are you using the latest client?`)}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>jO&&(this.reconnectDelay_=ua),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*UO)}this.onConnectStatus_(!1)}establishConnection_(){return I(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,c=!1,l=null,u=function(){l?l.close():(c=!0,r())},f=function(g){O(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(g)};this.realtime_={close:u,sendRequest:f};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,w]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);c?Je("getToken() completed but was canceled"):(Je("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=w&&w.token,l=new Zm(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,i,r,S=>{vt(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(BO)},o))}catch(g){this.log_("Failed to get token: "+g),c||(this.repoInfo_.nodeAdmin&&vt(g),u())}}})}interrupt(t){Je("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Je("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Ao(this.interruptReasons_)&&(this.reconnectDelay_=ua,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let i=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;i?r=i.map(o=>xg(o)).join("$"):r="default";let s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){let r=new me(t).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){Je("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ET&&(this.reconnectDelay_=wT,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){Je("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ET&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},i="js";Gt()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),t["sdk."+i+"."+kg.replace(/\./g,"-")]=1,bo()?t["framework.cordova"]=1:jc()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=uu.getInstance().currentlyOnline();return Ao(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),se=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var ds=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new se(hs,e),r=new se(hs,t);return this.compare(i,r)!==0}minPost(){return se.MIN}};var ru,hu=class extends ds{static get __EMPTY_NODE(){return ru}static set __EMPTY_NODE(e){ru=e}compare(e,t){return ys(e.name,t.name)}isDefinedOn(e){throw yi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return se.MIN}maxPost(){return new se(Wi,ru)}makePost(e,t){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new se(e,ru)}toString(){return".key"}},us=new hu;var as=class{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Bt=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??Dt.EMPTY_NODE,this.right=o??Dt.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Dt.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(t,r.key)===0){if(r.right.isEmpty())return Dt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),ng=class{copy(e,t,i,r,s){return this}insert(e,t,i){return new Bt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Dt=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Bt.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bt.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new as(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new as(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new as(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new as(this.root_,null,this.comparator_,!0,e)}};Dt.EMPTY_NODE=new ng;function $O(n,e){return ys(n.name,e.name)}function Lg(n,e){return ys(n,e)}var ig;function zO(n){ig=n}var db=function(n){return typeof n=="number"?"number:"+WT(n):"string:"+n},fb=function(n){if(n.isLeafNode()){let e=n.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&mt(e,".sv"),"Priority must be a string or number.")}else O(n===ig||n.isEmpty(),"priority of unexpected type.");O(n===ig||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var TT,fs=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),fb(this.priorityNode_)}static set __childrenNodeConstructor(t){TT=t}static get __childrenNodeConstructor(){return TT}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return te(t)?this:re(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return t===".priority"?this.updatePriority(i):i.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){let r=re(t);return r===null?i:i.isEmpty()&&r!==".priority"?this:(O(r!==".priority"||si(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(_e(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+db(this.priorityNode_.val())+":");let i=typeof this.value_;t+=i+":",i==="number"?t+=WT(this.value_):t+=this.value_,this.lazyHash_=$T(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(O(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return O(s>=0,"Unknown leaf type: "+i),O(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),pb,mb;function qO(n){pb=n}function WO(n){mb=n}var rg=class extends ds{compare(e,t){let i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?ys(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return se.MIN}maxPost(){return new se(Wi,new fs("[PRIORITY-POST]",mb))}makePost(e,t){let i=pb(e);return new se(t,new fs("[PRIORITY-POST]",i))}toString(){return".priority"}},Ze=new rg;var GO=Math.log(2),sg=class{constructor(e){let t=s=>parseInt(Math.log(s)/GO,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},du=function(n,e,t,i){n.sort(e);let r=function(l,u){let f=u-l,p,g;if(f===0)return null;if(f===1)return p=n[l],g=t?t(p):p,new Bt(g,p.node,Bt.BLACK,null,null);{let w=parseInt(f/2,10)+l,S=r(l,w),D=r(w+1,u);return p=n[w],g=t?t(p):p,new Bt(g,p.node,Bt.BLACK,S,D)}},s=function(l){let u=null,f=null,p=n.length,g=function(S,D){let P=p-S,V=p;p-=S;let j=r(P+1,V),M=n[P],oe=t?t(M):M;w(new Bt(oe,M.node,D,null,j))},w=function(S){u?(u.left=S,u=S):(f=S,u=S)};for(let S=0;S<l.count;++S){let D=l.nextBitIsOne(),P=Math.pow(2,l.count-(S+1));D?g(P,Bt.BLACK):(g(P,Bt.BLACK),g(P,Bt.RED))}return f},o=new sg(n.length),c=s(o);return new Dt(i||e,c)};var Vm,os={},ps=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return O(os&&Ze,"ChildrenNode.ts has not been loaded"),Vm=Vm||new n({".priority":os},{".priority":Ze}),Vm}get(e){let t=vi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Dt?t:null}hasIndex(e){return mt(this.indexSet_,e.toString())}addIndex(e,t){O(e!==us,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=t.getIterator(se.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let c;r?c=du(i,e.getCompare()):c=os;let l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;let f=Object.assign({},this.indexes_);return f[l]=c,new n(f,u)}addToIndexes(e,t){let i=Co(this.indexes_,(r,s)=>{let o=vi(this.indexSet_,s);if(O(o,"Missing index implementation for "+s),r===os)if(o.isDefinedOn(e.node)){let c=[],l=t.getIterator(se.Wrap),u=l.getNext();for(;u;)u.name!==e.name&&c.push(u),u=l.getNext();return c.push(e),du(c,o.getCompare())}else return os;else{let c=t.get(e.name),l=r;return c&&(l=l.remove(new se(e.name,c))),l.insert(e,e.node)}});return new n(i,this.indexSet_)}removeFromIndexes(e,t){let i=Co(this.indexes_,r=>{if(r===os)return r;{let s=t.get(e.name);return s?r.remove(new se(e.name,s)):r}});return new n(i,this.indexSet_)}};var ha,Ie=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&fb(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ha||(ha=new n(new Dt(Lg),null,ps.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ha}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let i=this.children_.get(t);return i===null?ha:i}}getChild(t){let i=re(t);return i===null?this:this.getImmediateChild(i).getChild(_e(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,i){if(O(i,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(i);{let r=new se(t,i),s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));let c=s.isEmpty()?ha:this.priorityNode_;return new n(s,c,o)}}updateChild(t,i){let r=re(t);if(r===null)return i;{O(re(t)!==".priority"||si(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(_e(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(Ze,(c,l)=>{i[c]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!t&&o&&s<2*r){let c=[];for(let l in i)c[l]=i[l];return c}else return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+db(this.getPriority().val())+":"),this.forEachChild(Ze,(i,r)=>{let s=r.hash();s!==""&&(t+=":"+i+":"+s)}),this.lazyHash_=t===""?"":$T(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new se(t,i));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let i=this.getFirstChildName(t);return i?new se(i,this.children_.get(i)):null}getLastChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let i=this.getLastChildName(t);return i?new se(i,this.children_.get(i)):null}forEachChild(t,i){let r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,se.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,se.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ta?-1:0}withIndex(t){if(t===us||this.indexMap_.hasIndex(t))return this;{let i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===us||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let i=t;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(Ze),s=i.getIterator(Ze),o=r.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=r.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(t){return t===us?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),og=class extends Ie{constructor(){super(new Dt(Lg),Ie.EMPTY_NODE,ps.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ie.EMPTY_NODE}isEmpty(){return!1}},Ta=new og;Object.defineProperties(se,{MIN:{value:new se(hs,Ie.EMPTY_NODE)},MAX:{value:new se(Wi,Ta)}});hu.__EMPTY_NODE=Ie.EMPTY_NODE;fs.__childrenNodeConstructor=Ie;zO(Ta);WO(Ta);var HO=!0;function Xe(n,e=null){if(n===null)return Ie.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new fs(t,Xe(e))}if(!(n instanceof Array)&&HO){let t=[],i=!1;if(Nt(n,(o,c)=>{if(o.substring(0,1)!=="."){let l=Xe(c);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new se(o,l)))}}),t.length===0)return Ie.EMPTY_NODE;let s=du(t,$O,o=>o.name,Lg);if(i){let o=du(t,Ze.getCompare());return new Ie(s,Xe(e),new ps({".priority":o},{".priority":Ze}))}else return new Ie(s,Xe(e),ps.Default)}else{let t=Ie.EMPTY_NODE;return Nt(n,(i,r)=>{if(mt(n,i)&&i.substring(0,1)!=="."){let s=Xe(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(Xe(e))}}qO(Xe);var ag=class extends ds{constructor(e){super(),this.indexPath_=e,O(!te(e)&&re(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?ys(e.name,t.name):s}makePost(e,t){let i=Xe(e),r=Ie.EMPTY_NODE.updateChild(this.indexPath_,i);return new se(t,r)}maxPost(){let e=Ie.EMPTY_NODE.updateChild(this.indexPath_,Ta);return new se(Wi,e)}toString(){return cb(this.indexPath_,0).join("/")}};var cg=class extends ds{compare(e,t){let i=e.node.compareTo(t.node);return i===0?ys(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return se.MIN}maxPost(){return se.MAX}makePost(e,t){let i=Xe(e);return new se(t,i)}toString(){return".value"}},KO=new cg;function QO(n){return{type:"value",snapshotNode:n}}function YO(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function JO(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function bT(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function XO(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var lg=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ze}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:hs}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Wi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ze}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function AT(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ze?t="$priority":n.index_===KO?t="$value":n.index_===us?t="$key":(O(n.index_ instanceof ag,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Le(t),n.startSet_){let i=n.startAfterSet_?"startAfter":"startAt";e[i]=Le(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+Le(n.indexStartName_))}if(n.endSet_){let i=n.endBeforeSet_?"endBefore":"endAt";e[i]=Le(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+Le(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function CT(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ze&&(e.i=n.index_.toString()),e}var ug=class n extends cu{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=wa("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,i),c={};this.listens_[o]=c;let l=AT(e._queryParams);this.restRequest_(s+".json",l,(u,f)=>{let p=f;if(u===404&&(p=null,u=null),u===null&&this.onDataUpdate_(s,p,!1,i),vi(this.listens_,o)===c){let g;u?u===401?g="permission_denied":g="rest_error:"+u:g="ok",r(g,null)}})}unlisten(e,t){let i=n.getListenId_(e,t);delete this.listens_[i]}get(e){let t=AT(e._queryParams),i=e._path.toString(),r=new _i;return this.restRequest_(i+".json",t,(s,o)=>{let c=o;s===404&&(c=null,s=null),s===null?(this.onDataUpdate_(i,c,!1,null),r.resolve(c)):r.reject(new Error(c))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+wi(t);this.log_("Sending REST request for "+o);let c=new XMLHttpRequest;c.onreadystatechange=()=>{if(i&&c.readyState===4){this.log_("REST Response for "+o+" received. status:",c.status,"response:",c.responseText);let l=null;if(c.status>=200&&c.status<300){try{l=br(c.responseText)}catch{vt("Failed to parse JSON response for "+o+": "+c.responseText)}i(null,l)}else c.status!==401&&c.status!==404&&vt("Got unsuccessful REST response for "+o+" Status: "+c.status),i(c.status);i=null}},c.open("GET",o,!0),c.send()})}};var hg=class{constructor(){this.rootNode_=Ie.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function fu(){return{value:null,children:new Map}}function gb(n,e,t){if(te(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let i=re(e);n.children.has(i)||n.children.set(i,fu());let r=n.children.get(i);e=_e(e),gb(r,e,t)}}function dg(n,e,t){n.value!==null?t(e,n.value):ZO(n,(i,r)=>{let s=new me(e.toString()+"/"+i);dg(r,s,t)})}function ZO(n,e){n.children.forEach((t,i)=>{e(i,t)})}var fg=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Nt(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}};var ST=10*1e3,eM=30*1e3,tM=5*60*1e3,pg=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new fg(e);let i=ST+(eM-ST)*Math.random();fa(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;Nt(e,(r,s)=>{s>0&&mt(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),fa(this.reportStats_.bind(this),Math.floor(Math.random()*2*tM))}};var Sn=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Sn||{});function _b(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yb(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vb(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var mg=class n{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Sn.ACK_USER_WRITE,this.source=_b()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new me(e));return new n(fe(),t,this.revert)}}else return O(re(this.path)===e,"operationForChild called for unrelated child."),new n(_e(this.path),this.affectedTree,this.revert)}};var ms=class n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Sn.OVERWRITE}operationForChild(e){return te(this.path)?new n(this.source,fe(),this.snap.getImmediateChild(e)):new n(this.source,_e(this.path),this.snap)}};var pu=class n{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Sn.MERGE}operationForChild(e){if(te(this.path)){let t=this.children.subtree(new me(e));return t.isEmpty()?null:t.value?new ms(this.source,fe(),t.value):new n(this.source,fe(),t)}else return O(re(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,_e(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var _a=class{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;let t=re(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function nM(n,e,t,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(XO(o.childName,o.snapshotNode))}),da(n,r,"child_removed",e,i,t),da(n,r,"child_added",e,i,t),da(n,r,"child_moved",s,i,t),da(n,r,"child_changed",e,i,t),da(n,r,"value",e,i,t),r}function da(n,e,t,i,r,s){let o=i.filter(c=>c.type===t);o.sort((c,l)=>rM(n,c,l)),o.forEach(c=>{let l=iM(n,c,s);r.forEach(u=>{u.respondsTo(c.type)&&e.push(u.createEvent(l,n.query_))})})}function iM(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function rM(n,e,t){if(e.childName==null||t.childName==null)throw yi("Should only compare child_ events.");let i=new se(e.childName,e.snapshotNode),r=new se(t.childName,t.snapshotNode);return n.index_.compare(i,r)}function Ib(n,e){return{eventCache:n,serverCache:e}}function ma(n,e,t,i){return Ib(new _a(e,t,i),n.serverCache)}function wb(n,e,t,i){return Ib(n.eventCache,new _a(e,t,i))}function gg(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Gi(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var Um,sM=()=>(Um||(Um=new Dt(sO)),Um),ot=class n{constructor(e,t=sM()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return Nt(e,(i,r)=>{t=t.set(new me(i),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:fe(),value:this.value};if(te(e))return null;{let i=re(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(_e(e),t);return s!=null?{path:Ve(new me(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{let t=re(e),i=this.children.get(t);return i!==null?i.subtree(_e(e)):new n(null)}}set(e,t){if(te(e))return new n(t,this.children);{let i=re(e),s=(this.children.get(i)||new n(null)).set(_e(e),t),o=this.children.insert(i,s);return new n(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=re(e),i=this.children.get(t);if(i){let r=i.remove(_e(e)),s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(te(e))return this.value;{let t=re(e),i=this.children.get(t);return i?i.get(_e(e)):null}}setTree(e,t){if(te(e))return t;{let i=re(e),s=(this.children.get(i)||new n(null)).setTree(_e(e),t),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new n(this.value,o)}}fold(e){return this.fold_(fe(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Ve(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,fe(),t)}findOnPath_(e,t,i){let r=this.value?i(t,this.value):!1;if(r)return r;if(te(e))return null;{let s=re(e),o=this.children.get(s);return o?o.findOnPath_(_e(e),Ve(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,fe(),t)}foreachOnPath_(e,t,i){if(te(e))return this;{this.value&&i(t,this.value);let r=re(e),s=this.children.get(r);return s?s.foreachOnPath_(_e(e),Ve(t,r),i):new n(null)}}foreach(e){this.foreach_(fe(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Ve(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}};var zt=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new ot(null))}};function ga(n,e,t){if(te(e))return new zt(new ot(t));{let i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=Pt(r,e);return s=s.updateChild(o,t),new zt(n.writeTree_.set(r,s))}else{let r=new ot(t),s=n.writeTree_.setTree(e,r);return new zt(s)}}}function RT(n,e,t){let i=n;return Nt(t,(r,s)=>{i=ga(i,Ve(e,r),s)}),i}function PT(n,e){if(te(e))return zt.empty();{let t=n.writeTree_.setTree(e,new ot(null));return new zt(t)}}function _g(n,e){return Hi(n,e)!=null}function Hi(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Pt(t.path,e)):null}function DT(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ze,(i,r)=>{e.push(new se(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new se(i,r.value))}),e}function ri(n,e){if(te(e))return n;{let t=Hi(n,e);return t!=null?new zt(new ot(t)):new zt(n.writeTree_.subtree(e))}}function yg(n){return n.writeTree_.isEmpty()}function gs(n,e){return Eb(fe(),n.writeTree_,e)}function Eb(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(O(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=Eb(Ve(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(Ve(n,".priority"),i)),t}}function Tb(n,e){return Rb(e,n)}function oM(n,e,t,i,r){O(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=ga(n.visibleWrites,e,t)),n.lastWriteId=i}function aM(n,e){for(let t=0;t<n.allWrites.length;t++){let i=n.allWrites[t];if(i.writeId===e)return i}return null}function cM(n,e){let t=n.allWrites.findIndex(c=>c.writeId===e);O(t>=0,"removeWrite called with nonexistent writeId.");let i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){let c=n.allWrites[o];c.visible&&(o>=t&&lM(c,i.path)?r=!1:$t(i.path,c.path)&&(s=!0)),o--}if(r){if(s)return uM(n),!0;if(i.snap)n.visibleWrites=PT(n.visibleWrites,i.path);else{let c=i.children;Nt(c,l=>{n.visibleWrites=PT(n.visibleWrites,Ve(i.path,l))})}return!0}else return!1}function lM(n,e){if(n.snap)return $t(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&$t(Ve(n.path,t),e))return!0;return!1}function uM(n){n.visibleWrites=bb(n.allWrites,hM,fe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function hM(n){return n.visible}function bb(n,e,t){let i=zt.empty();for(let r=0;r<n.length;++r){let s=n[r];if(e(s)){let o=s.path,c;if(s.snap)$t(t,o)?(c=Pt(t,o),i=ga(i,c,s.snap)):$t(o,t)&&(c=Pt(o,t),i=ga(i,fe(),s.snap.getChild(c)));else if(s.children){if($t(t,o))c=Pt(t,o),i=RT(i,c,s.children);else if($t(o,t))if(c=Pt(o,t),te(c))i=RT(i,fe(),s.children);else{let l=vi(s.children,re(c));if(l){let u=l.getChild(_e(c));i=ga(i,fe(),u)}}}else throw yi("WriteRecord should have .snap or .children")}}return i}function Ab(n,e,t,i,r){if(!i&&!r){let s=Hi(n.visibleWrites,e);if(s!=null)return s;{let o=ri(n.visibleWrites,e);if(yg(o))return t;if(t==null&&!_g(o,fe()))return null;{let c=t||Ie.EMPTY_NODE;return gs(o,c)}}}else{let s=ri(n.visibleWrites,e);if(!r&&yg(s))return t;if(!r&&t==null&&!_g(s,fe()))return null;{let o=function(u){return(u.visible||r)&&(!i||!~i.indexOf(u.writeId))&&($t(u.path,e)||$t(e,u.path))},c=bb(n.allWrites,o,e),l=t||Ie.EMPTY_NODE;return gs(c,l)}}}function dM(n,e,t){let i=Ie.EMPTY_NODE,r=Hi(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ze,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){let s=ri(n.visibleWrites,e);return t.forEachChild(Ze,(o,c)=>{let l=gs(ri(s,new me(o)),c);i=i.updateImmediateChild(o,l)}),DT(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=ri(n.visibleWrites,e);return DT(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function fM(n,e,t,i,r){O(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=Ve(e,t);if(_g(n.visibleWrites,s))return null;{let o=ri(n.visibleWrites,s);return yg(o)?r.getChild(t):gs(o,r.getChild(t))}}function pM(n,e,t,i){let r=Ve(e,t),s=Hi(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){let o=ri(n.visibleWrites,r);return gs(o,i.getNode().getImmediateChild(t))}else return null}function mM(n,e){return Hi(n.visibleWrites,e)}function gM(n,e,t,i,r,s,o){let c,l=ri(n.visibleWrites,e),u=Hi(l,fe());if(u!=null)c=u;else if(t!=null)c=gs(l,t);else return[];if(c=c.withIndex(o),!c.isEmpty()&&!c.isLeafNode()){let f=[],p=o.getCompare(),g=s?c.getReverseIteratorFrom(i,o):c.getIteratorFrom(i,o),w=g.getNext();for(;w&&f.length<r;)p(w,i)!==0&&f.push(w),w=g.getNext();return f}else return[]}function _M(){return{visibleWrites:zt.empty(),allWrites:[],lastWriteId:-1}}function vg(n,e,t,i){return Ab(n.writeTree,n.treePath,e,t,i)}function Cb(n,e){return dM(n.writeTree,n.treePath,e)}function NT(n,e,t,i){return fM(n.writeTree,n.treePath,e,t,i)}function mu(n,e){return mM(n.writeTree,Ve(n.treePath,e))}function yM(n,e,t,i,r,s){return gM(n.writeTree,n.treePath,e,t,i,r,s)}function Fg(n,e,t){return pM(n.writeTree,n.treePath,e,t)}function Sb(n,e){return Rb(Ve(n.treePath,e),n.writeTree)}function Rb(n,e){return{treePath:n,writeTree:e}}var Ig=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;O(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),O(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,bT(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,JO(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,YO(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,bT(i,e.snapshotNode,r.oldSnap));else throw yi("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var wg=class{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}},Pb=new wg,ya=class{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new _a(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Fg(this.writes_,e,i)}}getChildAfterChild(e,t,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Gi(this.viewCache_),s=yM(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}};function vM(n,e){O(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function IM(n,e,t,i,r){let s=new Ig,o,c;if(t.type===Sn.OVERWRITE){let u=t;u.source.fromUser?o=Eg(n,e,u.path,u.snap,i,r,s):(O(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered()&&!te(u.path),o=gu(n,e,u.path,u.snap,i,r,c,s))}else if(t.type===Sn.MERGE){let u=t;u.source.fromUser?o=EM(n,e,u.path,u.children,i,r,s):(O(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered(),o=Tg(n,e,u.path,u.children,i,r,c,s))}else if(t.type===Sn.ACK_USER_WRITE){let u=t;u.revert?o=AM(n,e,u.path,i,r,s):o=TM(n,e,u.path,u.affectedTree,i,r,s)}else if(t.type===Sn.LISTEN_COMPLETE)o=bM(n,e,t.path,i,s);else throw yi("Unknown operation type: "+t.type);let l=s.getChanges();return wM(e,o,l),{viewCache:o,changes:l}}function wM(n,e,t){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=gg(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(QO(gg(e)))}}function Db(n,e,t,i,r,s){let o=e.eventCache;if(mu(i,t)!=null)return e;{let c,l;if(te(t))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Gi(e),f=u instanceof Ie?u:Ie.EMPTY_NODE,p=Cb(i,f);c=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let u=vg(i,Gi(e));c=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=re(t);if(u===".priority"){O(si(t)===1,"Can't have a priority with additional path components");let f=o.getNode();l=e.serverCache.getNode();let p=NT(i,t,f,l);p!=null?c=n.filter.updatePriority(f,p):c=o.getNode()}else{let f=_e(t),p;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();let g=NT(i,t,o.getNode(),l);g!=null?p=o.getNode().getImmediateChild(u).updateChild(f,g):p=o.getNode().getImmediateChild(u)}else p=Fg(i,u,e.serverCache);p!=null?c=n.filter.updateChild(o.getNode(),u,p,f,r,s):c=o.getNode()}}return ma(e,c,o.isFullyInitialized()||te(t),n.filter.filtersNodes())}}function gu(n,e,t,i,r,s,o,c){let l=e.serverCache,u,f=o?n.filter:n.filter.getIndexedFilter();if(te(t))u=f.updateFullNode(l.getNode(),i,null);else if(f.filtersNodes()&&!l.isFiltered()){let w=l.getNode().updateChild(t,i);u=f.updateFullNode(l.getNode(),w,null)}else{let w=re(t);if(!l.isCompleteForPath(t)&&si(t)>1)return e;let S=_e(t),P=l.getNode().getImmediateChild(w).updateChild(S,i);w===".priority"?u=f.updatePriority(l.getNode(),P):u=f.updateChild(l.getNode(),w,P,S,Pb,null)}let p=wb(e,u,l.isFullyInitialized()||te(t),f.filtersNodes()),g=new ya(r,p,s);return Db(n,p,t,r,g,c)}function Eg(n,e,t,i,r,s,o){let c=e.eventCache,l,u,f=new ya(r,e,s);if(te(t))u=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=ma(e,u,!0,n.filter.filtersNodes());else{let p=re(t);if(p===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),i),l=ma(e,u,c.isFullyInitialized(),c.isFiltered());else{let g=_e(t),w=c.getNode().getImmediateChild(p),S;if(te(g))S=i;else{let D=f.getCompleteChild(p);D!=null?ab(g)===".priority"&&D.getChild(lb(g)).isEmpty()?S=D:S=D.updateChild(g,i):S=Ie.EMPTY_NODE}if(w.equals(S))l=e;else{let D=n.filter.updateChild(c.getNode(),p,S,g,f,o);l=ma(e,D,c.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function kT(n,e){return n.eventCache.isCompleteForChild(e)}function EM(n,e,t,i,r,s,o){let c=e;return i.foreach((l,u)=>{let f=Ve(t,l);kT(e,re(f))&&(c=Eg(n,c,f,u,r,s,o))}),i.foreach((l,u)=>{let f=Ve(t,l);kT(e,re(f))||(c=Eg(n,c,f,u,r,s,o))}),c}function xT(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Tg(n,e,t,i,r,s,o,c){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;te(t)?u=i:u=new ot(null).setTree(t,i);let f=e.serverCache.getNode();return u.children.inorderTraversal((p,g)=>{if(f.hasChild(p)){let w=e.serverCache.getNode().getImmediateChild(p),S=xT(n,w,g);l=gu(n,l,new me(p),S,r,s,o,c)}}),u.children.inorderTraversal((p,g)=>{let w=!e.serverCache.isCompleteForChild(p)&&g.value===null;if(!f.hasChild(p)&&!w){let S=e.serverCache.getNode().getImmediateChild(p),D=xT(n,S,g);l=gu(n,l,new me(p),D,r,s,o,c)}}),l}function TM(n,e,t,i,r,s,o){if(mu(r,t)!=null)return e;let c=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(te(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return gu(n,e,t,l.getNode().getChild(t),r,s,c,o);if(te(t)){let u=new ot(null);return l.getNode().forEachChild(us,(f,p)=>{u=u.set(new me(f),p)}),Tg(n,e,t,u,r,s,c,o)}else return e}else{let u=new ot(null);return i.foreach((f,p)=>{let g=Ve(t,f);l.isCompleteForPath(g)&&(u=u.set(f,l.getNode().getChild(g)))}),Tg(n,e,t,u,r,s,c,o)}}function bM(n,e,t,i,r){let s=e.serverCache,o=wb(e,s.getNode(),s.isFullyInitialized()||te(t),s.isFiltered());return Db(n,o,t,i,Pb,r)}function AM(n,e,t,i,r,s){let o;if(mu(i,t)!=null)return e;{let c=new ya(i,e,r),l=e.eventCache.getNode(),u;if(te(t)||re(t)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=vg(i,Gi(e));else{let p=e.serverCache.getNode();O(p instanceof Ie,"serverChildren would be complete if leaf node"),f=Cb(i,p)}f=f,u=n.filter.updateFullNode(l,f,s)}else{let f=re(t),p=Fg(i,f,e.serverCache);p==null&&e.serverCache.isCompleteForChild(f)&&(p=l.getImmediateChild(f)),p!=null?u=n.filter.updateChild(l,f,p,_e(t),c,s):e.eventCache.getNode().hasChild(f)?u=n.filter.updateChild(l,f,Ie.EMPTY_NODE,_e(t),c,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=vg(i,Gi(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||mu(i,fe())!=null,ma(e,u,o,n.filter.filtersNodes())}}function CM(n,e){let t=Gi(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!te(e)&&!t.getImmediateChild(re(e)).isEmpty())?t.getChild(e):null}function OT(n,e,t,i){e.type===Sn.MERGE&&e.source.queryId!==null&&(O(Gi(n.viewCache_),"We should always have a full cache before handling merges"),O(gg(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,s=IM(n.processor_,r,e,t,i);return vM(n.processor_,s.viewCache),O(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,SM(n,s.changes,s.viewCache.eventCache.getNode(),null)}function SM(n,e,t,i){let r=i?[i]:n.eventRegistrations_;return nM(n.eventGenerator_,e,t,r)}var MT;function RM(n){O(!MT,"__referenceConstructor has already been defined"),MT=n}function Vg(n,e,t,i){let r=e.source.queryId;if(r!==null){let s=n.views.get(r);return O(s!=null,"SyncTree gave us an op for an invalid query."),OT(s,e,t,i)}else{let s=[];for(let o of n.views.values())s=s.concat(OT(o,e,t,i));return s}}function Ug(n,e){let t=null;for(let i of n.views.values())t=t||CM(i,e);return t}var LT;function PM(n){O(!LT,"__referenceConstructor has already been defined"),LT=n}var _u=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ot(null),this.pendingWriteTree_=_M(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function DM(n,e,t,i,r){return oM(n.pendingWriteTree_,e,t,i,r),r?vu(n,new ms(_b(),e,t)):[]}function cs(n,e,t=!1){let i=aM(n.pendingWriteTree_,e);if(cM(n.pendingWriteTree_,e)){let s=new ot(null);return i.snap!=null?s=s.set(fe(),!0):Nt(i.children,o=>{s=s.set(new me(o),!0)}),vu(n,new mg(i.path,s,t))}else return[]}function yu(n,e,t){return vu(n,new ms(yb(),e,t))}function NM(n,e,t){let i=ot.fromObject(t);return vu(n,new pu(yb(),e,i))}function kM(n,e,t,i){let r=Ob(n,i);if(r!=null){let s=Mb(r),o=s.path,c=s.queryId,l=Pt(o,e),u=new ms(vb(c),l,t);return Lb(n,o,u)}else return[]}function xM(n,e,t,i){let r=Ob(n,i);if(r){let s=Mb(r),o=s.path,c=s.queryId,l=Pt(o,e),u=ot.fromObject(t),f=new pu(vb(c),l,u);return Lb(n,o,f)}else return[]}function Nb(n,e,t){let r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,c)=>{let l=Pt(o,e),u=Ug(c,l);if(u)return u});return Ab(r,e,s,t,!0)}function vu(n,e){return kb(e,n.syncPointTree_,null,Tb(n.pendingWriteTree_,fe()))}function kb(n,e,t,i){if(te(n.path))return xb(n,e,t,i);{let r=e.get(fe());t==null&&r!=null&&(t=Ug(r,fe()));let s=[],o=re(n.path),c=n.operationForChild(o),l=e.children.get(o);if(l&&c){let u=t?t.getImmediateChild(o):null,f=Sb(i,o);s=s.concat(kb(c,l,u,f))}return r&&(s=s.concat(Vg(r,n,i,t))),s}}function xb(n,e,t,i){let r=e.get(fe());t==null&&r!=null&&(t=Ug(r,fe()));let s=[];return e.children.inorderTraversal((o,c)=>{let l=t?t.getImmediateChild(o):null,u=Sb(i,o),f=n.operationForChild(o);f&&(s=s.concat(xb(f,c,l,u)))}),r&&(s=s.concat(Vg(r,n,i,t))),s}function Ob(n,e){return n.tagToQueryMap.get(e)}function Mb(n){let e=n.indexOf("$");return O(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new me(n.substr(0,e))}}function Lb(n,e,t){let i=n.syncPointTree_.get(e);O(i,"Missing sync point for query tag that we're tracking");let r=Tb(n.pendingWriteTree_,e);return Vg(i,t,r,null)}var bg=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},Ag=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Ve(this.path_,e);return new n(this.syncTree_,t)}node(){return Nb(this.syncTree_,this.path_)}},OM=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},FT=function(n,e,t){if(!n||typeof n!="object")return n;if(O(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return MM(n[".sv"],e,t);if(typeof n[".sv"]=="object")return LM(n[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},MM=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:O(!1,"Unexpected server value: "+n)}},LM=function(n,e,t){n.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let i=n.increment;typeof i!="number"&&O(!1,"Unexpected increment value: "+i);let r=e.node();if(O(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},FM=function(n,e,t,i){return jg(e,new Ag(t,n),i)},VM=function(n,e,t){return jg(n,new bg(e),t)};function jg(n,e,t){let i=n.getPriority().val(),r=FT(i,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,c=FT(o.getValue(),e,t);return c!==o.getValue()||r!==o.getPriority().val()?new fs(c,Xe(r)):n}else{let o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new fs(r))),o.forEachChild(Ze,(c,l)=>{let u=jg(l,e.getImmediateChild(c),t);u!==l&&(s=s.updateImmediateChild(c,u))}),s}}var va=class{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}};function Bg(n,e){let t=e instanceof me?e:new me(e),i=n,r=re(t);for(;r!==null;){let s=vi(i.node.children,r)||{children:{},childCount:0};i=new va(r,i,s),t=_e(t),r=re(t)}return i}function vs(n){return n.node.value}function Fb(n,e){n.node.value=e,Cg(n)}function Vb(n){return n.node.childCount>0}function UM(n){return vs(n)===void 0&&!Vb(n)}function Iu(n,e){Nt(n.node.children,(t,i)=>{e(new va(t,n,i))})}function Ub(n,e,t,i){t&&!i&&e(n),Iu(n,r=>{Ub(r,e,!0,i)}),t&&i&&e(n)}function jM(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function ba(n){return new me(n.parent===null?n.name:ba(n.parent)+"/"+n.name)}function Cg(n){n.parent!==null&&BM(n.parent,n.name,n)}function BM(n,e,t){let i=UM(t),r=mt(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,Cg(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,Cg(n))}var $M=/[\[\].#$\/\u0000-\u001F\u007F]/,zM=/[\[\].#$\u0000-\u001F\u007F]/,jm=10*1024*1024,jb=function(n){return typeof n=="string"&&n.length!==0&&!$M.test(n)},qM=function(n){return typeof n=="string"&&n.length!==0&&!zM.test(n)},WM=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),qM(n)};var Bb=function(n,e,t){let i=t instanceof me?new eg(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+$i(i));if(typeof e=="function")throw new Error(n+"contains a function "+$i(i)+" with contents = "+e.toString());if(zT(e))throw new Error(n+"contains "+e.toString()+" "+$i(i));if(typeof e=="string"&&e.length>jm/3&&So(e)>jm)throw new Error(n+"contains a string greater than "+jm+" utf8 bytes "+$i(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Nt(e,(o,c)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!jb(o)))throw new Error(n+" contains an invalid key ("+o+") "+$i(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);LO(i,o),Bb(n,c,i),FO(i)}),r&&s)throw new Error(n+' contains ".value" child '+$i(i)+" in addition to actual children.")}};var GM=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!jb(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!WM(t))throw new Error(lI(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Sg=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function HM(n,e){let t=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();t!==null&&!ub(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function Ki(n,e,t){HM(n,t),KM(n,i=>$t(i,e)||$t(e,i))}function KM(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){let r=n.eventLists_[i];if(r){let s=r.path;e(s)?(QM(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function QM(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let i=t.getEventRunner();qi&&Je("event: "+t.toString()),Ea(i)}}}var YM="repo_interrupt",JM=25,Rg=class{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Sg,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fu(),this.transactionQueueTree_=new va,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function XM(n,e,t){if(n.stats_=Og(n.repoInfo_),n.forceRestClient_||hO())n.server_=new ug(n.repoInfo_,(i,r,s,o)=>{VT(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>UT(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Le(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Mg(n.repoInfo_,e,(i,r,s,o)=>{VT(n,i,r,s,o)},i=>{UT(n,i)},i=>{eL(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=fO(n.repoInfo_,()=>new pg(n.stats_,n.server_)),n.infoData_=new hg,n.infoSyncTree_=new _u({startListening:(i,r,s,o)=>{let c=[],l=n.infoData_.getNode(i._path);return l.isEmpty()||(c=yu(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),c},stopListening:()=>{}}),$g(n,"connected",!1),n.serverSyncTree_=new _u({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(c,l)=>{let u=o(c,l);Ki(n.eventQueue_,i._path,u)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function ZM(n){let t=n.infoData_.getNode(new me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function $b(n){return OM({timestamp:ZM(n)})}function VT(n,e,t,i,r){n.dataUpdateCount++;let s=new me(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){let l=Co(t,u=>Xe(u));o=xM(n.serverSyncTree_,s,l,r)}else{let l=Xe(t);o=kM(n.serverSyncTree_,s,l,r)}else if(i){let l=Co(t,u=>Xe(u));o=NM(n.serverSyncTree_,s,l)}else{let l=Xe(t);o=yu(n.serverSyncTree_,s,l)}let c=s;o.length>0&&(c=qg(n,s)),Ki(n.eventQueue_,c,o)}function UT(n,e){$g(n,"connected",e),e===!1&&nL(n)}function eL(n,e){Nt(e,(t,i)=>{$g(n,t,i)})}function $g(n,e,t){let i=new me("/.info/"+e),r=Xe(t);n.infoData_.updateSnapshot(i,r);let s=yu(n.infoSyncTree_,i,r);Ki(n.eventQueue_,i,s)}function tL(n){return n.nextWriteId_++}function nL(n){zb(n,"onDisconnectEvents");let e=$b(n),t=fu();dg(n.onDisconnect_,fe(),(r,s)=>{let o=FM(r,s,n.serverSyncTree_,e);gb(t,r,o)});let i=[];dg(t,fe(),(r,s)=>{i=i.concat(yu(n.serverSyncTree_,r,s));let o=oL(n,r);qg(n,o)}),n.onDisconnect_=fu(),Ki(n.eventQueue_,fe(),i)}function iL(n){n.persistentConnection_&&n.persistentConnection_.interrupt(YM)}function zb(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Je(t,...e)}function qb(n,e,t){return Nb(n.serverSyncTree_,e,t)||Ie.EMPTY_NODE}function zg(n,e=n.transactionQueueTree_){if(e||wu(n,e),vs(e)){let t=Gb(n,e);O(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&rL(n,ba(e),t)}else Vb(e)&&Iu(e,t=>{zg(n,t)})}function rL(n,e,t){let i=t.map(u=>u.currentWriteId),r=qb(n,e,i),s=r,o=r.hash();for(let u=0;u<t.length;u++){let f=t[u];O(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;let p=Pt(e,f.path);s=s.updateChild(p,f.currentOutputSnapshotRaw)}let c=s.val(!0),l=e;n.server_.put(l.toString(),c,u=>{zb(n,"transaction put response",{path:l.toString(),status:u});let f=[];if(u==="ok"){let p=[];for(let g=0;g<t.length;g++)t[g].status=2,f=f.concat(cs(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&p.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();wu(n,Bg(n.transactionQueueTree_,e)),zg(n,n.transactionQueueTree_),Ki(n.eventQueue_,e,f);for(let g=0;g<p.length;g++)Ea(p[g])}else{if(u==="datastale")for(let p=0;p<t.length;p++)t[p].status===3?t[p].status=4:t[p].status=0;else{vt("transaction at "+l.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}qg(n,e)}},o)}function qg(n,e){let t=Wb(n,e),i=ba(t),r=Gb(n,t);return sL(n,r,i),i}function sL(n,e,t){if(e.length===0)return;let i=[],r=[],o=e.filter(c=>c.status===0).map(c=>c.currentWriteId);for(let c=0;c<e.length;c++){let l=e[c],u=Pt(t,l.path),f=!1,p;if(O(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)f=!0,p=l.abortReason,r=r.concat(cs(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=JM)f=!0,p="maxretry",r=r.concat(cs(n.serverSyncTree_,l.currentWriteId,!0));else{let g=qb(n,l.path,o);l.currentInputSnapshot=g;let w=e[c].update(g.val());if(w!==void 0){Bb("transaction failed: Data returned ",w,l.path);let S=Xe(w);typeof w=="object"&&w!=null&&mt(w,".priority")||(S=S.updatePriority(g.getPriority()));let P=l.currentWriteId,V=$b(n),j=VM(S,g,V);l.currentOutputSnapshotRaw=S,l.currentOutputSnapshotResolved=j,l.currentWriteId=tL(n),o.splice(o.indexOf(P),1),r=r.concat(DM(n.serverSyncTree_,l.path,j,l.currentWriteId,l.applyLocally)),r=r.concat(cs(n.serverSyncTree_,P,!0))}else f=!0,p="nodata",r=r.concat(cs(n.serverSyncTree_,l.currentWriteId,!0))}Ki(n.eventQueue_,t,r),r=[],f&&(e[c].status=2,function(g){setTimeout(g,Math.floor(0))}(e[c].unwatcher),e[c].onComplete&&(p==="nodata"?i.push(()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot)):i.push(()=>e[c].onComplete(new Error(p),!1,null))))}wu(n,n.transactionQueueTree_);for(let c=0;c<i.length;c++)Ea(i[c]);zg(n,n.transactionQueueTree_)}function Wb(n,e){let t,i=n.transactionQueueTree_;for(t=re(e);t!==null&&vs(i)===void 0;)i=Bg(i,t),e=_e(e),t=re(e);return i}function Gb(n,e){let t=[];return Hb(n,e,t),t.sort((i,r)=>i.order-r.order),t}function Hb(n,e,t){let i=vs(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);Iu(e,r=>{Hb(n,r,t)})}function wu(n,e){let t=vs(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,Fb(e,t.length>0?t:void 0)}Iu(e,i=>{wu(n,i)})}function oL(n,e){let t=ba(Wb(n,e)),i=Bg(n.transactionQueueTree_,e);return jM(i,r=>{Bm(n,r)}),Bm(n,i),Ub(i,r=>{Bm(n,r)}),t}function Bm(n,e){let t=vs(e);if(t){let i=[],r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(O(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(O(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(cs(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Fb(e,void 0):t.length=s+1,Ki(n.eventQueue_,ba(e),r);for(let o=0;o<i.length;o++)Ea(i[o])}}function aL(n){let e="",t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function cL(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):vt(`Invalid query segment '${t}' in query '${n}'`)}return e}var jT=function(n,e){let t=lL(n),i=t.namespace;t.domain==="firebase.com"&&Rn(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Rn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||iO();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new ou(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new me(t.pathString)}},lL=function(n){let e="",t="",i="",r="",s="",o=!0,c="https",l=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(c=n.substring(0,u-1),n=n.substring(u+2));let f=n.indexOf("/");f===-1&&(f=n.length);let p=n.indexOf("?");p===-1&&(p=n.length),e=n.substring(0,Math.min(f,p)),f<p&&(r=aL(n.substring(f,p)));let g=cL(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o=c==="https"||c==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;let w=e.slice(0,u);if(w.toLowerCase()==="localhost")t="localhost";else if(w.split(".").length<=2)t=w;else{let S=e.indexOf(".");i=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=i}"ns"in g&&(s=g.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:c,pathString:r,namespace:s}};var Pg=class n{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return te(this._path)?null:ab(this._path)}get ref(){return new _s(this._repo,this._path)}get _queryIdentifier(){let e=CT(this._queryParams),t=xg(e);return t==="{}"?"default":t}get _queryObject(){return CT(this._queryParams)}isEqual(e){if(e=ke(e),!(e instanceof n))return!1;let t=this._repo===e._repo,i=ub(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+MO(this._path)}};var _s=class n extends Pg{constructor(e,t){super(e,t,new lg,!1)}get parent(){let e=lb(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};RM(_s);PM(_s);var uL="FIREBASE_DATABASE_EMULATOR_HOST",Dg={},hL=!1;function dL(n,e,t,i){n.repoInfo_=new ou(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function fL(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||Rn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Je("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=jT(s,r),c=o.repoInfo,l,u;typeof process<"u"&&process.env&&(u=process.env[uL]),u?(l=!0,s=`http://${u}?ns=${c.namespace}`,o=jT(s,r),c=o.repoInfo):l=!o.repoInfo.secure;let f=r&&l?new pa(pa.OWNER):new Hm(n.name,n.options,e);GM("Invalid Firebase Database URL",o),te(o.path)||Rn("Database URL must point to the root of a Firebase Database (not including a child path).");let p=mL(c,n,f,new Gm(n.name,t));return new Ng(p,n)}function pL(n,e){let t=Dg[e];(!t||t[n.key]!==n)&&Rn(`Database ${e}(${n.repoInfo_}) has already been deleted.`),iL(n),delete t[n.key]}function mL(n,e,t,i){let r=Dg[e.name];r||(r={},Dg[e.name]=r);let s=r[n.toURLString()];return s&&Rn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Rg(n,hL,t,i),r[n.toURLString()]=s,s}var Ng=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(XM(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new _s(this._repo,fe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(pL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Rn("Cannot call "+e+" on a deleted database.")}};function Kb(n=_n(),e){let t=gn(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let i=Vc("database");i&&Qb(t,...i)}return t}function Qb(n,e,t,i={}){n=ke(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Rn("Cannot call useEmulator() after instance has already been initialized.");let r=n._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Rn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new pa(pa.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:Uc(i.mockUserToken,n.app.options.projectId);s=new pa(o)}dL(r,e,t,s)}function gL(n){eO(_t),gt(new He("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return fL(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),ue(cT,lT,n),ue(cT,lT,"esm2017")}Mg.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Mg.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};gL();var Aa=class{constructor(e){return e}},Yb="database",Wg=class{constructor(){return bi(Yb)}};var Gg=new J("angularfire2.database-instances");function _L(n,e){let t=kr(Yb,n,e);return t&&new Aa(t)}function yL(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Aa(i)}}var vL={provide:Wg,deps:[[new Ae,Gg]]},IL={provide:Aa,useFactory:_L,deps:[[new Ae,Gg],Ut]};function Jb(n,...e){return ue("angularfire",Ct.full,"rtdb"),nt([IL,vL,{provide:Gg,useFactory:yL(n),multi:!0,deps:[he,Mt,Yn,yn,[new Ae,Pi],[new Ae,Qn],...e]}])}var Xb=Yt(Kb,!0);var Zb={providers:[Ay({eventCoalescing:!0}),$v(qv,zv()),Ky(Qy()),{provide:gd,useValue:_d.apiRoot},Hv(),Yv(),PI(()=>DI(_d.firebaseConfig)),Iw(()=>ww()),sT(()=>oT()),Jb(()=>Xb())]};console.log(`Based on Angular18 Template v${{version:Kv}} [${Qv}]`);var Hg;try{Hg=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Hg=!1}var Qi=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?ky(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Hg)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(i){return new(i||n)(B(ut))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ca;function wL(){if(Ca==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Ca=!0}))}finally{Ca=Ca||!1}return Ca}function Kg(n){return wL()?n:!!n.capture}function eA(n){return n.composedPath?n.composedPath()[0]:n.target}function tA(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Yg(n){return Array.isArray(n)?n:[n]}function Jg(n){return n instanceof hn?n.nativeElement:n}var nA=new Set,Yi,EL=(()=>{class n{constructor(t,i){this._platform=t,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):bL}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&TL(t,this._nonce),this._matchMedia(t)}static{this.\u0275fac=function(i){return new(i||n)(B(Qi),B($s,8))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function TL(n,e){if(!nA.has(n))try{Yi||(Yi=document.createElement("style"),e&&Yi.setAttribute("nonce",e),Yi.setAttribute("type","text/css"),document.head.appendChild(Yi)),Yi.sheet&&(Yi.sheet.insertRule(`@media ${n} {body{ }}`,0),nA.add(n))}catch(t){console.error(t)}}function bL(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var rA=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ln}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return iA(Yg(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=iA(Yg(t)).map(o=>this._registerQuery(o).observable),s=nr(r);return s=qa(s.pipe(Un(1)),s.pipe(py(1),uy(0))),s.pipe(ne(o=>{let c={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:u})=>{c.matches=c.matches||l,c.breakpoints[u]=l}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let i=this._mediaMatcher.matchMedia(t),s={observable:new Ln(o=>{let c=l=>this._zone.run(()=>o.next(l));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(Wa(i),ne(({matches:o})=>({query:t,matches:o})),Ga(this._destroySubject)),mql:i};return this._queries.set(t,s),s}static{this.\u0275fac=function(i){return new(i||n)(B(EL),B(he))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function iA(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function aA(n){return n.buttons===0||n.detail===0}function cA(n){let e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Ji=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(Ji||{}),sA="cdk-high-contrast-black-on-white",oA="cdk-high-contrast-white-on-black",Xg="cdk-high-contrast-active",lA=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=U(rA).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ji.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ji.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ji.BLACK_ON_WHITE}return Ji.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(Xg,sA,oA),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===Ji.BLACK_ON_WHITE?t.add(Xg,sA):i===Ji.WHITE_ON_BLACK&&t.add(Xg,oA)}}static{this.\u0275fac=function(i){return new(i||n)(B(Qi),B(Te))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Zg=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ne({type:n})}static{this.\u0275inj=De({})}}return n})();function SL(){return!0}var RL=new J("mat-sanity-checks",{providedIn:"root",factory:SL}),Pn=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return tA()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[t]}static{this.\u0275fac=function(i){return new(i||n)(B(lA),B(RL,8),B(Te))}}static{this.\u0275mod=Ne({type:n})}static{this.\u0275inj=De({imports:[Zg,Zg]})}}return n})();var kt=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(kt||{}),e_=class{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=kt.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},uA=Kg({passive:!0,capture:!0}),t_=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=eA(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){let s=this._events.get(t);if(s){let o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,uA)})}removeHandler(e,t,i){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(i),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,uA)))}},hA={enterDuration:225,exitDuration:150},PL=800,dA=Kg({passive:!0,capture:!0}),fA=["mousedown","touchstart"],pA=["mouseup","mouseleave","touchend","touchcancel"],mA=class n{static{this._eventManager=new t_}constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Jg(i))}fadeInRipple(e,t,i={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=L(L({},hA),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let o=i.radius||DL(e,t,r),c=e-r.left,l=t-r.top,u=s.enterDuration,f=document.createElement("div");f.classList.add("mat-ripple-element"),f.style.left=`${c-o}px`,f.style.top=`${l-o}px`,f.style.height=`${o*2}px`,f.style.width=`${o*2}px`,i.color!=null&&(f.style.backgroundColor=i.color),f.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(f);let p=window.getComputedStyle(f),g=p.transitionProperty,w=p.transitionDuration,S=g==="none"||w==="0s"||w==="0s, 0s"||r.width===0&&r.height===0,D=new e_(this,f,i,S);f.style.transform="scale3d(1, 1, 1)",D.state=kt.FADING_IN,i.persistent||(this._mostRecentTransientRipple=D);let P=null;return!S&&(u||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let V=()=>{P&&(P.fallbackTimer=null),clearTimeout(M),this._finishRippleTransition(D)},j=()=>this._destroyRipple(D),M=setTimeout(j,u+100);f.addEventListener("transitionend",V),f.addEventListener("transitioncancel",j),P={onTransitionEnd:V,onTransitionCancel:j,fallbackTimer:M}}),this._activeRipples.set(D,P),(S||!u)&&this._finishRippleTransition(D),D}fadeOutRipple(e){if(e.state===kt.FADING_OUT||e.state===kt.HIDDEN)return;let t=e.element,i=L(L({},hA),e.config.animation);t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=kt.FADING_OUT,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=Jg(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,fA.forEach(i=>{n._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{pA.forEach(t=>{this._triggerElement.addEventListener(t,this,dA)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===kt.FADING_IN?this._startFadeOutTransition(e):e.state===kt.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=kt.VISIBLE,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=kt.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=aA(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+PL;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!cA(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===kt.VISIBLE||e.config.terminateOnPointerUp&&e.state===kt.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(fA.forEach(t=>n._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(pA.forEach(t=>e.removeEventListener(t,this,dA)),this._pointerUpEventsRegistered=!1))}};function DL(n,e,t){let i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}var NL=["*",[["mat-toolbar-row"]]],kL=["*","mat-toolbar-row"],xL=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=un({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return n})(),gA=(()=>{class n{constructor(t,i,r){this._elementRef=t,this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static{this.\u0275fac=function(i){return new(i||n)(qt(hn),qt(Qi),qt(Te))}}static{this.\u0275cmp=it({type:n,selectors:[["mat-toolbar"]],contentQueries:function(i,r,s){if(i&1&&uh(s,xL,5),i&2){let o;ec(o=tc())&&(r._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(i,r){i&2&&(ch(r.color?"mat-"+r.color:""),lr("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",r._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[rt],ngContentSelectors:kL,decls:2,vars:0,template:function(i,r){i&1&&(dr(NL),di(0),di(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-app-surface));color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-app-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-app-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-app-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-app-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-app-title-large-tracking));margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface));--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-app-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return n})();var _A=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ne({type:n})}static{this.\u0275inj=De({imports:[Pn,Pn]})}}return n})();var yA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ne({type:n})}static{this.\u0275inj=De({imports:[Pn,Pn]})}}return n})();var n_=class{constructor(e,t){this._delegate=e,this.firebase=t,Pr(e,new He("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Do(this._delegate)))}_getService(e,t=Kt){var i;this._delegate.checkDestroyed();let r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Kt){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Pr(this._delegate,e)}_addOrOverwriteComponent(e){$d(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var ML={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},vA=new Tt("app-compat","Firebase",ML);function LL(n){let e={},t={__esModule:!0,initializeApp:s,app:r,registerVersion:ue,setLogLevel:Hc,onLog:Gc,apps:null,SDK_VERSION:_t,INTERNAL:{registerComponent:c,removeApp:i,useAsService:l,modularAPIs:zd}};t.default=t,Object.defineProperty(t,"apps",{get:o});function i(u){delete e[u]}function r(u){if(u=u||Kt,!mt(e,u))throw vA.create("no-app",{appName:u});return e[u]}r.App=n;function s(u,f={}){let p=Dr(u,f);if(mt(e,p.name))return e[p.name];let g=new n(p,t);return e[p.name]=g,g}function o(){return Object.keys(e).map(u=>e[u])}function c(u){let f=u.name,p=f.replace("-compat","");if(gt(u)&&u.type==="PUBLIC"){let g=(w=r())=>{if(typeof w[p]!="function")throw vA.create("invalid-app-argument",{appName:f});return w[p]()};u.serviceProps!==void 0&&Ar(g,u.serviceProps),t[p]=g,n.prototype[p]=function(...w){return this._getService.bind(this,f).apply(this,u.multipleInstances?w:[])}}return u.type==="PUBLIC"?t[p]:null}function l(u,f){return f==="serverAuth"?null:f}return t}function wA(){let n=LL(n_);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:wA,extendNamespace:e,createSubscribe:Bc,ErrorFactory:Tt,deepExtend:Ar});function e(t){Ar(n,t)}return n}var FL=wA();var IA=new bt("@firebase/app-compat"),VL="@firebase/app-compat",UL="0.2.43";function jL(n){ue(VL,UL,n)}try{let n=bd();if(n.firebase!==void 0){IA.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);let e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&IA.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}var Dn=FL;jL();var BL="firebase",$L="10.14.1";Dn.registerVersion(BL,$L,"app-compat");var Eu=class{constructor(e){return e}},EA=new J("angularfire2.app.options"),TA=new J("angularfire2.app.name");function zL(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=Dn.apps.filter(c=>c&&c.name===r.name)[0]||e.runOutsideAngular(()=>Dn.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let c=!!module.hot;qL("error",`${o.name} Firebase App already initialized with different options${c?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Eu(o)}var qL=(n,...e)=>{Cy()&&typeof console<"u"&&console[n](...e)},WL={provide:Eu,useFactory:zL,deps:[EA,he,[new Ae,TA]]},bA=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:EA,useValue:t},{provide:TA,useValue:i}]}}constructor(t){Dn.registerVersion("angularfire",Ct.full,"core"),Dn.registerVersion("angularfire",Ct.full,"app-compat"),Dn.registerVersion("angular",ic.full,t.toString())}static \u0275fac=function(i){return new(i||n)(B(ut))};static \u0275mod=Ne({type:n});static \u0275inj=De({providers:[WL]})}return n})();var Z$=typeof module<"u"&&!!module.hot;globalThis.\u0275AngularfireInstanceCache||=[];var GL=["*"];var HL=new J("MAT_CARD_CONFIG"),AA=(()=>{class n{constructor(t){this.appearance=t?.appearance||"raised"}static{this.\u0275fac=function(i){return new(i||n)(qt(HL,8))}}static{this.\u0275cmp=it({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,r){i&2&&lr("mat-mdc-card-outlined",r.appearance==="outlined")("mdc-card--outlined",r.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[rt],ngContentSelectors:GL,decls:1,vars:0,template:function(i,r){i&1&&(dr(),di(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface));border-color:var(--mdc-elevated-card-container-color, var(--mat-app-surface));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-app-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-app-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-app-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-app-corner-medium));border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color, var(--mat-app-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-app-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-app-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-app-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-app-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-app-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-app-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-app-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-app-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-app-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-app-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-app-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-app-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}}return n})();var CA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=un({type:n,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"],standalone:!0})}}return n})();var SA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Ne({type:n})}static{this.\u0275inj=De({imports:[Pn,_h,Pn]})}}return n})();function QL(n,e){if(n&1&&(ht(0,"mat-card",0)(1,"h2",1),zn(2),dt(),ht(3,"mat-card-content",2),zn(4),dt()()),n&2){let t=Ft();Lt(2),nc(t.task().title),Lt(2),hh(" ",t.task().description," ")}}var RA=(()=>{class n{constructor(){this.task=Bs.required()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=it({type:n,selectors:[["app-task"]],inputs:{task:[1,"task"]},standalone:!0,features:[rt],decls:1,vars:1,consts:[["appearance","outlined",1,"item"],[1,"title"],[1,"description"]],template:function(i,r){i&1&&ah(0,QL,5,2,"mat-card",0),i&2&&lh(r.task()?0:-1)},dependencies:[SA,AA,CA],styles:[".item[_ngcontent-%COMP%]{background-color:#d2d0dd;padding:20%}"]})}}return n})();function YL(n,e){if(n&1){let t=Za();ht(0,"div",1),hr("mousedown",function(){let r=Bn(t).$implicit,s=Ft();return $n(s.startDragging(r))}),ur(1,"app-task",2),dt(),ur(2,"div",3)}if(n&2){let t=e.$implicit;cr("id",t.id),Lt(),cr("task",t)}}var PA=(()=>{class n{constructor(){this.tasks=oh([]),this.title=Bs.required(),this.draggedElement=oh(void 0),this.lane=Bs.required()}startDragging(t){this.draggedElement.set(t)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=it({type:n,selectors:[["app-lane"]],inputs:{tasks:[1,"tasks"],title:[1,"title"],draggedElement:[1,"draggedElement"],lane:[1,"lane"]},outputs:{tasks:"tasksChange",draggedElement:"draggedElementChange"},standalone:!0,features:[rt],decls:5,vars:1,consts:[[1,"lane"],["draggable","false",3,"mousedown","id"],[3,"task"],[2,"height","30px"]],template:function(i,r){i&1&&(ht(0,"div",0)(1,"h2"),zn(2),dt(),Ja(3,YL,3,2,null,null,Ya),dt()),i&2&&(Lt(2),nc(r.title()),Lt(),Xa(r.tasks()))},dependencies:[RA],styles:[".lane[_ngcontent-%COMP%]{gap:16px}"]})}}return n})();function JL(n,e){if(n&1){let t=Za();ht(0,"div",3),hr("mouseover",function(){let r=Bn(t).$implicit,s=Ft();return $n(s.overLane(r))})("mouseleave",function(){Bn(t);let r=Ft();return $n(r.resetLane())})("mouseup",function(){Bn(t);let r=Ft();return $n(r.drop())}),ht(1,"app-lane",4),Ty("tasksChange",function(r){let s=Bn(t).$implicit;return fh(s.tasks,r)||(s.tasks=r),$n(r)})("draggedElementChange",function(r){Bn(t);let s=Ft();return fh(s.draggedElement,r)||(s.draggedElement=r),$n(r)}),dt()()}if(n&2){let t=e.$implicit,i=Ft();Lt(),dh("tasks",t.tasks),cr("title",t.title)("lane",t),dh("draggedElement",i.draggedElement)}}var DA=(()=>{class n{constructor(){this.firestore=U(Bi),this.tasks=Ws([]),this.lanes=Ws([]),this.currentLane=Ws(void 0),this.draggedElement=Ws(void 0)}ngOnInit(){this.unsubscribe=Nm(Om(this.firestore,"kanbanFire/lanes"),t=>{if(t.exists()){let i=t.data();this.lanes.set(i.lanes)}else console.warn("Document does not exist")}),this.tasks.set([{id:"1",title:"Task 1",description:"Description for Task 1"},{id:"2",title:"Task 2",description:"Description for Task 2"},{id:"3",title:"Task 3",description:"Description for Task 3"},{id:"4",title:"Task 4",description:"Description for Task 4"},{id:"5",title:"Task 5",description:"Description for Task 5"}]),this.lanes.set([{id:0,title:"Lane 1",tasks:[this.tasks()[0],this.tasks()[1]]},{id:1,title:"Lane 2",tasks:[this.tasks()[2],this.tasks()[3]]},{id:2,title:"Lane 3",tasks:[this.tasks()[4]]}])}ngOnDestroy(){this.unsubscribe()}taskEdited(t){console.log(t)}overLane(t){this.currentLane.set(t)}resetLane(){this.currentLane.set(void 0)}drop(){this.currentLane()!==void 0&&this.draggedElement()!==void 0&&(this.lanes.update(t=>{let i=t.where(r=>r.id===this.currentLane()?.id).first();return t.forEach(r=>{r.tasks=r.tasks.filter(s=>s.id!==this.draggedElement()?.id)}),t[i.id].tasks.push(this.draggedElement()),t}),this.writeDatabase(),this.draggedElement.set(void 0))}writeDatabase(){let t=Om(this.firestore,"kanbanFire/lanes");return aT(t,{lanes:this.lanes()})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=it({type:n,selectors:[["app-root"]],standalone:!0,features:[rt],decls:6,vars:0,consts:[["color","primary"],[1,"container"],[1,"item"],[1,"item",3,"mouseover","mouseleave","mouseup"],[3,"tasksChange","draggedElementChange","tasks","title","lane","draggedElement"]],template:function(i,r){i&1&&(ht(0,"mat-toolbar",0)(1,"span"),zn(2,"Kanban Fire"),dt()(),ht(3,"div",1),Ja(4,JL,2,4,"div",2,Ya),dt()),i&2&&(Lt(4),Xa(r.lanes()))},dependencies:[_A,gA,yA,PA,bA],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;gap:40px;width:100%}.item[_ngcontent-%COMP%]{flex:1;margin:0 5px;background-color:#b7c9e2;border-radius:10px;padding:10px}"]})}}return n})();nv(DA,Zb).catch(n=>console.error(n));
